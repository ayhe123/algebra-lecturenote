% 2-1.tex
%
% Copyright 2022 ayhe123
%
% 此文档采用 CC-BY-4.0 许可证, 更多信息见 https://creativecommons.org/licenses/by/4.0

\documentclass[color=black,device=normal,lang=cn,mode=geye]{elegantnote}
\usepackage{lecturenote}
\title{第1章笔记和习题}

\begin{document}
\maketitle
在这章中, 不加说明的话, $V$ 一律为域 $K$ 上的 $n$ 维线性空间.
\section{线性空间(对应教材1.2节)}
\subsection{基变换与可逆矩阵}
设 $\boldsymbol{e}_1,\boldsymbol{e}_2,\cdots,\boldsymbol{e}_n$ 和 $\boldsymbol{e}_1',\boldsymbol{e}_2',\cdots,\boldsymbol{e}_n'$ 是 $V$ 的两个基. 将基变换写成矩阵乘积的形式(规定向量与纯量的乘法是交换的, 即 $\lambda\boldsymbol{a}=\boldsymbol{a}\lambda$):
\begin{equation}\label{eq1.1}
    (\boldsymbol{e}_1',\boldsymbol{e}_2',\cdots,\boldsymbol{e}_n')=(\boldsymbol{e}_1,\boldsymbol{e}_2,\cdots,\boldsymbol{e}_n)\begin{pmatrix}
        a_{11} & a_{12} & \cdots & a_{1n} \\
        a_{21} & a_{22} & \cdots & a_{2n} \\
        \vdots & \vdots & \ddots & \vdots \\
        a_{n1} & a_{n2} & \cdots & a_{nn} \\
    \end{pmatrix},
\end{equation}
\[(\boldsymbol{e}_1,\boldsymbol{e}_2,\cdots,\boldsymbol{e}_n)=(\boldsymbol{e}_1',\boldsymbol{e}_2',\cdots,\boldsymbol{e}_n')\begin{pmatrix}
    b_{11} & b_{12} & \cdots & b_{1n} \\
    b_{21} & b_{22} & \cdots & b_{2n} \\
    \vdots & \vdots & \ddots & \vdots \\
    b_{n1} & b_{n2} & \cdots & b_{nn} \\
\end{pmatrix}.\]
设 $A=(a_{ij}),B=(b_{ij})$, 则
\[(\boldsymbol{e}_1,\boldsymbol{e}_2,\cdots,\boldsymbol{e}_n)=(\boldsymbol{e}_1',\boldsymbol{e}_2',\cdots,\boldsymbol{e}_n')B=(\boldsymbol{e}_1,\boldsymbol{e}_2,\cdots,\boldsymbol{e}_n)AB.\]
设 $AB=(c_{ji})$, 则
\[\boldsymbol{e}_i=\sum\limits_{k=1}^nc_{ki}\boldsymbol{e}_k\Rightarrow\boldsymbol{0}=c_{1i}\boldsymbol{e}_1+\cdots+(c_{ii}-1)\boldsymbol{e}_i+\cdots+c_{ni}\boldsymbol{e}_n.\]

$\because\boldsymbol{e}_1,\boldsymbol{e}_2,\cdots,\boldsymbol{e}_n$ 是 $V$ 的一个基, $\therefore\boldsymbol{e}_1,\boldsymbol{e}_2,\cdots,\boldsymbol{e}_n$ 线性无关, 由上式得 $c_{ji}=\delta_{ji}$.

$\therefore AB=E,\therefore A$ 可逆.

进一步, 有
\begin{theorem}\label{t1.1}
    设 $V$ 的所有的基组成的集合为 $V_b$, 给定 $V$ 的一个基 $\boldsymbol{e}_1,\boldsymbol{e}_2,\cdots,\boldsymbol{e}_n$, 则
    \[\varphi:\begin{array}{rcl}
        GL_n(K) & \to & V_b \\
        A & \to & (\boldsymbol{e}_1,\boldsymbol{e}_2,\cdots,\boldsymbol{e}_n)A \\
    \end{array}\]

    是双射.
\end{theorem}
\begin{proof}
    设 $(\boldsymbol{e}_1',\boldsymbol{e}_2',\cdots,\boldsymbol{e}_n')=(\boldsymbol{e}_1,\boldsymbol{e}_2,\cdots,\boldsymbol{e}_n)A$ (其中 $A\in GL_n(K)$), 则
    \[(\boldsymbol{e}_1',\boldsymbol{e}_2',\cdots,\boldsymbol{e}_n')A^{-1}=(\boldsymbol{e}_1,\boldsymbol{e}_2,\cdots,\boldsymbol{e}_n)AA^{-1}=(\boldsymbol{e}_1,\boldsymbol{e}_2,\cdots,\boldsymbol{e}_n),\]

    即 $\boldsymbol{e}_1,\boldsymbol{e}_2,\cdots,\boldsymbol{e}_n$ 的每个向量都可以表示为 $\boldsymbol{e}_1',\boldsymbol{e}_2',\cdots,\boldsymbol{e}_n'$ 的线性组合.

    假设 $\boldsymbol{e}_1',\cdots,\boldsymbol{e}_n'$ 线性相关, 则 $\exists i,\boldsymbol{e}_i'$ 可以被 $\boldsymbol{e}_1',\cdots,\widehat{\boldsymbol{e}_i'},\cdots,\boldsymbol{e}_n'$ 线性表示. $\therefore\boldsymbol{e}_1,\cdots,\boldsymbol{e}_n$ 的每个向量都可以表示为 $\boldsymbol{e}_1',\cdots,\widehat{\boldsymbol{e}_i'},\cdots,\boldsymbol{e}_n'$ 这 $n-1$ 个向量的线性组合. 这与书上的定理 2 矛盾.

    $\therefore\boldsymbol{e}_1',\boldsymbol{e}_2',\cdots,\boldsymbol{e}_n'$ 线性无关, 是 $V$ 的一个基. $\therefore\varphi$ 是确切定义的.

    由前面的讨论得, $\forall(\boldsymbol{e}_1',\cdots,\boldsymbol{e}_n')\in V_b,\exists$ 可逆矩阵 $A$ 使得 $(\boldsymbol{e}_1',\cdots,\boldsymbol{e}_n')=(\boldsymbol{e}_1,\cdots,\boldsymbol{e}_n)A$. $\therefore\varphi$ 是满射.

    设 $\varphi(A)=\varphi(B)$, 则 $(\boldsymbol{e}_1,\boldsymbol{e}_2,\cdots,\boldsymbol{e}_n)(A-B)=\boldsymbol{0}$. 设 $A=(a_{ij}),B=(b_{ij})$, 则
    \[(a_{1j}-b_{1j})\boldsymbol{e}_1+(a_{2j}-b_{2j})\boldsymbol{e}_2+\cdots+(a_{nj}-b_{nj})\boldsymbol{e}_n=\boldsymbol{0},\quad j=1,2,\cdots,n.\]

    $\because\boldsymbol{e}_1,\boldsymbol{e}_2,\cdots,\boldsymbol{e}_n$ 线性无关, $\therefore a_{ij}-b_{ij}=0,\therefore A=B,\varphi$ 是单射.
\end{proof}

设 $\boldsymbol{e}_1,\boldsymbol{e}_2,\cdots,\boldsymbol{e}_n$ 和 $\boldsymbol{e}_1',\boldsymbol{e}_2',\cdots,\boldsymbol{e}_n'$ 是不同的两个基, $\boldsymbol{u}\in V$ 满足
\[\boldsymbol{u}=a_1\boldsymbol{e}_1+a_2\boldsymbol{e}_2+\cdots+a_n\boldsymbol{e}_n=b_1\boldsymbol{e}_1'+b_2\boldsymbol{e}_2'+\cdots+b_n\boldsymbol{e}_n'.\]

将上式写成矩阵乘积的形式:
\[\boldsymbol{u}=(\boldsymbol{e}_1,\boldsymbol{e}_2,\cdots,\boldsymbol{e}_n)\begin{pmatrix}
    a_1 \\
    a_2 \\
    \vdots \\
    a_n \\
\end{pmatrix}=(\boldsymbol{e}_1',\boldsymbol{e}_2',\cdots,\boldsymbol{e}_n')\begin{pmatrix}
    b_1 \\
    b_2 \\
    \vdots \\
    b_n \\
\end{pmatrix}.\]

设
\[(\boldsymbol{e}_1',\boldsymbol{e}_2',\cdots,\boldsymbol{e}_n')=(\boldsymbol{e}_1,\boldsymbol{e}_2,\cdots,\boldsymbol{e}_n)A,\]

则
\[(\boldsymbol{e}_1,\boldsymbol{e}_2,\cdots,\boldsymbol{e}_n)\begin{pmatrix}
    a_1 \\
    a_2 \\
    \vdots \\
    a_n \\
\end{pmatrix}=(\boldsymbol{e}_1,\boldsymbol{e}_2,\cdots,\boldsymbol{e}_n)A\begin{pmatrix}
    b_1 \\
    b_2 \\
    \vdots \\
    b_n \\
\end{pmatrix}.\]

与定理 \ref{t1.1} 最后的那部分类似, 有
\[[a_1,a_2,\cdots,a_n]=A[b_1,b_2,\cdots,b_n].\]
\subsection{子空间的和与直和}
先考虑两个子空间的情况.
\begin{theorem}\label{t1.2}
    设 $U_1,U_2$ 是 $U$ 的子空间, 则 $U=\{\boldsymbol{x}_1+\boldsymbol{x}_2|\boldsymbol{x}_1\in U_1,\boldsymbol{x}_2\in U_2\}$ 是满足 $U_1\subset U,U_2\subset U$ 的最小的子空间.
\end{theorem}
\begin{proof}
    $\because\boldsymbol{0}\in U_2,\therefore\forall\boldsymbol{x}\in U_1,\boldsymbol{x}+\boldsymbol{0}=\boldsymbol{x}\in U,\therefore U_1\subset U$. 同理得 $U_2\subset U$.

    设 $\boldsymbol{z}_1,\boldsymbol{z}_2\in U$, 则 $\exists\boldsymbol{x}_1,\boldsymbol{y}_1\in U_1,\boldsymbol{x}_2,\boldsymbol{y}_2\in U_2$ 使得 $\boldsymbol{x}_1+\boldsymbol{y}_1=\boldsymbol{z}_1,\boldsymbol{x}_2+\boldsymbol{y}_2=\boldsymbol{z}_2$.

    $\because\forall\alpha,\beta\in K,\alpha\boldsymbol{x}_1+\beta\boldsymbol{y}_1\in U_1,\alpha\boldsymbol{x}_2+\beta\boldsymbol{y}_2\in U_2,\therefore\alpha\boldsymbol{z}_1+\beta\boldsymbol{z}_2=(\alpha\boldsymbol{x}_1+\beta\boldsymbol{y}_1)+(\alpha\boldsymbol{x}_2+\beta\boldsymbol{y}_2)\in U,\therefore U$ 是 $V$ 的子空间.

    设 $U'$ 满足 $U_1\subset U',U_2\subset U'$, 则 $\forall\boldsymbol{x}_1\in U_1,\boldsymbol{x}_2\in U_2$, 有 $\boldsymbol{x}_1+\boldsymbol{x}_2\in U'.\therefore U\subset U'$.
\end{proof}

对于有限个子空间的和, 由定理 \ref{t1.2} 结合数学归纳法得定理 \ref{t1.2} 的结论成立.

对于一般的指标集, 定义
\begin{definition}
    设 $V_i,i\in I$ 为 $V$ 的子空间. 定义
    \[\sum\limits_{i\in I}V_i=\left\{\sum\limits_{i\in I}\boldsymbol{x}_i\bigg|\boldsymbol{x}_i\in V_i,\text{只有有限个}\ \boldsymbol{x}_i\neq0\right\}.\]
\end{definition}

$\because$ 两个``有限个非零元素之和''的和还是``有限个非零元素之和'', $\therefore\sum\limits_{i\in I}V_i$ 是 $V$ 的子空间.

书上定理 7 的证明用到了下面的结论.
\begin{theorem}
    设 $V_1,V_2,\cdots,V_r$ 是 $V$ 的子空间. $V_1+V_2+\cdots+V_r$ 是直和当且仅当: 若 $\boldsymbol{v}_i\in V_i,\boldsymbol{v}_1+\boldsymbol{v}_2+\cdots+\boldsymbol{v}_r=\boldsymbol{0}$, 则 $\boldsymbol{v}_i=\boldsymbol{0}$.
\end{theorem}
\begin{proof}
    ($\Rightarrow$) 由定义得 $\boldsymbol{0}$ 在 $V_1+V_2+\cdots+V_r$ 中的表示方式唯一, 而 $\boldsymbol{0}=\boldsymbol{0}+\boldsymbol{0}+\cdots+\boldsymbol{0},\boldsymbol{0}\in V_i,\therefore\boldsymbol{v}_i=\boldsymbol{0}$.

    ($\Leftarrow$) 设 $\boldsymbol{v}$ 有两个分解式
    \[\boldsymbol{v}=\boldsymbol{v}_1+\boldsymbol{v}_2+\cdots+\boldsymbol{v}_r=\boldsymbol{u}_1+\boldsymbol{u}_2+\cdots+\boldsymbol{u}_r,\boldsymbol{v}_i,\boldsymbol{u}_i\in V_i,\]

    则
    \[(\boldsymbol{v}_1-\boldsymbol{u}_1)+(\boldsymbol{v}_2-\boldsymbol{u}_2)+\cdots+(\boldsymbol{v}_r-\boldsymbol{u}_r)=\boldsymbol{0},\quad\boldsymbol{v}_i-\boldsymbol{u}_i\in V_i.\]

    $\therefore\boldsymbol{v}_i-\boldsymbol{u}_i=\boldsymbol{0},\boldsymbol{v}_i=\boldsymbol{u}_i$.
\end{proof}
下面的定理结合数学归纳法可以证明书上的定理 8 ($\Leftarrow$).
\begin{theorem}\label{t1.4}
    设 $U,W$ 是 $V$ 的子空间. 若 $\dim(U+W)=\dim U+\dim W$, 则 $U+W$ 是直和.
\end{theorem}
\begin{proof}
    $\because\dim(U+W)=\dim U+\dim W$, 由书上的定理 6 得 $\dim(U\cap W)=0,\therefore U\cap W=\{\boldsymbol{0}\}$.

    对 $\boldsymbol{x},\boldsymbol{x}'\in U,\boldsymbol{y},\boldsymbol{y}'\in W$, 如果 $\boldsymbol{x}+\boldsymbol{y}=\boldsymbol{x}'+\boldsymbol{y}'$, 则 $\boldsymbol{x}-\boldsymbol{x}'=\boldsymbol{y}-\boldsymbol{y}'$.

    $\because\boldsymbol{x}-\boldsymbol{x}'\in U,\boldsymbol{y}-\boldsymbol{y}'\in W,\therefore\boldsymbol{x}-\boldsymbol{x}'\in U\cap W$.

    $\because U\cap W=\{\boldsymbol{0}\},\therefore\boldsymbol{x}-\boldsymbol{x}'=\boldsymbol{y}-\boldsymbol{y}'=\boldsymbol{0}$.

    $\therefore\boldsymbol{x}+\boldsymbol{y}=\boldsymbol{x}'+\boldsymbol{y}'\Rightarrow\boldsymbol{x}=\boldsymbol{x}',\boldsymbol{y}=\boldsymbol{y}'$, 即 $U+W$ 中的元素的表示方式唯一.
\end{proof}
举两个和不是直和的例子.
\begin{example}
    设 $V=K^3,\boldsymbol{e}_1=(1,0,0),\boldsymbol{e}_1=(0,1,0),\boldsymbol{e}_3=(0,0,1)$, $V_1=\left<\boldsymbol{e}_1,\boldsymbol{e}_2\right>,V_2=\left<\boldsymbol{e}_2,\boldsymbol{e}_3\right>$, 则
    
    (1) $\boldsymbol{e}_1+\boldsymbol{e}_2+\boldsymbol{e}_3\in V_1+V_2$ 有两种表示方式:
    \begin{align*}
        \boldsymbol{e}_1+\boldsymbol{e}_2+\boldsymbol{e}_3 & =(\boldsymbol{e}_1+\boldsymbol{e}_2)+\boldsymbol{e}_3\quad(\boldsymbol{e}_1+\boldsymbol{e}_2\in V_1,\boldsymbol{e}_3\in V_2) \\
        & =\boldsymbol{e}_1+(\boldsymbol{e}_2+\boldsymbol{e}_3)\quad(\boldsymbol{e}_1\in V_1,\boldsymbol{e}_2+\boldsymbol{e}_3\in V_2).
    \end{align*}

    (2) $\boldsymbol{0}$ 有两种表示方式:
    \[\boldsymbol{0}=\boldsymbol{0}+\boldsymbol{0}=\boldsymbol{e}_2+(-\boldsymbol{e}_2).\]
\end{example}
\begin{example}
    对子空间 $U_1,U_2,\cdots,U_m\in V$, 仅仅有 $\forall i,j,U_i\cap U_j=\{\boldsymbol{0}\}$ 不能得到 $U_1+U_2+\cdots+U_m$ 是直和.

    比如 $\mathbb{R}^2$ 上的三个子空间 $V_1=\left<(0,1)\right>,V_2=\left<(1,0)\right>,V_3=\left<(1,1)\right>$, 它们两两相交为 $\{0\}$, 但 $V_1+V_2+V_3$ 不是直和. 事实上, 如果 $V_1+V_2+V_3$ 是直和, 则 $(1,0),(0,1),(1,1)$ 是 $V$ 的一个基, 与 $\dim V=2$ 矛盾. 
\end{example}
\subsection{线性空间的同构}
由书上的定理 5, 同构实际上是线性映射. 有几个简单的性质.
\begin{property}
    设 $\varphi:U\to V,\psi:V\to W$ 是线性映射, 则 $\psi\circ\varphi$ 也是线性映射. 特别地, 同构的合成也是同构.
\end{property}
\begin{proof}
    由定义,
    \begin{align*}
        \psi(\varphi(\alpha\boldsymbol{x}+\beta\boldsymbol{y})) & =\psi(\alpha\varphi(\boldsymbol{x})+\beta\varphi(\boldsymbol{y})) \\
        & =\alpha\psi(\varphi(\boldsymbol{x}))+\beta\psi(\varphi(\boldsymbol{y})).\qedhere
    \end{align*}
\end{proof}
\begin{property}
    设 $\varphi:U\to V$ 是同构, 则 $\varphi^{-1}$ 也是同构.
\end{property}
\begin{proof}
    $\because\varphi$ 是双射, $\therefore\varphi^{-1}$ 是双射.

    $\because$
    \[\varphi(\alpha\boldsymbol{x}+\beta\boldsymbol{y})=\alpha\varphi(\boldsymbol{x})+\beta\varphi(\boldsymbol{y}),\]

    $\therefore$
    \[\alpha\boldsymbol{x}+\beta\boldsymbol{y}=\varphi^{-1}(\alpha\varphi(\boldsymbol{x})+\beta\varphi(\boldsymbol{y})).\]

    令 $\boldsymbol{u}=\varphi(\boldsymbol{x}),\boldsymbol{v}=\varphi(\boldsymbol{y})$, 则 $\boldsymbol{x}=\varphi^{-1}(\boldsymbol{u}),\boldsymbol{y}=\varphi^{-1}(\boldsymbol{v})$,
    \[\alpha\varphi^{-1}(\boldsymbol{u})+\beta\varphi^{-1}(\boldsymbol{v})=\varphi^{-1}(\alpha\boldsymbol{u}+\beta\boldsymbol{v}).\]
\end{proof}

类似于有限集合中的双射, 有:
\begin{theorem}\label{t1.5}
    若 $U,V$ 是 $n$ 维向量空间, $f:U\to V$ 是线性映射且是单射, 则 $f$ 是同构.
\end{theorem}
\begin{proof}
    有
    \[a_1f(\boldsymbol{x}_1)+\cdots+a_rf(\boldsymbol{x}_r)=\boldsymbol{0}\Leftrightarrow f(a_1\boldsymbol{x}_1+a_2\boldsymbol{x}_2+\cdots+a_r\boldsymbol{x}_r)=\boldsymbol{0}.\]

    $\because f$ 是单射, $\therefore$
    \[f(a_1\boldsymbol{x}_1+a_2\boldsymbol{x}_2+\cdots+a_r\boldsymbol{x}_r)=\boldsymbol{0}\Leftrightarrow a_1\boldsymbol{x}_1+a_2\boldsymbol{x}_2+\cdots+a_r\boldsymbol{x}_r=\boldsymbol{0}.\]

    $\therefore$
    \[a_1f(\boldsymbol{x}_1)+\cdots+a_rf(\boldsymbol{x}_r)=\boldsymbol{0}\Leftrightarrow a_1\boldsymbol{x}_1+a_2\boldsymbol{x}_2+\cdots+a_r\boldsymbol{x}_r=\boldsymbol{0}.\]
    
    若 $\boldsymbol{x}_1,\boldsymbol{x}_2,\cdots,\boldsymbol{x}_r$ 线性无关, 则
    \[a_1\boldsymbol{x}_1+a_2\boldsymbol{x}_2+\cdots+a_r\boldsymbol{x}_r=\boldsymbol{0}\Rightarrow a_i=0,\]

    $\therefore$
    \[a_1f(\boldsymbol{x}_1)+\cdots+a_rf(\boldsymbol{x}_r)=\boldsymbol{0}\Leftrightarrow a_1\boldsymbol{x}_1+a_2\boldsymbol{x}_2+\cdots+a_r\boldsymbol{x}_r=\boldsymbol{0}\Rightarrow a_i=0,\]

    即 $f(\boldsymbol{x}_1),\cdots,f(\boldsymbol{x}_r)$ 线性无关.

    同理, 若 $f(\boldsymbol{x}_1),\cdots,f(\boldsymbol{x}_r)$ 线性无关, 则 $\boldsymbol{x}_1,\boldsymbol{x}_2,\cdots,\boldsymbol{x}_r$ 线性无关. 取逆否命题为: 若 $\boldsymbol{x}_1,\boldsymbol{x}_2,\cdots,\boldsymbol{x}_r$ 线性相关, 则 $f(\boldsymbol{x}_1),\cdots,f(\boldsymbol{x}_r)$ 线性相关.

    $\therefore$ 若 $\boldsymbol{x}_1,\boldsymbol{x}_2,\cdots,\boldsymbol{x}_r$ 是 $U$ 的一个基, 则 $f(\boldsymbol{x}_1),\cdots,f(\boldsymbol{x}_r)$ 是 $V$ 的一个基.

    $\therefore\forall\boldsymbol{x}\in V,\boldsymbol{x}$ 有分解式
    \[\boldsymbol{x}=\alpha_1f(\boldsymbol{x}_1)+\cdots+\alpha_rf(\boldsymbol{x}_r).\]

    $\therefore\exists\boldsymbol{y}=\alpha_1\boldsymbol{x}_1+\cdots+\alpha_r\boldsymbol{x}_r\in U$ 使得 $f(\boldsymbol{y})=\boldsymbol{x}.\therefore f$ 是满射. $\therefore f$ 是同构.
\end{proof}
\begin{note}
    从上述定理的证明中可以得到 $\dim U=\dim V$. 之所以不用书上的定理 5 证明, 是因为定理 5 只能得到 $U\simeq V$, 不能说明 $f$ 是同构.
\end{note}
\subsection{商空间}
书上定理 9 中补空间的构造依赖于 $V$ 的基的选取, 所以我们需要找到一种不依赖于基的选取的构造补空间的方法.

类比剩余类环, 定义
\begin{definition}
    设 $U$ 是 $V$ 的子空间. 对 $\boldsymbol{x}\in V$, 定义\textbf{陪集}和\textbf{商集}
    \[\bar{\boldsymbol{x}}=\{\boldsymbol{x}+\boldsymbol{u}|\boldsymbol{u}\in U\},\quad V/U=\{\bar{\boldsymbol{x}}|\boldsymbol{x}\in V\}.\]

    定义陪集的运算
    \[\bar{\boldsymbol{x}}+\bar{\boldsymbol{y}}=\overline{\boldsymbol{x}+\boldsymbol{y}},\quad\lambda\bar{\boldsymbol{x}}=\overline{\lambda\boldsymbol{x}}\ (\lambda\in K).\]
\end{definition}
有几个简单的性质(类比剩余类环的性质).
\begin{property}\label{p1.3}
    (1) $\bar{\boldsymbol{x}}=\bar{\boldsymbol{y}}\Leftrightarrow\boldsymbol{x}-\boldsymbol{y}\in U$.

    (2) 陪集的运算与代表元的选取无关.

    (3) $V/U$ 与陪集的运算构成 $K$ 上的线性空间.
\end{property}
\begin{proof}
    (1) ($\Rightarrow$) $\because\bar{\boldsymbol{x}}=\bar{\boldsymbol{y}},\therefore\exists\boldsymbol{u}_1\in U$ 使得 $\boldsymbol{x}+\boldsymbol{u}_1\in\bar{\boldsymbol{y}},\therefore\exists\boldsymbol{u}_1,\boldsymbol{u}_2\in U$ 使得 $\boldsymbol{x}+\boldsymbol{u}_1=\boldsymbol{y}+\boldsymbol{u}_2$.

    $\therefore\boldsymbol{x}-\boldsymbol{y}=\boldsymbol{u}_2-\boldsymbol{u}_1\in U$.

    ($\Leftarrow$) 设 $\boldsymbol{x}=\boldsymbol{y}+\boldsymbol{u}_0$, 其中 $\boldsymbol{u}_0\in U$, 则
    \begin{align*}
        \bar{\boldsymbol{x}} & =\{\boldsymbol{x}+\boldsymbol{u}|\boldsymbol{u}\in U\} \\
        & =\{\boldsymbol{x}+\boldsymbol{u}_0+\boldsymbol{u}|\boldsymbol{u}\in U\} \\
        & =\{\boldsymbol{y}+\boldsymbol{u}|\boldsymbol{u}\in U\}=\bar{\boldsymbol{y}}.
    \end{align*}

    (2) 只需验证: 若 $\bar{\boldsymbol{x}}=\bar{\boldsymbol{x}}',\bar{\boldsymbol{y}}=\bar{\boldsymbol{y}}'$, 则 $\bar{\boldsymbol{x}}+\bar{\boldsymbol{y}}=\bar{\boldsymbol{x}}'+\bar{\boldsymbol{y}}',\lambda\bar{\boldsymbol{x}}=\lambda\bar{\boldsymbol{x}}'$. 由 (1) 和子空间的性质得.

    (3) 由 (2), 陪集的运算可以归结为代表元的运算, 而代表元的运算满足线性空间运算的公理.
\end{proof}
\begin{theorem}[书上的定理 10]
    设 $U\oplus W=V$, 则映射
    \[\varphi:\begin{array}{rcl}
        W & \to & V/U \\
        \boldsymbol{x} & \to & \bar{\boldsymbol{x}} \\
    \end{array}\]
    是同构.
\end{theorem}
\begin{proof}
    由性质 \ref{p1.3}(2) 得 $\varphi$ 是确切定义的.
    
    由性质 \ref{p1.3}(1), $\bar{\boldsymbol{x}}=\bar{\boldsymbol{y}}\Leftrightarrow\boldsymbol{x}-\boldsymbol{y}\in U.\because\boldsymbol{x}-\boldsymbol{y}\in W,\therefore\boldsymbol{x}-\boldsymbol{y}\in U\cap W$.

    $\because U\oplus W=V$, 由定理 \ref{t1.4} 的证明得 $U\cap W=\{\boldsymbol{0}\},\therefore\boldsymbol{x}-\boldsymbol{y}=\boldsymbol{0},\boldsymbol{x}=\boldsymbol{y}.\therefore\varphi$ 是单射.

    $\because U\oplus W=V,\therefore\forall\boldsymbol{y}\in V,\exists\boldsymbol{u}\in U,\boldsymbol{w}\in W$ 使得 $\boldsymbol{y}=\boldsymbol{u}+\boldsymbol{w}\Rightarrow\bar{\boldsymbol{y}}=\bar{\boldsymbol{u}}+\bar{\boldsymbol{w}}$.

    $\because\boldsymbol{u}-\boldsymbol{0}\in U$, 由性质 \ref{p1.3}(1) 得 $\bar{\boldsymbol{w}}=\bar{\boldsymbol{0}}$.

    $\therefore\bar{\boldsymbol{u}}+\bar{\boldsymbol{w}}=\bar{\boldsymbol{0}}+\bar{\boldsymbol{w}}=\bar{\boldsymbol{w}}$.
    
    $\therefore\exists\boldsymbol{w}\in W$ 使得 $\boldsymbol{y}=\varphi(\boldsymbol{w}).\therefore\varphi$ 是满射.
    
    由陪集运算的定义得 $\varphi$ 是同构.
\end{proof}

设 $U$ 是 $V$ 的子空间. 当 $\dim V=\infty$ 时, 书上对于 $\codim U$ 的定义没有意义. 这时可以令 $\codim U=\dim V/U$.

在无穷维空间 $V$ 中与有限维空间类似地定义补空间.
\begin{definition}
    设 $U,W$ 是 $V$ 的子空间. 如果 $U+W=V,U\cap W=\{0\}$, 则称 $W$ 为 $U$ 的 \textbf{补空间}. 特别地, 当 $U$ 是 $V$ 的非平凡子空间时, 有 $U\oplus W=V$.
\end{definition}

需要注意的是, 这里没有断言 $U$ 的补空间一定存在.

设 $U$ 是 $V$ 的子空间, 只有在 $\codim U$ 有限时讨论 $U$ 的补空间的维数才有意义. 先证明一个引理.
\begin{lemma}\label{l1.1}
    设 $U$ 是有限维向量空间, $W$ 是线性空间(可以是无限维的). 如果线性映射 $\varphi:U\to W$ 是满射, 则 $W$ 是有限维的, 且 $\dim W\leq\dim U$. 等号成立当且仅当 $\varphi$ 是同构.
\end{lemma}
\begin{proof}
    设 $\dim U=n,U$ 的一个基为 $\boldsymbol{u}_1,\boldsymbol{u}_2,\cdots,\boldsymbol{u}_n$. 有
    \[W=\im\varphi=\left<\varphi(\boldsymbol{u}_1),\varphi(\boldsymbol{u}_2),\cdots,\varphi(\boldsymbol{u}_n)\right>.\]

    $\therefore$
    \begin{equation}\label{eq1.2}
        \dim W\leq n=\dim U.
    \end{equation}

    由书上的定理 5 得 $\dim U=\dim V\Rightarrow U\simeq V$.
    
    如果 $\varphi$ 是同构, 则 $\varphi^{-1}:W\to U$ 存在且为满射. $\therefore$ 有 $\dim U\leq\dim W$. 由式 (\ref{eq1.2}) 得 $\dim U=\dim W$.
\end{proof}
\begin{theorem}\label{t1.7}
    设 $U$ 是线性空间(可以是无限维的) $V$ 的子空间. 如果 $\codim U$ 是有限数, 则存在 $V$ 的 $\codim U$ 维子空间 $W$ 使得 $W$ 是 $U$ 的子空间.
\end{theorem}
\begin{proof}
    对 $\codim U$ 用数学归纳法. 当 $\codim U=0$ 时, 有 $V/U=\{0\}$. $\therefore\forall\boldsymbol{v}\in V,\exists\boldsymbol{u}\in U$ 使得 $\boldsymbol{v}=\boldsymbol{0}+\boldsymbol{u}=\boldsymbol{u}$. $\therefore U\supset V$. $\because U\subset V$, $\therefore U=V$. $\therefore\exists W=\{0\}$ 使得 $V=U=U+\{0\}$.

    假设当 $\codim U\leq k$ 时命题成立. 设 $\codim U=k+1$.

    假设 $\forall\boldsymbol{x}\in V,\boldsymbol{x}\in U$, 则 $\therefore V/U=V/V\simeq\{0\}$, 与 $\dim V/U=\codim U>0$ 矛盾.

    设 $\boldsymbol{w}\in V\backslash U$, 则 $\left<\boldsymbol{w}\right>+U$ 是直和. 考虑映射
    \[\varphi:\begin{array}{rcl}
        V/U & \to & V/(\left<\boldsymbol{w}\right>\oplus U) \\
        \boldsymbol{v}+U & \mapsto & \boldsymbol{v}+(\left<\boldsymbol{w}\right>\oplus U) \\
    \end{array}\]

    容易验证 $\varphi$ 是线性的, 且是满射. $\because\forall k\in K,\varphi(\boldsymbol{v}+U)=\varphi(\boldsymbol{v}+k\boldsymbol{w}+U)$, $\therefore\varphi$ 不是单射. 由引理 \ref{l1.1} 得
    \[\codim(\left<\boldsymbol{w}\right>\oplus U)=\dim V/(\left<\boldsymbol{w}\right>\oplus U)<\dim V/U=\codim U.\]

    由归纳假定得 $\exists W'$ 使得 $W'+(\left<\boldsymbol{w}\right>\oplus U)=V,W'\cap(\left<\boldsymbol{w}\right>\oplus U)=\{\boldsymbol{0}\}$. 由第 \ref{ex2.4} 题得 $W'+\left<\boldsymbol{w}\right>+U$ 是直和.
    
    $\therefore\exists W=W'\oplus\left<\boldsymbol{w}\right>$ 使得 $W\oplus U=V$.

    考虑映射
    \[\psi:\begin{array}{rcl}
        W & \to & V/U \\
        \boldsymbol{w} & \mapsto & \boldsymbol{w}+U \\
    \end{array}.\]

    $\because W\oplus U=V$, $\therefore\forall\boldsymbol{v}\in V,\exists\boldsymbol{w}\in W,\boldsymbol{u}\in U$ 使得
    \[\psi(\boldsymbol{v})=\boldsymbol{v}+U=\boldsymbol{w}+\boldsymbol{u}+U=\boldsymbol{w}+U=\psi(\boldsymbol{w}),\]

    $\therefore\psi$ 是同构, 有 $\dim W=\dim V/U=\codim U$.
\end{proof}
\subsection{一些例子}
\begin{example}
    从子空间产生的一些流形具有很好的几何结构.

    (1) 设 $\boldsymbol{e}_1,\boldsymbol{e}_2,\cdots,\boldsymbol{e}_n$ 是 $V$ 的一个基. 设
    \[V_i=\left<\boldsymbol{e}_1,\cdots,\boldsymbol{e}_i\right>,\quad i=1,2,\cdots,n,\]

    则 $\dim V_i=i$,
    \[0\subset V_1\subset V_2\subset\cdots\subset V_n=V.\]
    
    所有由上式定义的子空间链组成的集合称为\textbf{旗流形}.

    (2) 称
    \[G_{n,m}=\{U\subset V|\dim U=m\}\]
    为\textbf{Grassmann 流形}.
\end{example}
\section{对偶空间(对应教材1.3节)}
下面证明线性函数的一些简单的性质.
\begin{property}\label{p2.1}
    设 $f,g\in V^*$, 则 $f\circ g\in V^*$.
\end{property}
\begin{proof}
    由 $\forall a,b\in K,\boldsymbol{x},\boldsymbol{y}\in V$,
    \[f(g(a\boldsymbol{x}+b\boldsymbol{y}))=f(ag(\boldsymbol{x})+bg(\boldsymbol{y}))=af(g(\boldsymbol{x}))+bf(g(\boldsymbol{y}))\]
    得.
\end{proof}

分析学通过构造不同的函数来研究集合 $\mathbb{R}^n,\mathbb{C}^n$ 的性质, 类似地, 我们可以通过研究 $V$ 上的线性函数来研究线性空间的性质.

设 $f$ 是线性函数, $\boldsymbol{e}_1,\boldsymbol{e}_2,\cdots,\boldsymbol{e}_n$ 是 $V$ 的基, 则有
\begin{equation}\label{eq2.1}
    f(\lambda_1\boldsymbol{e}_1+\cdots+\lambda_n\boldsymbol{e}_n)=\lambda_1f(\boldsymbol{e}_1)+\cdots+\lambda_nf(\boldsymbol{e}_n).
\end{equation}

$\therefore f$ 只由其在基 $\boldsymbol{e}_1,\boldsymbol{e}_2,\cdots,\boldsymbol{e}_n$ 上的值确定. 反之, 如果有 $n$ 个纯量 $\beta_i\in K$, 定义 $f(\boldsymbol{e}_i)=\beta_i,f$ 在其余向量上的值由式 (\ref{eq2.1}) 定义. 设 $\boldsymbol{x}=\lambda_1\boldsymbol{e}_1+\cdots+\lambda_n\boldsymbol{e}_n,\boldsymbol{y}=\mu_1\boldsymbol{e}_1+\cdots+\mu_n\boldsymbol{e}_n$, 则
\begin{align*}
    f(\lambda\boldsymbol{x}+\mu\boldsymbol{y}) & =f(\lambda(\lambda_1\boldsymbol{e}_1+\cdots+\lambda_n\boldsymbol{e}_n)+\mu(\mu_1\boldsymbol{e}_1+\cdots+\mu_n\boldsymbol{e}_n)) \\
    & =f((\lambda\lambda_1+\mu\mu_1)\boldsymbol{e}_1+(\lambda\lambda_n+\mu\mu_n)\boldsymbol{e}_n) \\
    & =(\lambda\lambda_1+\mu\mu_1)f(\boldsymbol{e}_1)+\cdots+(\lambda\lambda_n+\mu\mu_n)f(\boldsymbol{e}_n) \\
    & =\lambda(\lambda_1f(\boldsymbol{e}_1)+\cdots+\lambda_nf(\boldsymbol{e}_n))+\mu(\mu_1f(\boldsymbol{e}_1)+\cdots+\mu_nf(\boldsymbol{e}_n)) \\
    & =\lambda f(\boldsymbol{x})+\mu f(\boldsymbol{y}),
\end{align*}

$\therefore f$ 是线性函数. $\therefore$ 在线性函数全体 $V^*\in K^V$ 和 $K^n$ 间可以建立双射:
\begin{theorem}\label{t2.1}
    给定一个基 $\boldsymbol{e}_1,\boldsymbol{e}_2,\cdots,\boldsymbol{e}_n$, 则
    \[\varphi:\begin{array}{rcl}
        V^* & \to & K^n \\
        f & \to & (f(\boldsymbol{e}_1),f(\boldsymbol{e}_2),\cdots,f(\boldsymbol{e}_n)) \\
    \end{array}.\]
    是双射.
\end{theorem}
\begin{proof}
    由式 (\ref{eq2.1}) 得若 $f(\boldsymbol{e}_i)=0$, 则 $\forall\boldsymbol{x},f(\boldsymbol{x})=0$, 即 $\ker\varphi=\{0\}.\therefore\varphi$ 是单射. 由式 (\ref{eq2.1}) 后面的讨论得 $f$ 是满射. 
\end{proof}

由上面的定理, 可以将函数与向量等同起来. 与之类似的看法在数学中很常见. 比如说生成函数([BAI] 第 5 章习题 3.6)就是将幂级数与数列等同起来.

设 $(\boldsymbol{e}_1,\boldsymbol{e}_2,\cdots,\boldsymbol{e}_n)$ 和 $(\boldsymbol{e}_1',\boldsymbol{e}_2',\cdots,\boldsymbol{e}_n')$ 是 $V$ 的基且满足式 (\ref{eq1.1}), $\boldsymbol{x}=\lambda_1\boldsymbol{e}_1 +\cdots+\lambda_n\boldsymbol{e}_n=\lambda_1'\boldsymbol{e}_1'+\cdots+\lambda_n'\boldsymbol{e}_n'$. 将 (\ref{eq2.1}) 写成坐标的形式:
\[f(\boldsymbol{x})=(f(\boldsymbol{e}_1),f(\boldsymbol{e}_2),\cdots,f(\boldsymbol{e}_n))\begin{pmatrix}
    \lambda_1 \\
    \lambda_2 \\
    \vdots \\
    \lambda_n
\end{pmatrix}.\]

$\because$
\[\boldsymbol{e}_i'=a_{1i}\boldsymbol{e}_1+\cdots+a_{ni}\boldsymbol{e}_n,\]

$\therefore$
\[f(\boldsymbol{e}_i')=(f(\boldsymbol{e}_1),f(\boldsymbol{e}_2),\cdots,f(\boldsymbol{e}_n))\begin{pmatrix}
    a_{1i} \\
    a_{2i} \\
    \vdots \\
    a_{ni}
\end{pmatrix},\]
\[(f(\boldsymbol{e}_1'),f(\boldsymbol{e}_2'),\cdots,f(\boldsymbol{e}_n'))=(f(\boldsymbol{e}_1),f(\boldsymbol{e}_2),\cdots,f(\boldsymbol{e}_n))\begin{pmatrix}
    a_{11} & a_{12} & \cdots & a_{1n} \\
    a_{21} & a_{22} & \cdots & a_{2n} \\
    \vdots & \vdots & \ddots & \vdots \\
    a_{n1} & a_{n2} & \cdots & a_{nn} \\
\end{pmatrix}.\]

$\therefore$
\[\boldsymbol{x}=(f(\boldsymbol{e}_1'),f(\boldsymbol{e}_2'),\cdots,f(\boldsymbol{e}_n'))\begin{pmatrix}
    \lambda_1' \\
    \lambda_2' \\
    \vdots \\
    \lambda_n'
\end{pmatrix}=(f(\boldsymbol{e}_1),f(\boldsymbol{e}_2),\cdots,f(\boldsymbol{e}_n))A\begin{pmatrix}
    \lambda_1' \\
    \lambda_2' \\
    \vdots \\
    \lambda_n'
\end{pmatrix},\]

其中 $A=(a_{ij})$ 是变换矩阵.

定义
\[\psi:\begin{array}{rcl}
    V^*\times V & \to & K \\
    (f,\boldsymbol{x}) & \to & f(\boldsymbol{x}) \\
\end{array}.\]

由线性函数的定义,
\[(\alpha f+\beta g)(\boldsymbol{x})=\alpha(f(\boldsymbol{x}))+\beta(g(\boldsymbol{x})),\quad f(\alpha\boldsymbol{x}+\beta\boldsymbol{y})=\alpha f(\boldsymbol{x})+\beta f(\boldsymbol{y}),\]

$\therefore$
\[\psi(\alpha f+\beta g,\boldsymbol{x})=\alpha\psi(f,\boldsymbol{x})+\beta\psi(g,\boldsymbol{x}),\quad\psi(f,\alpha\boldsymbol{x}+\beta\boldsymbol{y})=\alpha\psi(f,\boldsymbol{x})+\beta\psi(g,\boldsymbol{y}).\]

如果将 $\psi(f,\boldsymbol{x})$ 看成是 $f$ 的函数, 那么就得到了书上定理 2 的函数 $\varepsilon_{\boldsymbol{x}}(f)=\psi(f,\boldsymbol{x})$.

由 $\psi(f,\boldsymbol{x})$ 的双线性得 $\varepsilon_{\boldsymbol{x}}$ 是线性函数.

补充书上对于 $\varepsilon(\boldsymbol{x})$ 的定理的另一种证明.
\begin{theorem}[书上定理 2 的补充]
    书上定理 2 定义的 $\varepsilon$ 是双射.
\end{theorem}
\begin{proof}
    若 $\varepsilon(\boldsymbol{x})=0$, 则 $\forall f\in V^*,\varepsilon_{\boldsymbol{x}}(f)=0$.

    假设 $\boldsymbol{x}\neq\boldsymbol{0}$, 可以将 $f$ 扩充为 $V$ 的一个基 $\boldsymbol{x},\boldsymbol{x}_2,\cdots,\boldsymbol{x}_n$.
    
    由定理 \ref{t2.1} (沿用定理中 $\varphi$ 的记号), $\exists f$ 使得 $\varphi(f)=(1,0,0,\cdots,0).\therefore\exists f$ 使得 $f(\boldsymbol{x})=1$, 与 $\forall f\in V^*,\varepsilon_{\boldsymbol{x}}(f)=f(\boldsymbol{x})=0$ 矛盾. $\therefore\boldsymbol{x}=\boldsymbol{0},\varepsilon$ 是单射.

    由定理 \ref{t1.5} 得 $\varepsilon$ 是双射.
\end{proof}

书上定理 2 定义的 $\varepsilon$ 被称为\textbf{自然同构}, 因为这个同构与基的选取无关. 相反的, 给定 $V$ 的一个基 $(\boldsymbol{e}_i)$, 形如
\[f:\begin{array}{rcl}
    V & \to & \mathbb{R}^n \\
    a_1\boldsymbol{e}_1+a_2\boldsymbol{e}_2+\cdots+a_n\boldsymbol{e}_n & \to & (a_1,a_2,\cdots,a_n) \\
\end{array}\]
的同构依赖于基的选取, 所以是不自然的.

举几个具体的例子.
\begin{example}
    设 $V=\left<e^{imx}=\cos mx+i\sin mx|m=1,2,\cdots,n\right>,\lambda\in\mathbb{R}$, 
    容易验证
    \[f_k:\begin{array}{rcl}
        V & \to & \mathbb{R} \\
        \varphi & \to & \dfrac{1}{2\pi}\int_0^{2\pi}\varphi(x)e^{-ikx}\mathrm{d}x \\
    \end{array}\]
    是线性函数. 容易验证
    \[f_k(e^{imx})=\delta_{km},\quad V^*=\left<f_k|k=1,2,\cdots,n\right>.\]

    这是 Fourier 分析的本质.
\end{example}
\section{双线性型和二次型(对应教材1.4节)}
\subsection{双线性型}
在 $\mathcal{L}_2(V,K)$ 上定义
\[(\alpha f+\beta g)(\boldsymbol{u},\boldsymbol{v})=\alpha f(\boldsymbol{u},\boldsymbol{v})+\beta g(\boldsymbol{u},\boldsymbol{v}),\]

容易验证 $\mathcal{L}_2(V,K)$ 是域 $K$ 上的线性空间.

证明书上的定理 1 需要先证明一个引理.
\begin{lemma}\label{l3.1}
    设 $F=(f_{ij}),G=(g_{ij})\in M_n(K)$. 如果 $\forall X,Y\in K^n$, 有
    \[{}^tXFY={}^tXGY,\]

    则 $F=G$.
\end{lemma}
\begin{proof}
    设 $E^{(i)}=(0,\cdots,0,1(\text{第}i\text{个}),0,\cdots,0)$, 则 $f_{ij}={}^tE^{(i)}FE^{(j)},g_{ij}={}^tE^{(i)}GE^{(j)}$.

    $\because$
    \[{}^tE^{(i)}FE^{(j)}={}^tE^{(i)}GE^{(j)}\quad(1\leq i,j\leq n),\]

    $\therefore f_{ij}=g_{ij}\ (1\leq i,j\leq n),\therefore F=G$.
\end{proof}
\begin{theorem}[书上的定理 1]\label{t3.1}
    $V$ 上的双线性型 $f$ 在基 $(\boldsymbol{e}_i)$ 和 $(\boldsymbol{e}_i')$ 下的矩阵 $F,F'$ 可由
    \[F'={}^tAFA\]
    联系起来, 其中 $A$ 是 $(\boldsymbol{e}_i)$ 到 $(\boldsymbol{e}_i')$ 的转换矩阵.
\end{theorem}
\begin{proof}
    与书上相同, 得
    \[{}^tX'\cdot F'\cdot Y'={}^tX'\cdot{}^tA\cdot F\cdot A\cdot Y'.\]

    $\because{}^tX',Y'$ 是任意的向量, 由引理 \ref{l3.1} 得 $F'={}^tA\cdot F\cdot A$.
\end{proof}
定理 \ref{t3.1} 保证了下面的定义是合理的. 事实上, 若 $f$ 在 $V$ 的某个基下的矩阵非退化, 则 $f$ 在 $V$ 的任一基下的矩阵非退化.
\begin{definition}
    设 $f\in\mathcal{L}_2(V,K)$. 称 $f$ \textbf{非退化}当且仅当 $f$ 在 $V$ 的某个基下的矩阵非退化.
\end{definition}
\subsection{对称双线性型}
证明几个性质.
\begin{property}\label{p3.1}
    设 $f$ 是双线性型, $f$ 在基 $(\boldsymbol{e}_i)$ 下的矩阵为 $F$, 则 $f$ 是对称的当且仅当 $F$ 是对称矩阵.
\end{property}
\begin{proof}
    ($\Rightarrow$) 有 $f(\boldsymbol{e}_i,\boldsymbol{e}_j)=f(\boldsymbol{e}_i,\boldsymbol{e}_j)\Rightarrow f_{ij}=f_{ji}$.

    ($\Leftarrow$) 设 $\forall\boldsymbol{x},\boldsymbol{y}$ 在基 $(\boldsymbol{e}_i)$ 下的坐标为 $(x_i),(y_i)$, 由书上的式 (3) 得
    \[f(\boldsymbol{x},\boldsymbol{y})=\sum\limits_{i,j}f_{ij}x_iy_j.\]

    $\because f_{ij}=f_{ji},\therefore$
    \[\sum\limits_{i,j}f_{ij}x_iy_j=\sum\limits_{i,j}f_{ji}x_iy_j=\sum\limits_{i,j}f_{ij}y_ix_j=f(\boldsymbol{y},\boldsymbol{x}).\qedhere\]
\end{proof}
上述性质不依赖于基的选取, $\therefore$ 对称矩阵 $F$ 的合同 $F'={}^tAFA$ 也是对称的.

类似地, 可以证明: $f$ 是斜对称的当且仅当 $^tF=-F$.
\subsection{二次型}
\begin{theorem}
    设 $f$ 是 $V$ 上任一对称的双线性型, 则由 $q(\boldsymbol{x})=f(\boldsymbol{x},\boldsymbol{x})$ 定义的 $q$ 是二次型.
\end{theorem}
\begin{proof}
    设 $\boldsymbol{x}$ 在基 $(\boldsymbol{e}_i)$ 下的坐标为 $(x_i),F_{ij}=f(\boldsymbol{e}_i,\boldsymbol{e}_j)$, 则
    \[f(-\boldsymbol{x},-\boldsymbol{x})=\sum\limits_{i,j}f_{ij}(-x_i)(-x_j)=\sum\limits_{i,j}f_{ij}x_ix_j=f(\boldsymbol{x},\boldsymbol{x}).\]

    $\therefore q(-\boldsymbol{x})=q(\boldsymbol{x})$.

    $\because$
    \begin{align*}
        \dfrac{q(\boldsymbol{x}+\boldsymbol{y})-q(\boldsymbol{x})-q(\boldsymbol{y})}{2} & =\dfrac{f(\boldsymbol{x}+\boldsymbol{y},\boldsymbol{x}+\boldsymbol{y})-f(\boldsymbol{x},\boldsymbol{x})-f(\boldsymbol{y},\boldsymbol{y})}{2} \\
        & =\dfrac{f(\boldsymbol{x}+\boldsymbol{y},\boldsymbol{x})+f(\boldsymbol{x}+\boldsymbol{y},\boldsymbol{y})-f(\boldsymbol{x},\boldsymbol{x})-f(\boldsymbol{y},\boldsymbol{y})}{2} \\
        & =\dfrac{f(\boldsymbol{x},\boldsymbol{x})+f(\boldsymbol{y},\boldsymbol{x})+f(\boldsymbol{x},\boldsymbol{y})+f(\boldsymbol{y},\boldsymbol{y})-f(\boldsymbol{x},\boldsymbol{x})-f(\boldsymbol{y},\boldsymbol{y})}{2} \\
        & =\dfrac{f(\boldsymbol{y},\boldsymbol{x})+f(\boldsymbol{x},\boldsymbol{y})}{2}.
    \end{align*}

    $\because f$ 是对称的, $\therefore$
    \[\dfrac{f(\boldsymbol{y},\boldsymbol{x})+f(\boldsymbol{x},\boldsymbol{y})}{2}=f(\boldsymbol{x},\boldsymbol{y}).\]

    由书上的定义 2 得 $f$ 是二次型.
\end{proof}

下面是书上定理 3 的另一种证明方法.
\begin{theorem}[书上的定理 3]
    $\forall$ 二次型 $q,\exists f\in\mathcal{L}_2(V,K)$ 使得 $\forall\boldsymbol{v}\in V,q(\boldsymbol{v})=f(\boldsymbol{v},\boldsymbol{v})$.
\end{theorem}
\begin{proof}
    设 $f(\boldsymbol{x},\boldsymbol{y})=\dfrac{1}{2}(q(\boldsymbol{x}+\boldsymbol{y})-q(\boldsymbol{x})-q(\boldsymbol{y}))$. 我们断言 $f$ 满足 $q(\boldsymbol{v})=f(\boldsymbol{v},\boldsymbol{v})$. 事实上, 有
    \[f\left(-\dfrac{1}{2}\boldsymbol{v},\boldsymbol{v}\right)=\dfrac{1}{2}\left(q\left(\dfrac{1}{2}\boldsymbol{v}\right)-q\left(-\dfrac{1}{2}\boldsymbol{v}\right)-q\left(\boldsymbol{v}\right)\right).\]

    $\because q(-\boldsymbol{x})=q(\boldsymbol{x}),\therefore$
    \[\dfrac{1}{2}\left(q\left(\dfrac{1}{2}\boldsymbol{v}\right)-q\left(-\dfrac{1}{2}\boldsymbol{v}\right)-q\left(\boldsymbol{v}\right)\right)=-\dfrac{1}{2}q\left(\boldsymbol{v}\right).\]

    $\because f\left(-\dfrac{1}{2}\boldsymbol{v},\boldsymbol{v}\right)=-\dfrac{1}{2}f(\boldsymbol{v},\boldsymbol{v}),\therefore$
    \[-\dfrac{1}{2}f(\boldsymbol{v},\boldsymbol{v})=-\dfrac{1}{2}q\left(\boldsymbol{v}\right).\qedhere\]
\end{proof}
\begin{theorem}[书上的定理 4]\label{t3.4}
    $V$ 上任一对称的双线性型 $f$ 都有规范基.
\end{theorem}
\begin{proof}
    $f=0$ 时任意的基都是 $f$ 的规范基. 下面只考虑 $f\neq0$ 的情况.

    对 $V$ 的维数用数学归纳法. 当 $\dim V=1$ 时, 任意的基都是 $f$ 的规范基. 假设 $\dim V=n-1$ 时 $V$ 上任一对称的双线性型 $f$ 都有规范基.

    $\because f\neq0,\therefore\exists\boldsymbol{e}_1$ 使得 $f(\boldsymbol{e}_1,\boldsymbol{e}_1)\neq0$. 设方程 $f(\boldsymbol{e}_1,\boldsymbol{x})=0$ 的解空间为 $L$, 由书上第 3 节的定理 4(i) 得 $\dim L=n-1$.
    
    设 $f$ 是 $V$ 上的对称的双线性型, 则 $f$ 在 $L$ 上的限制 $\bar{f}=f|_L$ 是 $L$ 上的对称的双线性型. 由归纳假定, $\exists L$ 的基 $\boldsymbol{e}_2,\boldsymbol{e}_3,\cdots,\boldsymbol{e}_n$ 使得
    \[\bar{f}(\boldsymbol{e}_i,\boldsymbol{e}_j)=0,\quad2\leq i\neq j\leq n.\]

    $\because$ 在 $L$ 上有 $\bar{f}=f,\therefore$
    \[f(\boldsymbol{e}_i,\boldsymbol{e}_j)=0,\quad2\leq i\neq j\leq n.\]

    $\because\boldsymbol{e}_2,\boldsymbol{e}_3,\cdots,\boldsymbol{e}_n$ 是方程 $f(\boldsymbol{e}_1,\boldsymbol{x})=0$ 的解, $\therefore$ 有
    \begin{equation}\label{eq3.1}
        f(\boldsymbol{e}_i,\boldsymbol{e}_j)=0,\quad1\leq i\neq j\leq n.
    \end{equation}
    
    设 $a_1\boldsymbol{e}_1+a_2\boldsymbol{e}_2+\cdots+a_n\boldsymbol{e}_n=0$, 则
    \[f(\boldsymbol{e}_1,a_1\boldsymbol{e}_1+a_2\boldsymbol{e}_2+\cdots+a_n\boldsymbol{e}_n)=f(\boldsymbol{e}_1,0)=0.\]

    另一方面,
    \begin{align*}
        f(\boldsymbol{e}_1,a_1\boldsymbol{e}_1+a_2\boldsymbol{e}_2+\cdots+a_n\boldsymbol{e}_n) & =\sum\limits_{i=1}^nf(\boldsymbol{e}_1,a_i\boldsymbol{e}_i) \\
        & =\sum\limits_{i=1}^na_if(\boldsymbol{e}_1,\boldsymbol{e}_i) \\
        & =a_1f(\boldsymbol{e}_1,\boldsymbol{e}_1).
    \end{align*}

    $\because f(\boldsymbol{e}_1,\boldsymbol{e}_1)\neq0,\therefore a_1=0,\therefore a_2\boldsymbol{e}_2+\cdots+a_n\boldsymbol{e}_n=0$.

    $\because\boldsymbol{e}_2,\boldsymbol{e}_3,\cdots,\boldsymbol{e}_n$ 是 $L$ 的一个基, $\therefore\boldsymbol{e}_2,\boldsymbol{e}_3,\cdots,\boldsymbol{e}_n$ 线性无关, $\therefore a_2=a_3=\cdots=a_n=0.\therefore\boldsymbol{e}_1,\boldsymbol{e}_2,\cdots,\boldsymbol{e}_n$ 线性无关.

    $\therefore\boldsymbol{e}_1,\boldsymbol{e}_2,\cdots,\boldsymbol{e}_n$ 是 $V$ 的基, 且满足 (\ref{eq3.1}). $\therefore\boldsymbol{e}_1,\boldsymbol{e}_2,\cdots,\boldsymbol{e}_n$ 是 $f$ 的规范基.
\end{proof}
\subsection{正定二次型}
\begin{theorem}[书上的定理 6]
    $F\in M_n(\mathbb{R})$ 正定当且仅当 $\exists B\in GL _n(\mathbb{R})$ 使得 $F={}^tBB$.
\end{theorem}
\begin{proof}
    设双线性型 $f$ 在基 $(\boldsymbol{e}_i)$ 下的矩阵为 $F$.
    
    $(\Rightarrow)\because F$ 是正定的, $\therefore f$ 是正定的, $\therefore\exists$ 基 $(\boldsymbol{e}_i')$ 满足 $f$ 在基下的矩阵为 $E.\therefore\exists B\in GL _n(\mathbb{R}),F={}^tBEB={}^tBB$.

    ($\Leftarrow$) 设 $F={}^tBB$. 由 [BAI] 第 2 章笔记的定理 1.1 得 $({}^tB)^{-1}={}^t(B^{-1})$. $\therefore$
    \[{}^t(B^{-1})FB^{-1}=({}^tB)^{-1}\cdot{}^tB\cdot B\cdot B^{-1}=E.\]

    $\therefore f$ 在基 $(\boldsymbol{e}_i')=(\boldsymbol{e}_1,\boldsymbol{e}_2,\cdots,\boldsymbol{e}_n)B^{-1}$ 下的矩阵为 $E.\therefore f$ 是正定的.
\end{proof}
为了找出从矩阵判断二次型是否正定的规律, 先考虑低维的情况.

当 $n=1$ 时设 $\boldsymbol{u}=x,F=(a)$ 对应的二次型为 $q(\boldsymbol{u})=ax^2$, 显然 $F$ 正定 $\Leftrightarrow a>0$.

当 $n=2$ 时设 $\boldsymbol{u}=x\boldsymbol{e}_1+y\boldsymbol{e}_2,F$ 和与之对应的二次型为
\[F=\begin{pmatrix}
    a & b \\
    b & c
\end{pmatrix},\quad q(\boldsymbol{u})=ax^2+2bxy+cy^2.\]

假设 $a=c=0$, 令 $\boldsymbol{u}=-b^{-1}y\boldsymbol{e}_1+y\boldsymbol{e}_2$, 则
\[q(\boldsymbol{u})=-2bb^{-1}y^2\leq0,\]

与 $q$ 正定矛盾. $\therefore a^2+c^2\neq0$. 不妨设 $a\neq0$. 可以将 $q(\boldsymbol{u})$ 配方:
\begin{equation}\label{eq3.2}
    q(\boldsymbol{u})=a\left(x+\dfrac{b}{a}y\right)^2+\left(c-\dfrac{b^2}{a}\right)y^2.
\end{equation}

假设 $a<0$, 令 $\boldsymbol{u}=\boldsymbol{e}_1$, 则
\[q(\boldsymbol{u})=ax^2<0,\]

与 $q$ 正定矛盾. $\therefore a>0$.

假设 $c-\dfrac{b^2}{a}<0$, 令 $\boldsymbol{u}=-\dfrac{b}{a}\boldsymbol{e}_1+\boldsymbol{e}_2$, 则
\[q(\boldsymbol{u})=\left(c-\dfrac{b^2}{a}\right)<0,\]

与 $q$ 正定矛盾. $\therefore c-\dfrac{b^2}{a}>0$.

$\because a>0,\therefore$ 上式两边乘 $a$ 得
\[\begin{vmatrix}
    a & b \\
    b & c
\end{vmatrix}=ac-b^2>0.\]

更高维的情况可以用类似的方法得到, 虽然随着维数的增加讨论的复杂程度也会增加.

从式 (\ref{eq3.2}) 猜想:
\begin{theorem}[书上的定理 7\footnote{这里的规范型的系数与书上定理 7 的互为倒数.}]\label{t3.6}
    设 $F$ 是实对称矩阵且 $F$ 的所有主子式 $\Delta_i\neq0$. 对相应的二次型 $q,\exists$ 基 $(\boldsymbol{e}_i)$(设 $\boldsymbol{x}$ 在基下的坐标为 $(x_1,x_2,\cdots,x_n)$)满足
    \[q(\boldsymbol{x})=\dfrac{\Delta_1}{\Delta_0}x_1^2+\dfrac{\Delta_2}{\Delta_1}x_2^2+\cdots+\dfrac{\Delta_n}{\Delta_{n-1}}x_n^2.\]
\end{theorem}
\begin{proof}
    对 $\dim V$ 用数学归纳法. $\dim V=1,2$ 的情形前面已经讨论过了.

    假设当 $\dim V=n-1$ 时成立. 设双线性型 $f$ 在基 $\boldsymbol{v}_1,\boldsymbol{v}_2,\cdots,\boldsymbol{v}_n$ 下的矩阵为 $F$.

    设 $f$ 在 $L=\left<\boldsymbol{v}_1,\boldsymbol{v}_2,\cdots,\boldsymbol{v}_{n-1}\right>$ 上的限制为 $\bar{f}$, 则其在基 $\boldsymbol{v}_1,\boldsymbol{v}_2,\cdots,\boldsymbol{v}_{n-1}$ 下的矩阵为
    \[\overline{F}=\begin{pmatrix}
        f_{11} & f_{12} & \cdots & f_{1,n-1} \\
        f_{12} & f_{22} & \cdots & f_{2,n-1} \\
        \vdots & \vdots & \ddots & \vdots \\
        f_{1,n-1} & f_{2,n-1} & \cdots & f_{n-1,n-1} \\
    \end{pmatrix}.\]

    $\therefore\overline{F}$ 的主子式 $\overline{\Delta}_i=\Delta_i\ (i=1,2,\cdots,n-1)$.

    由归纳假定, $\exists$ 基 $\boldsymbol{e}_1,\boldsymbol{e}_2,\cdots,\boldsymbol{e}_{n-1}$ 满足: 对 $1\leq i,j\leq n-1$, 有
    \[f(\boldsymbol{e}_i,\boldsymbol{e}_j)=\bar{f}(\boldsymbol{e}_i,\boldsymbol{e}_j)=\begin{cases}
        0 & i\neq j, \\
        \dfrac{\overline{\Delta}_i}{\overline{\Delta}_{i-1}}=\dfrac{\Delta_i}{\Delta_{i-1}} & i=j.
    \end{cases}\]

    考虑方程组
    \[f(\boldsymbol{x},\boldsymbol{e}_i)=0,\quad i=1,2,\cdots,n-1.\]

    由书上第 1.3 节的定理 4(i) 得解空间 $U$ 的维数为 $1$, 方程组有非零解. 设 $\boldsymbol{e}_n$ 是方程组的一个非零解.

    假设 $\boldsymbol{e}_1,\boldsymbol{e}_2,\cdots,\boldsymbol{e}_{n-1},\boldsymbol{e}_n$ 线性相关, 则 $\exists a_1,a_2,\cdots,a_{n-1}$ 使得
    \[\boldsymbol{e}_n=a_1\boldsymbol{e}_1+a_2\boldsymbol{e}_2+\cdots+a_{n-1}\boldsymbol{e}_{n-1}.\]

    $\because\boldsymbol{e}_n\neq0$, $\therefore a_1,a_2,\cdots,a_{n-1}$ 不全为 $0$. 设 $a_i\neq0$, 则
    \[f(\boldsymbol{e}_n,\boldsymbol{e}_i)=a_if(\boldsymbol{e}_i,\boldsymbol{e}_i)\neq0,\]

    与 $f(\boldsymbol{e}_n,\boldsymbol{e}_i)=0$ 矛盾. $\therefore\boldsymbol{e}_1,\boldsymbol{e}_2,\cdots,\boldsymbol{e}_{n-1},\boldsymbol{e}_n$ 是 $V$ 的一个基, 且满足
    \[f(\boldsymbol{e}_i,\boldsymbol{e}_j)=0,\quad1\leq i,j\leq n.\]
    
    设
    \[(\boldsymbol{v}_1,\boldsymbol{v}_2,\cdots,\boldsymbol{v}_n)=(\boldsymbol{e}_1,\boldsymbol{e}_2,\cdots,\boldsymbol{e}_{n-1},\boldsymbol{e}_n)A,\]

    则 $A\in GL_n(\mathbb{R}),F$ 有分解式
    \begin{equation}\label{eq3.3}
        F={}^tA\begin{pmatrix}
            f(\boldsymbol{e}_1,\boldsymbol{e}_1) \\
            & f(\boldsymbol{e}_2,\boldsymbol{e}_2) \\
            && \ddots \\
            &&& f(\boldsymbol{e}_n,\boldsymbol{e}_n)
        \end{pmatrix}A.
    \end{equation}

    $\because\forall\lambda\in\mathbb{R},\lambda\boldsymbol{e}_n\in U,\therefore\forall\lambda\in\mathbb{R},\boldsymbol{e}_1,\boldsymbol{e}_2,\cdots,\boldsymbol{e}_{n-1},\lambda\boldsymbol{e}_n$ 是规范基. 有
    \begin{align*}
        (\boldsymbol{v}_1,\boldsymbol{v}_2,\cdots,\boldsymbol{v}_n) & =(\boldsymbol{e}_1,\boldsymbol{e}_2,\cdots,\boldsymbol{e}_{n-1},\lambda\boldsymbol{e}_n)A_\lambda \\
        & =(\boldsymbol{e}_1,\boldsymbol{e}_2,\cdots,\boldsymbol{e}_{n-1},\lambda\boldsymbol{e}_n)\begin{pmatrix}
            1 \\
            & 1 \\
            && \ddots \\
            &&& 1 \\
            &&&& \lambda^{-1}
        \end{pmatrix}A.
    \end{align*}

    $\because A\neq0,\therefore$ 可以取合适的 $\lambda_0$ 使得 $\det A_{\lambda_0}=1$. 设
    \[\boldsymbol{e}_i'=\begin{cases}
        \boldsymbol{e}_i & i\leq n-1, \\
        \lambda_0\boldsymbol{e}_n, & i=n.
    \end{cases}\]

    则
    \begin{align*}
        \Delta_{n-1}f(\boldsymbol{e}_n',\boldsymbol{e}_n') & =\dfrac{\Delta_1}{\Delta_0}\dfrac{\Delta_2}{\Delta_1}\cdots\dfrac{\Delta_{n-1}}{\Delta_{n-2}}f(\boldsymbol{e}_n',\boldsymbol{e}_n') \\
        & =f(\boldsymbol{e}_1',\boldsymbol{e}_1')f(\boldsymbol{e}_2',\boldsymbol{e}_2')\cdots f(\boldsymbol{e}_{n-1}',\boldsymbol{e}_{n-1}')f(\boldsymbol{e}_n',\boldsymbol{e}_n') \\
        & =\begin{vmatrix}
            f(\boldsymbol{e}_1',\boldsymbol{e}_1') \\
            & f(\boldsymbol{e}_2',\boldsymbol{e}_2') \\
            && \ddots \\
            &&& f(\boldsymbol{e}_n',\boldsymbol{e}_n')
        \end{vmatrix}.
    \end{align*}

    由式 (\ref{eq3.3}),
    \[F={}^tA_{\lambda_0}\begin{pmatrix}
        f(\boldsymbol{e}_1',\boldsymbol{e}_1') \\
        & f(\boldsymbol{e}_2',\boldsymbol{e}_2') \\
        && \ddots \\
        &&& f(\boldsymbol{e}_n',\boldsymbol{e}_n')
    \end{pmatrix}A_{\lambda_0},\]

    $\therefore$
    \[\begin{vmatrix}
        f(\boldsymbol{e}_1',\boldsymbol{e}_1') \\
        & f(\boldsymbol{e}_2',\boldsymbol{e}_2') \\
        && \ddots \\
        &&& f(\boldsymbol{e}_n',\boldsymbol{e}_n')
    \end{vmatrix}=\det({}^t(A_{\lambda_0}^{-1})FA_{\lambda_0}^{-1})=\Delta_n.\]

    $\therefore f(\boldsymbol{e}_n',\boldsymbol{e}_n')=\dfrac{\Delta_n}{\Delta_{n-1}}$.
\end{proof}
\subsection{斜对称二次型}
仍然先考虑低维的情况.

设 $\dim V=2,f\neq0\in\mathcal{L}_2^-(V,K).\because f\neq0,\therefore\exists\boldsymbol{e}_1',\boldsymbol{e}_2'\in V,a\in K$ 使得 $f(\boldsymbol{e}_1',\boldsymbol{e}_2')=a\neq0.\therefore\exists\boldsymbol{e}_1=\boldsymbol{e}_1',\boldsymbol{e}_2=\dfrac{1}{a}\boldsymbol{e}_2'\in V$ 使得 $f(\boldsymbol{e}_1,\boldsymbol{e}_2)=1$.

$\because f(\boldsymbol{e}_i,\boldsymbol{e}_i)=0,\therefore$
\begin{align*}
    f(\boldsymbol{e}_2,\boldsymbol{e}_1)+f(\boldsymbol{e}_1,\boldsymbol{e}_2) & =f(\boldsymbol{e}_2,\boldsymbol{e}_1)+f(\boldsymbol{e}_1,\boldsymbol{e}_2)+f(\boldsymbol{e}_2,\boldsymbol{e}_2)+f(\boldsymbol{e}_1,\boldsymbol{e}_1) \\
    & =f(\boldsymbol{e}_2,\boldsymbol{e}_1+\boldsymbol{e}_2)+f(\boldsymbol{e}_1,\boldsymbol{e}_1+\boldsymbol{e}_2) \\
    & =f(\boldsymbol{e}_1+\boldsymbol{e}_2,\boldsymbol{e}_1+\boldsymbol{e}_2)=0,
\end{align*}

$\therefore$
\[f(\boldsymbol{e}_2,\boldsymbol{e}_1)=-f(\boldsymbol{e}_1,\boldsymbol{e}_2),\]

$\therefore F$ 在基 $(\boldsymbol{e}_1,\boldsymbol{e}_2)$ 下的矩阵为
\[\begin{pmatrix}
    0 & 1 \\
    -1 & 0 \\
\end{pmatrix}.\]

猜想一般的情况应该为:
\[\begin{pmatrix}
    0  & 1 & 0  & 0 &&& \cdots &&& 0 \\
    -1 & 0 & 0  & 0 &&& \cdots &&& 0 \\
    0  & 0 & 0  & 1 &&& \cdots &&& 0 \\
    0  & 0 & -1 & 0 &&& \cdots &&& 0 \\
    &&& \ddots & \ddots \\
    &&&& 0  & 1 & 0 & 0 \\
    &&&& -1 & 0 & 0 & 0 \\
    &&&& 0  & 0 & 0 & 0 \\
    &&&& 0  & 0 & 0 & 0 \\
    &&&&&&& \ddots & \ddots \\
    &&&&&&&& 0 & 0 \\
    &&&&&&&& 0 & 0 \\
\end{pmatrix}.\]

设 $\dim V=n,f\in\mathcal{L}_2^-(V,K),V_0=\ker f$, 则 $\forall\boldsymbol{v}\in V_0,\forall\boldsymbol{x}\in V,f(\boldsymbol{v},\boldsymbol{x})=0$.

$\because f$ 是斜对称的, $\therefore f(\boldsymbol{x},\boldsymbol{v})=-f(\boldsymbol{v},\boldsymbol{x})=0$.

设 $V=V_1\oplus V_0,V$ 的一个基 $\underbrace{\boldsymbol{e}_1,\boldsymbol{e}_2,\cdots,\boldsymbol{e}_k}_{\in V_1},\underbrace{\boldsymbol{e}_{k+1},\boldsymbol{e}_{k+2},\cdots,\boldsymbol{e}_n}_{\in V_0}$, 则 $f(\boldsymbol{e}_i,\boldsymbol{e}_j)=f(\boldsymbol{e}_j,\boldsymbol{e}_i)=0\ (1\leq i \leq k<j\leq n),F$ 在这个基下的矩阵为
\[F=\begin{pmatrix}
    f_{11} & \cdots & f_{1k} & 0 & \cdots & 0 \\
    \vdots & \ddots & \vdots & \vdots & \vdots & \vdots \\
    f_{k1} & \cdots & f_{kk} & 0 & \cdots & 0 \\
    0      & \cdots & 0      & 0 & \cdots & 0 \\
    \vdots & \ddots & \vdots & \vdots & \vdots & \vdots \\
    0      & \cdots & 0      & 0 & \cdots & 0 \\
\end{pmatrix}.\]

设 $\bar{f}$ 是 $f$ 在 $\left<\boldsymbol{e}_1,\boldsymbol{e}_2,\cdots,\boldsymbol{e}_k\right>$ 上的限制, 则 $\bar{f}$ 的矩阵
\[\overline{F}=\begin{pmatrix}
    f_{11} & f_{12} & \cdots & f_{1k} \\
    f_{21} & f_{22} & \cdots & f_{2k} \\
    \vdots & \vdots & \ddots & \vdots \\
    f_{k1} & f_{k2} & \cdots & f_{kk} \\
\end{pmatrix}.\]

对 $V$ 的子空间 $U$, 定义
\[f(\boldsymbol{v},U)=\{f(\boldsymbol{v},\boldsymbol{x})|\boldsymbol{x}\in U\}.\]

设 $\boldsymbol{v}\in V_1$. 如果 $\boldsymbol{v}\in\ker\bar{f}$, 则 $\bar{f}(\boldsymbol{v},V_1)=f(\boldsymbol{v},V_1)=\{0\}$.

$\because f(\boldsymbol{v},V_0)=\{0\}$, $\therefore f(\boldsymbol{v},V)=\{0\}$. $\therefore\boldsymbol{v}\in V_0$.

$\because V_0\oplus V_1=V$, $\therefore\boldsymbol{v}=\boldsymbol{0}$. $\therefore\ker\bar{f}=\{\boldsymbol{0}\}$, $\therefore\bar{f}$ 是非退化的.

由上面的讨论, 对一般的 $f\in\mathcal{L}_2^-(V,K)$ 的研究可以归结为研究非退化的 $f\in\mathcal{L}_2^-(V,K)$.

上述讨论也适用于 $\mathcal{L}_2^+(V,K)$. 设 $f$ 是对称的双线性型, $q_f(\boldsymbol{v})=f(\boldsymbol{v},\boldsymbol{v})$, $V_0=\ker f,V_0\oplus V_1=V$, 则 $\forall\boldsymbol{v}_0\in V_0,\boldsymbol{v}_1\in V_1$, 有
\begin{align*}
    q_f(\boldsymbol{v}_0+\boldsymbol{v}_1) & =f(\boldsymbol{v}_0+\boldsymbol{v}_1,\boldsymbol{v}_0+\boldsymbol{v}_1) \\
    & =f(\boldsymbol{v}_0,\boldsymbol{v}_0+\boldsymbol{v}_1)+f(\boldsymbol{v}_1,\boldsymbol{v}_0+\boldsymbol{v}_1) \\
    & =f(\boldsymbol{v}_1,\boldsymbol{v}_0+\boldsymbol{v}_1) \\
    & =f(\boldsymbol{v}_1,\boldsymbol{v}_0)+f(\boldsymbol{v}_1,\boldsymbol{v}_1) \\
    & =f(\boldsymbol{v}_1,\boldsymbol{v}_1)=q_f(\boldsymbol{v}_1).
\end{align*}

称 $V_0$ 为 $f$ 或 $q_f$ 的\textbf{迷向空间}.

$\mathcal{L}_2^+(V,K)$ 对应于 Riemann 几何, 而 $\mathcal{L}_2^-(V,K)$ 对应于辛几何.

书上定理 10 的证明中有
\[(\operatorname{Pf}({}^tUTU))^2=(\det U)^2(\operatorname{Pf}(T))^2\Rightarrow\operatorname{Pf}({}^tUTU)=\pm(\det U)\operatorname{Pf}(T),\]

这实际上用到了整环 $\mathbb{Q}(t)$ 中的因式分解 $a^2-b^2=(a+b)(a-b)$. 对一般的函数环, 上式不成立, 比如互不相同的函数
\[f_1(x)=|x|,\quad f_2(x)=x,\quad f_3(x)=-x\]
满足
\[f_1^2(x)=f_2^2(x)=f_3^2(x)=x^2.\]
\section{第1章习题}
在这章的习题中, 不加说明的话, 设 $E_{ij}$ 是矩阵单位.
\subsection{习题1.1}
\stepcounter{exsection}
\begin{exercise}% 1.1
    下列集合是否构成 $\mathbb{R}$ 上的向量空间?
    \begin{enumerate}
        \def\labelenumi{(\arabic{enumi})}
        \item $M_n(\mathbb{R})$ 中秩为 $r$ 的所有矩阵 $F$;\addtocounter{enumi}{2}
        \item $M_n(\mathbb{R})$ 所有行列式为 $0$ 的矩阵 $G$.
    \end{enumerate}
\end{exercise}
\begin{solution}
    (1) 当 $r=0$ 时 $F$ 是由一个元素构成的向量空间. 当 $r>0$ 时, $F$ 不包含零元, 不是向量空间.
    
    (4) 考虑两个矩阵
    \[A_1=E_{11}+E_{22}+E_{44},\quad A_2=E_{22}+E_{33}+E_{44}.\]

    有 $\det A_1=\det A_2=0,A_1+A_2=E+E_{22},\det(A_1+A_2)\neq0$, $\therefore G$ 对加法不封闭.
\end{solution}
\begin{exercise}[2]% 1.2
    $p$ 元域 $\mathbb{F}_p$ 上长度为 $n$ 的坐标空间 $\mathbb{F}_p^n$ 中, 方程 $\alpha_1x_1+\alpha_2x_2+\cdots+\alpha_nx_n=0\ (\alpha_i\in\mathbb{F}_p,\text{不全为}0)$ 有多少个解?
\end{exercise}
\begin{solution}
    设 $\alpha_s\neq0$, 则
    \[x_s=\alpha_s^{-1}\alpha_1x_1+\cdots+\widehat{\alpha_s^{-1}\alpha_sx_s}+\cdots+\alpha_s^{-1}\alpha_nx_n.\]

    $\therefore\forall x_1,\cdots,\hat{x}_s,\cdots,x_n$, 按上式定义 $x_s$, 则 $x_1,x_2,\cdots,x_n$ 构成方程 $\alpha_1x_1+\alpha_2x_2+\cdots+\alpha_nx_n=0$ 的解. $\therefore\alpha_1x_1+\alpha_2x_2+\cdots+\alpha_nx_n=0$ 的解空间同构于 $\mathbb{F}_p^{n-1}$, 有 $p^{n-1}$ 个元素.
\end{solution}
\begin{exercisec}[1.1.11]
    对 $\mathbb{C}^n$ 定义新的纯量乘法 $\circ$: $b\circ(a_1,a_2,\cdots,a_n)=(b\overline{a}_1,b\overline{a}_2,\cdots,b\overline{a}_n)$. 在运算 $+,\circ$ 下 $\mathbb{C}^n$ 是否是向量空间?
\end{exercisec}
\begin{solution}
    $\because 1\circ(a_1,a_2,\cdots,a_n)=(\overline{a}_1,\overline{a}_2,\cdots,\overline{a}_n)\not\equiv(a_1,a_2,\cdots,a_n)$, $\therefore$ 在运算 $+,\circ$ 下 $\mathbb{C}^n$ 不是向量空间.
\end{solution}
\begin{exercisec}[1.1.12]
    设 $M$ 是有限集, $M$ 的所有子集形成的集合记作 $2^M$. 定义 $2^M$ 上的加法与 $2^M$ 与 $\mathbb{Z}_2$ 的纯量乘法如下:
    \[A+B=(A\cup B)\backslash(A\cap B),\quad 1A=A,\quad0A=\varnothing,\]

    证明: 在这两个运算下, $2^M$ 成为 $\mathbb{Z}_2$ 上的向量空间.
\end{exercisec}
\begin{proof}
    在 [BAI] 第 4 章习题的第 3.1 题证明了 $2^M$ 是 Abel 群. $\forall A,B\in2^M$, 有
    \[1A+1B=A+B=1(A+B),\]
    \[0A+0B=\varnothing+\varnothing=\varnothing=0(A+B),\]
    \[(0+0)A=\varnothing=0A+0A,\quad(0+1)A=A=0A+1A.\]

    由 [BAI] 第 4 章习题的第 3.1 题得 $\forall A\in2^M,A+A=\varnothing$, $\therefore$
    \[(1+1)A=0A=\varnothing=A+A=1A+1A.\]

    $\therefore$ 纯量乘法与加法满足分配律.

    有
    \[1(1A)=1A=(1\cdot1)A,\quad1(0A)=1\varnothing=\varnothing=(1\cdot0)A\]
    (同理得 $(0\cdot1)A=0(1A),0(0A)=(0\cdot0)A$).
\end{proof}
\begin{exercisec}[1.1.13]
    设 $(A,+)$ 是 Abel 群, 证明: $A$ 能成为域 $\mathbb{Z}_p$ 上的向量空间当且仅当
    \[\underbrace{\boldsymbol{x}+\cdots+\boldsymbol{x}}_{p\text{个}\boldsymbol{x}}=\boldsymbol{0},\quad\forall\boldsymbol{x}\in A.\]
\end{exercisec}
\begin{solution}
    ($\Rightarrow$) $\forall\boldsymbol{x}\in A$, 有
    \[\underbrace{\boldsymbol{x}+\cdots+\boldsymbol{x}}_{p\text{个}\boldsymbol{x}}=(\underbrace{1+\cdots+1}_{p\text{个}1})\boldsymbol{x}=0\boldsymbol{x}=\boldsymbol{0}.\]

    ($\Leftarrow$) $\forall r\in\mathbb{Z}_p,\boldsymbol{x}\in A$, 定义纯量乘法
    \[r\boldsymbol{x}=\underbrace{\boldsymbol{x}+\cdots+\boldsymbol{x}}_{r\text{个}\boldsymbol{x}}.\]

    容易验证在加法和这样定义的纯量乘法下, $A$ 能成为域 $\mathbb{Z}_p$ 上的向量空间.
\end{solution}
\begin{exercisec}[1.1.14]
    设 $(A,+)$ 是 Abel 群, 证明: $A$ 能成为域 $\mathbb{Q}$ 上的向量空间当且仅当 $A$ 中的非零元都是无限阶的, 且对 $\forall n\in\mathbb{N},\boldsymbol{a}\in A$, 方程 $\underbrace{\boldsymbol{x}+\cdots+\boldsymbol{x}}_{n\text{个}\boldsymbol{x}}=\boldsymbol{a}$ 在 $A$ 中有解.
\end{exercisec}
\begin{solution}
    ($\Rightarrow$) 假设 $\exists p\in\mathbb{Q}\backslash\{0\},\boldsymbol{x}\in A\backslash\{\boldsymbol{0}\}$ 使得 $\underbrace{\boldsymbol{x}+\cdots+\boldsymbol{x}}_{p\text{个}\boldsymbol{x}}=\boldsymbol{0}$, 则 $\exists\boldsymbol{y}=p\boldsymbol{x}\in A\backslash\{\boldsymbol{0}\}$ 使得
    \[\boldsymbol{y}=1\boldsymbol{y}=1(p\boldsymbol{x})=(1\cdot p)\boldsymbol{x}=\underbrace{\boldsymbol{x}+\cdots+\boldsymbol{x}}_{p\text{个}\boldsymbol{x}}=\boldsymbol{0},\]
    与 $\boldsymbol{y}\neq\boldsymbol{0}$ 矛盾.

    $\forall n\in\mathbb{N},\boldsymbol{a}\in A$, 方程 $\underbrace{\boldsymbol{x}+\cdots+\boldsymbol{x}}_{n\text{个}\boldsymbol{x}}=\boldsymbol{a}$ 在 $A$ 中的解为 $\boldsymbol{x}=\dfrac{1}{n}\boldsymbol{a}$.

    ($\Leftarrow$) 先证明方程 $\underbrace{\boldsymbol{x}+\cdots+\boldsymbol{x}}_{n\text{个}\boldsymbol{x}}=\boldsymbol{a}$ 的解是唯一的. 设 $\boldsymbol{u},\boldsymbol{v}$ 都是方程 $\underbrace{\boldsymbol{x}+\cdots+\boldsymbol{x}}_{n\text{个}\boldsymbol{x}}=\boldsymbol{a}$ 的解, 则
    \[\underbrace{\boldsymbol{u}+\cdots+\boldsymbol{u}}_{n\text{个}\boldsymbol{u}}=\underbrace{\boldsymbol{v}+\cdots+\boldsymbol{v}}_{n\text{个}\boldsymbol{v}}\Rightarrow\underbrace{(\boldsymbol{u}-\boldsymbol{v})+\cdots+(\boldsymbol{u}-\boldsymbol{v})}_{n\text{个}(\boldsymbol{u}-\boldsymbol{v})}=\boldsymbol{0}.\]

    $\because A$ 中的非零元都是无限阶的, $\therefore\boldsymbol{u}-\boldsymbol{v}=\boldsymbol{0}\Rightarrow\boldsymbol{u}=\boldsymbol{v}$.

    下面证明: $A$ 成为 $\mathbb{Q}$ 上的线性空间. $\forall q=\dfrac{r}{s}\in\mathbb{Q},\boldsymbol{a}\in A$, 定义 $q\boldsymbol{a}$ 为方程
    \[\underbrace{\boldsymbol{x}+\cdots+\boldsymbol{x}}_{s\text{个}\boldsymbol{x}}=\underbrace{\boldsymbol{a}+\cdots+\boldsymbol{a}}_{r\text{个}\boldsymbol{a}}\]
    的解. 由这个方程的解的唯一性得 $q\boldsymbol{a}$ 是确切定义的.

    对 $q'=\dfrac{r'}{s'}\in\mathbb{Q}$, 设 $\boldsymbol{u}_1=q\boldsymbol{a},\boldsymbol{u}_2=q'\boldsymbol{a}$, 则
    \[\underbrace{\boldsymbol{u}_1+\cdots+\boldsymbol{u}_1}_{s\text{个}\boldsymbol{u}_1}=\underbrace{\boldsymbol{a}+\cdots+\boldsymbol{a}}_{r\text{个}\boldsymbol{a}},\quad\underbrace{\boldsymbol{u}_2+\cdots+\boldsymbol{u}_2}_{s'\text{个}\boldsymbol{u}_2}=\underbrace{\boldsymbol{a}+\cdots+\boldsymbol{a}}_{r'\text{个}\boldsymbol{a}}.\]

    $\therefore$
    \[\underbrace{\boldsymbol{u}_1+\cdots+\boldsymbol{u}_1}_{ss'\text{个}\boldsymbol{u}_1}=\underbrace{\boldsymbol{a}+\cdots+\boldsymbol{a}}_{rs'\text{个}\boldsymbol{a}},\quad \underbrace{\boldsymbol{u}_2+\cdots+\boldsymbol{u}_2}_{ss'\text{个}\boldsymbol{u}_2}=\underbrace{\boldsymbol{a}+\cdots+\boldsymbol{a}}_{r's\text{个}\boldsymbol{a}}.\]

    两式两边相加得
    \[\underbrace{(\boldsymbol{u}_1+\boldsymbol{u}_2)+\cdots+(\boldsymbol{u}_1+\boldsymbol{u}_2)}_{ss'\text{个}(\boldsymbol{u}_1+\boldsymbol{u}_2)}=\underbrace{\boldsymbol{a}+\cdots+\boldsymbol{a}}_{rs'+r's\text{个}\boldsymbol{a}},\]

    即 $\boldsymbol{u}_1+\boldsymbol{u}_2=\dfrac{rs'+r's}{ss'}\boldsymbol{a}\Rightarrow q\boldsymbol{a}+q'\boldsymbol{a}=(q+q')\boldsymbol{a}$. 类似地, 可以验证 $\forall\boldsymbol{a},\boldsymbol{b}\in A,q(\boldsymbol{a}+\boldsymbol{b})=q\boldsymbol{a}+q\boldsymbol{b}$.

    设 $\boldsymbol{u}_1=q\boldsymbol{a},\boldsymbol{u}_2=q'\boldsymbol{u}_1=q'(q\boldsymbol{a})$, 则
    \[\underbrace{\boldsymbol{u}_1+\cdots+\boldsymbol{u}_1}_{s\text{个}\boldsymbol{u}_1}=\underbrace{\boldsymbol{a}+\cdots+\boldsymbol{a}}_{r\text{个}\boldsymbol{a}},\quad\underbrace{\boldsymbol{u}_2+\cdots+\boldsymbol{u}_2}_{s'\text{个}\boldsymbol{u}_2}=\underbrace{\boldsymbol{u}_1+\cdots+\boldsymbol{u}_1}_{r'\text{个}\boldsymbol{u}_1}.\]

    $\therefore$
    \[\underbrace{\boldsymbol{u}_2+\cdots+\boldsymbol{u}_2}_{ss'\text{个}\boldsymbol{u}_2}=\underbrace{\boldsymbol{u}_1+\cdots+\boldsymbol{u}_1}_{r's\text{个}\boldsymbol{u}_1}=\underbrace{\boldsymbol{a}+\cdots+\boldsymbol{a}}_{rr'\text{个}\boldsymbol{a}},\]

    $\therefore$
    \[\boldsymbol{u}_2=\dfrac{rr'}{ss'}\boldsymbol{a}=(qq')\boldsymbol{a}\Rightarrow q'(q)\boldsymbol{a}=(qq')\boldsymbol{a}.\qedhere\]
\end{solution}
\subsection{习题1.2}
\stepcounter{exsection}
\begin{exercise}%2.1
    在 $q$ 元域 $\mathbb{F}_q$ 上的 $n$ 维向量空间 $V$ 中, 对于 $1\leq k\leq n$ 有多少个 $k$ 维子空间?
\end{exercise}
\begin{solution}
\end{solution}
\begin{exercise}\label{ex2.2}
    (1) 求 $n$ 阶实对称矩阵构成的空间 $V$ 的维数.
    
    (3) 求迹为 $0$ 的 $n$ 阶实矩阵构成的空间 $V$ 的维数.
\end{exercise}
\begin{solution}
    (1) 设 $F_{ij}=E_{ij}+E_{ji}\ (i\leq j\leq n)$. 容易验证: (a) $F_{ij}\ (i\leq j\leq n)$ 线性无关. (b) 任一实对称矩阵都可以由 $F_{ij}\ (i\leq j\leq n)$ 线性表示.
    
    $\therefore E_{ij}\ (i\leq j\leq n)$ 是 $V$ 的一个基. $\therefore\dim V=\dfrac{n(n+1)}{2}$.

    (3) 设
    \[V_d=\left<E_{11},E_{22},\cdots,E_{nn}\right>,\quad V_o=\left<E_{ij}|i\neq j\right>,\]

    则 $M_n(\mathbb{R})=V_d\oplus V_o$.

    设 $V_d'$ 是迹为 $0$ 的 $n$ 阶实矩阵的对角元构成的空间, 则 $V_d'$ 同构于方程 $a_{11}+a_{22}+\cdots+a_{nn}=0$ 的解空间, $V=V_d'\oplus V_o$.
    
    $\therefore\dim V_d'=n-1=\dim V_d-1$, $\therefore\dim V=\dim M_n(\mathbb{R})-1=n^2-1$.
\end{solution}
\begin{exercise}% 2.3
    求出全体域 $P$ 上次数 $\leq n$ 的满足 $f(1)=0$ 的多项式组成的空间 $V$ 的一个基.
\end{exercise}
\begin{solution}
    与 [BAI] 第 6 章习题 4.3 类似, $\forall f\in V,f$ 可以表示为
    \[f(X)=b_1(X-1)+b_2(X-1)^2+\cdots+b_n(X-1)^n\]
    的形式. 特别地, $f=0$ 当且仅当 $b_i=0.\therefore X-1,(X-1)^2,\cdots,(X-1)^n$ 是 $V$ 的一个基.
\end{solution}
\begin{exercise}\label{ex2.4}
    证明: $V=U_1+U_2+\cdots+U_m$ 是直和的充要条件是
    \[(U_1+U_2+\cdots+U_{i-1})\cap U_i=\{\boldsymbol{0}\},\quad 1<i\leq m.\]
\end{exercise}
\begin{proof}
    ($\Rightarrow$) 只需证明 $U_1+U_2+\cdots+U_i$ 是直和, 再由书上的定理 7 得.

    假设 $U_1+U_2+\cdots+U_{i-1}$ 不是直和, 则在 $U_1+U_2+\cdots+U_{i-1}$ 中有
    \[\boldsymbol{0}=\alpha_1\boldsymbol{u}_1+\alpha_2\boldsymbol{u}_2+\cdots+\alpha_{i-1}\boldsymbol{u}_{i-1},\]

    其中 $\alpha_k$ 不全为 $0,\boldsymbol{u}_k\in U_k$.

    $\therefore$ 在 $U_1+U_2+\cdots+U_m$ 中有
    \[\boldsymbol{0}=\alpha_1\boldsymbol{u}_1+\alpha_2\boldsymbol{u}_2+\cdots+\alpha_m\boldsymbol{u}_m,\]

    其中 $\boldsymbol{u}_k\in U_k$, 对 $k\leq i-1,\alpha_k$ 不全为 $0$, 对 $k>i-1,\alpha_k=0$. $\therefore U_1+U_2+\cdots+U_m$ 不是直和, 与 $U_1+U_2+\cdots+U_m$ 是直和矛盾.

    ($\Leftarrow$) 用数学归纳法. 当 $m=2$ 时有
    \[U_1\cap U_2=\{0\}\Rightarrow\dim(U_1+U_2)=\dim U_1+\dim U_2,\]

    $\therefore U_1+U_2$ 是直和.

    假设当 $m=k$ 时成立, 则由
    \[(U_1+U_2+\cdots+U_{i-1})\cap U_i=\{\boldsymbol{0}\},\quad 1<i\leq k\]

    得
    \[\dim(U_1+U_2+\cdots+U_k)=\dim U_1+\dim U_2+\cdots+\dim U_k.\]

    $\therefore$ 由
    \[(U_1+U_2+\cdots+U_k)\cap U_{k+1}=\{\boldsymbol{0}\}\]

    得
    \begin{align*}
        \dim(U_1+U_2+\cdots+U_{k+1}) & =\dim(U_1+U_2+\cdots+U_k)+\dim U_{k+1} \\
        & =\dim U_1+\dim U_2+\cdots+\dim U_k+\dim U_{k+1}.
    \end{align*}

    $\therefore U_1+U_2+\cdots+U_{k+1}$ 是直和.
\end{proof}
\begin{exercise}% 2.5
    找出域 $P$ 上次数 $\leq n$ 的多项式全体组成的空间 $V$ 的基 $(1,t,t^2,\cdots,t^n)$ 向 $V$ 的基 $(1,t-\alpha,(t-\alpha)^2,\cdots,(t-\alpha)^n)$ 的转换矩阵.
\end{exercise}
\begin{solution}
    有
    \begin{align*}
          & (1,t-\alpha,(t-\alpha)^2,\cdots,(t-\alpha)^n) \\
        = & \ (1,t,t^2,\cdots,t^n)\begin{pmatrix}
        1 & -\alpha & (-\alpha)^2 & (-\alpha)^3  & \cdots & (-\alpha)^n \\
          & 1       & 2(-\alpha)  & 3(-\alpha)^2 & \cdots & n(-\alpha)^{n-1} \\
          &         & 1           & 3(-\alpha)   & \cdots & \vdots \\
          &         &             & 1            & \cdots & \binom{n}{k}(-\alpha)^{n-k} \\
          &         &             &              & \ddots & \vdots \\
          &  &  &  &  & 1 \\
    \end{pmatrix}.
    \end{align*}
\end{solution}
\begin{exercise}% 2.6
    设 $\theta$ 是不可约多项式 $f\in\mathbb{Q}[X]$ 的一个复根. 求域 $\mathbb{Q}$ 上的空间
    \[\mathbb{Q}[\theta]=\left<1,\theta,\cdots,\theta^k,\cdots\right>\]
    的维数.
\end{exercise}
\begin{solution}
    设 $f(X)=a_0X^n+a_1X^{n-1}+\cdots+a_{n-1}X+a_n$, 则
    \[a_0\theta^n+a_1\theta^{n-1}+\cdots+a_{n-1}\theta+a_n=0.\]
    
    $\therefore$
    \[\theta^n=-\dfrac{a_1}{a_0}\theta^{n-1}-\cdots-\dfrac{a_{n-1}}{a_0}\theta-\dfrac{a_n}{a_0}.\]
    \begin{align*}
        \theta^{n+1} & =-\dfrac{a_1}{a_0}\theta^n-\cdots-\dfrac{a_{n-1}}{a_0}\theta^2-\dfrac{a_n}{a_0}\theta \\
        & =-\dfrac{a_1}{a_0}\left(-\dfrac{a_1}{a_0}\theta^{n-1}-\cdots-\dfrac{a_{n-1}}{a_0}\theta-\dfrac{a_n}{a_0}\right)-\cdots-\dfrac{a_{n-1}}{a_0}\theta^2-\dfrac{a_n}{a_0}\theta,
    \end{align*}
    \[\cdots,\]

    $\therefore$
    \[\left<1,\theta,\cdots,\theta^k,\cdots\right>=\left<1,\theta,\cdots,\theta^{n-1}\right>.\]

    假设 $1,\theta,\cdots,\theta^{n-1}$ 线性相关, 则 $\exists$ 不全为 $0$ 的 $\alpha_0,\alpha_1,\cdots,\alpha_{n-1}$ 使得
    \[\alpha_0\theta^{n-1}+\cdots+\alpha_{n-2}\theta+\alpha_{n-1}=0.\]

    设 $g(X)=\alpha_0X^{n-1}+\cdots+\alpha_{n-2}X+\alpha_{n-1}$, 则 $g(\theta)=0.\because f$ 既约, $\therefore f,g$ 互素, $\therefore\exists q,r\in\mathbb{Q}[X]$ 使得 $fq+gr=1$.

    $\because f(\theta)=g(\theta)=0,\therefore f(\theta)q(\theta)+g(\theta)r(\theta)=0$, 与 $fq+gr=1$ 矛盾.

    $\therefore1,\theta,\cdots,\theta^{n-1}$ 是 $\mathbb{Q}[\theta]$ 的一个基.
\end{solution}
\begin{exercise}% 2.7
    验证: 直和不满足消去律, 即若 $W_1\oplus U=W_2\oplus U$, 则 $W_1=W_2$ 不一定成立.
\end{exercise}
\begin{proof}
    设 $V=K^2,U=\{(a,0)|a\in K\}$ 是 $V$ 的子空间, $W_1=\{(0,a)|a\in K\},W_1=\{(ab,a)|a,b\in K\}$ 满足 $V_1\oplus U=V_2\oplus U=K^2$, 但 $W_1\neq W_2$. 事实上, $W_1\subset W_2$.
\end{proof}
\begin{exercise}% 2.8
    对于下列 $L_i$, 商空间 $K[X]/L_i$ 是否是有限维的?

    (1) $L_1$ 是所有次数 $\leq n-1$ 的多项式 $P_n\in K[X]$ 构成的子空间;

    (2) $L_2$ 是所有可以被 $X^n$ 整除的多项式构成的子空间;

    (3) $L_3$ 是所有的关于 $X^2$ 的多项式构成的子空间.
\end{exercise}
\begin{solution}
    $\because K$ 是域, $\therefore\forall f\in K[X]$, 有分解式
    \[f(X)=X^ng(X)+r(X),\quad\deg r\leq n-1.\]

    $\because X^ng(X)\in L_2,r(X)\in L_1,L_1\cap L_2=\{0\},\therefore K[X]=L_1\oplus L_2$.

    $\because L_1$ 是有限维的, $\therefore K[X]/L_1=L_2$ 是无限维的, $K[X]/L_2=L_1$ 是有限维的.

    容易验证
    \[\left<X,X^3,X^5,\cdots\right>\oplus L_3=K[X].\]

    $\therefore K[X]/L_3$ 是无限维的.
\end{solution}

证明第 \ref{ex2.9} 题需要下面的引理. 这些引理本身也是很好的习题. 在第 \ref{ex2.9} 题和下面的引理中, 不加说明的话, 线性空间可以是无限维的.
\begin{lemma}\label{l4.1}
    设 $U,W$ 是线性空间 $V$ 的子空间, 则 $(U+W)/W\simeq U/(U\cap W)$.
\end{lemma}
\begin{proof}
    设
    \[\varphi:\begin{array}{rcll}
        (U+W)/W & \to & U/(U\cap W) \\
        \boldsymbol{u}+\boldsymbol{w}+W & \mapsto & \boldsymbol{u}+U\cap W & (\boldsymbol{u}\in U,\boldsymbol{w}\in W) \\
    \end{array}.\]

    容易验证 $\varphi$ 是线性映射, 且是满射.

    对 $\boldsymbol{u}_1,\boldsymbol{u}_2\in U,\boldsymbol{w}_1,\boldsymbol{w}_2\in W$, 有
    \[\boldsymbol{u}_1+\boldsymbol{w}_1+W=\boldsymbol{u}_2+\boldsymbol{w}_2+W\Rightarrow(\boldsymbol{u}_1+\boldsymbol{w}_1)-(\boldsymbol{u}_2+\boldsymbol{w}_2)\in W\Rightarrow\boldsymbol{u}_1-\boldsymbol{u}_2\in W.\]

    $\because\boldsymbol{u}_1,\boldsymbol{u}_2\in U$, $\therefore\boldsymbol{u}_1-\boldsymbol{u}_2\in U$, $\therefore\boldsymbol{u}_1-\boldsymbol{u}_2\in U\cap W$. $\therefore$
    \[\varphi(\boldsymbol{u}_1+\boldsymbol{w}_1+W)-\varphi(\boldsymbol{u}_1+\boldsymbol{w}_1+W)=\boldsymbol{u}_1-\boldsymbol{u}_2+U\cap W=\boldsymbol{0}+U\cap W.\]

    $\therefore\varphi$ 是单射. $\therefore\varphi$ 是同构, $(U+W)/W\simeq U/(U\cap W)$.
\end{proof}
\begin{lemma}\label{l4.2}
    设 $W\subset U\subset V$ 是线性空间, $U$ 有补空间 $U'$, 则 $V/W\simeq U/W\oplus U'$ (其中的直和是外直和).
\end{lemma}
\begin{proof}
    考虑映射
    \[\varphi:\begin{array}{rcll}
        V/W & \to & U/W\oplus U' \\
        \boldsymbol{u}+\boldsymbol{u}'+W & \mapsto & (\boldsymbol{u}+W,\boldsymbol{u}') & (\boldsymbol{u}\in U,\boldsymbol{u}'\in U') \\
    \end{array}.\]

    $\because U\oplus U'=V$, $\therefore\forall\boldsymbol{v}\in V,\exists!\boldsymbol{u}\in U,\boldsymbol{u}'\in U'$ 使得 $\boldsymbol{v}=\boldsymbol{u}+\boldsymbol{u}'$. $\therefore\psi$ 是确切定义的.

    容易验证 $\varphi$ 是满射.

    设 $\boldsymbol{u}_1+\boldsymbol{u}_1'+W,\boldsymbol{u}_2+\boldsymbol{u}'_2+W\in V/W$, 则
    \begin{equation}\label{eq4.1}
        \begin{aligned}
            \varphi(\alpha(\boldsymbol{u}_1+\boldsymbol{u}_1'+W)+\beta(\boldsymbol{u}_2+\boldsymbol{u}'_2+W)) & =(\alpha\boldsymbol{u}_1+W,\alpha\boldsymbol{u}_1')+(\beta\boldsymbol{u}_2+W,\beta\boldsymbol{u}_2') \\
            & =(\alpha(\boldsymbol{u}_1+W),\alpha\boldsymbol{u}_1')+(\beta(\boldsymbol{u}_2+W),\beta\boldsymbol{u}_2') \\
            & =\alpha(\boldsymbol{u}_1+W,\boldsymbol{u}_1')+\beta(\boldsymbol{u}_2+W,\boldsymbol{u}_2') \\
            & =\alpha\varphi(\boldsymbol{u}_1+\boldsymbol{u}_1'+W)+\beta\varphi(\boldsymbol{u}_2+\boldsymbol{u}_2'+W),
        \end{aligned}
    \end{equation}
    
    $\therefore\varphi$ 是线性映射.

    设 $\varphi(\boldsymbol{u}_1+\boldsymbol{u}_1'+W)=\varphi(\boldsymbol{u}_2+\boldsymbol{u}_2'+W)$, 由式 (\ref{eq4.1}) 得
    \begin{align*}
        \varphi((\boldsymbol{u}_1+\boldsymbol{u}_1'+W)-(\boldsymbol{u}_2+\boldsymbol{u}'_2+W)) & =\varphi(\boldsymbol{u}_1+\boldsymbol{u}_1'+W)-\varphi(\boldsymbol{u}_2+\boldsymbol{u}_2'+W) \\
        & =(\boldsymbol{0}+W,\boldsymbol{0}).
    \end{align*}

    $\because$
    \[(\boldsymbol{u}_1+\boldsymbol{u}_1'+W)-(\boldsymbol{u}_2+\boldsymbol{u}'_2+W)=(\boldsymbol{u}_1-\boldsymbol{u}_2)+(\boldsymbol{u}_1'-\boldsymbol{u}_2')+W,\]

    $\therefore$
    \[\boldsymbol{u}_1-\boldsymbol{u}_2=\boldsymbol{0}=\boldsymbol{u}_1'-\boldsymbol{u}_2'=\boldsymbol{0}.\Rightarrow\boldsymbol{u}_1+\boldsymbol{u}_1'+W=\boldsymbol{u}_2+\boldsymbol{u}'_2+W.\]

    $\therefore\varphi$ 是单射.
\end{proof}
\begin{lemma}\label{l4.3}
    设 $U,W$ 是 $V$ 的子空间, $B\subset U,C\subset W$, $U+W=W\oplus B=U\oplus C$, 则
    \[U+W=B\oplus C\oplus(U\cap W).\]
\end{lemma}
\begin{proof}
    $\because U+W=W\oplus B$, $\therefore\forall\boldsymbol{x}\in U+W,\exists\boldsymbol{w}\in W,\boldsymbol{b}\in B$ 使得 $\boldsymbol{x}=\boldsymbol{w}+\boldsymbol{b}$. $\because U+W=U\oplus C$, $\therefore$ 对 $\boldsymbol{w}\in W\subset U+W,\exists\boldsymbol{c}\in C,\boldsymbol{u}\in U$ 使得 $\boldsymbol{w}=\boldsymbol{c}+\boldsymbol{u}$.

    $\because\boldsymbol{w}\in W,\boldsymbol{c}\in C\subset W$, $\therefore\boldsymbol{u}=\boldsymbol{w}-\boldsymbol{c}\subset W$.
    
    $\therefore\forall\boldsymbol{x}\in U+W,\boldsymbol{x}=\boldsymbol{b}+\boldsymbol{c}+\boldsymbol{u}$, 其中 $\boldsymbol{b}\in B,\boldsymbol{c}\in C,\boldsymbol{u}\in U\cap W$.

    $\because W+B$ 是直和, $\therefore W\cap B=\{\boldsymbol{0}\}$. $\because C\in W$, $\therefore C\cap B=\{\boldsymbol{0}\}$.

    设 $\boldsymbol{x}\in(U\cap W)\cap(B\oplus C)$. $\because\boldsymbol{x}\in B\oplus C$, $\therefore\exists\boldsymbol{b}\in B,\boldsymbol{c}\in C$ 使得 $\boldsymbol{x}=\boldsymbol{b}+\boldsymbol{c}$.

    $\because\boldsymbol{x}\in U\cap W\subset U,\boldsymbol{b}\in B\subset U$, $\therefore\boldsymbol{c}=\boldsymbol{x}-\boldsymbol{b}\in U$.
    
    $\because U+C$ 是直和, $\therefore U\cap C=\{\boldsymbol{0}\}$, $\therefore\boldsymbol{c}=\boldsymbol{0}$. 对称地, $\boldsymbol{b}=\boldsymbol{0}$. $\therefore\boldsymbol{x}=\boldsymbol{b}+\boldsymbol{c}=\boldsymbol{0}$.

    $\therefore(U\cap W)\cap(B\oplus C)=\{\boldsymbol{0}\}$, 由第 \ref{ex2.4} 题得 $(U+W)=B+C+(U\cap W)$ 是直和.
\end{proof}
\begin{exercise}\label{ex2.9}
    设 $U,W$ 是 $V$ 的余维数有限的子空间. 证明: (1) $U+W,V\cap W$ 的余维数有限;

    (2) 下列等式成立:
    \begin{equation}\label{eq4.2}
        \codim(U+W)+\codim(U\cap W)=\codim U+\codim W.
    \end{equation}
\end{exercise}
\begin{proof}
    (1) 由定理 \ref{t1.7} 得 $U,W$ 的补空间存在. 设 $U',W'$ 分别是 $U,W$ 的一个补空间, 则 $\dim U'=\codim U,\dim W'=\codim W$.

    考虑映射
    \[\varphi:\begin{array}{rcl}
        U' & \to & V/(U+W) \\
        \boldsymbol{u}' & \mapsto & \boldsymbol{u}'+(U+W) \\
    \end{array}.\]
    
    容易验证 $\varphi$ 是线性的.

    $\because\forall\boldsymbol{v}\in V,\exists\boldsymbol{u}\in U\subset U+W,\boldsymbol{u}'\in U'$ 使得
    \[\boldsymbol{v}=\boldsymbol{u}+\boldsymbol{u}'\Rightarrow\boldsymbol{v}+(U+W)=\boldsymbol{u}+(U+W)=\varphi(\boldsymbol{u}),\]

    $\therefore\varphi$ 是满射. 由引理 \ref{l1.1} 得 $\codim(U+W)=\dim V/(U+W)\leq\dim U'$ 为有限数.

    考虑映射
    \[\psi:\begin{array}{rcll}
        V/W & \to & (U+W)/W \\
        \boldsymbol{u}+\boldsymbol{u}'+W & \mapsto & \boldsymbol{u}+W & (\boldsymbol{u}\in U,\boldsymbol{u}'\in U') \\
    \end{array}\]

    与引理 \ref{l4.2} 一样, 得 $\psi$ 是确切定义的. 容易验证 $\psi$ 是线性的.

    $\because\forall\boldsymbol{u}+\boldsymbol{w}\in U+W,\exists\boldsymbol{u}\in U\subset V$ 使得
    \[\boldsymbol{u}+\boldsymbol{w}+W=\boldsymbol{u}+W=\psi(\boldsymbol{u}),\]

    $\therefore\psi$ 是满射. 由引理 \ref{l1.1} 得 $\dim(U+W)/W\leq\dim  V/W$ 为有限数. 由引理 \ref{l4.1} 得 $\dim U/(U\cap W)$ 为有限数.

    由引理 \ref{l4.2} 得 $V/(U\cap W)=U/(U\cap W)\oplus U'$, $\therefore$
    \[\dim V/(U\cap W)=\dim U/(U\cap W)+\dim U'.\]

    $\because$ 上式右边是有限数, $\therefore\codim(U\cap W)=\dim V/(U\cap W)$ 是有限数.

    (2) 如果 $U\subset W\vee U\supset W$, 式 (\ref{eq4.1}) 退化为 $\codim U+\codim W=\codim U+\codim W$. 下面设 $U\not\subset W\wedge U\not\supset W$.

    $\because U\not\subset W$, $\therefore\exists\boldsymbol{b}_1\in U\backslash W$. 如果 $U\not\subset(W+\left<\boldsymbol{b}_1\right>)$, 那么 $\exists\boldsymbol{b}_2\in U\backslash(W+\left<\boldsymbol{b}_1\right>)$. 如果 $U\not\subset(W+\left<\boldsymbol{b}_1,\boldsymbol{b}_2\right>)$, 那么 $\exists\boldsymbol{b}_3\in U\backslash(W+\left<\boldsymbol{b}_1,\boldsymbol{b}_2\right>)$. 一直做下去, 直到 $\exists t$ 使得 $U\subset(W+\left<\boldsymbol{b}_1,\boldsymbol{b}_2,\cdots,\boldsymbol{b}_t\right>)$ (由 $U\subset W+W'$ 且 $\dim W'$ 有限得 $t$ 存在). $\because$
    \[\boldsymbol{b}_k\in U\backslash(W+\left<\boldsymbol{b}_1,\boldsymbol{b}_2,\cdots,\boldsymbol{b}_{k-1}\right>),\]

    $\therefore\boldsymbol{b}_k\notin\left<\boldsymbol{b}_1,\boldsymbol{b}_2,\cdots,\boldsymbol{b}_{k-1}\right>$, $\therefore$
    \[\left<\boldsymbol{b}_k\right>\cap\left<\boldsymbol{b}_1,\boldsymbol{b}_2,\cdots,\boldsymbol{b}_{k-1}\right>=\{\boldsymbol{0}\}.\]

    由第 \ref{ex2.4} 题得 $\left<\boldsymbol{b}_1\right>+\left<\boldsymbol{b}_2\right>+\cdots+\left<\boldsymbol{b}_t\right>=\left<\boldsymbol{b}_1,\boldsymbol{b}_2,\cdots,\boldsymbol{b}_t\right>$ 是直和. $\therefore\boldsymbol{b}_1,\boldsymbol{b}_2,\cdots,\boldsymbol{b}_t$ 线性无关.

    $\because U\subset W+\left<\boldsymbol{b}_1,\boldsymbol{b}_2,\cdots,\boldsymbol{b}_t\right>$, $\therefore U+W\subset W+\left<\boldsymbol{b}_1,\boldsymbol{b}_2,\cdots,\boldsymbol{b}_t\right>$.
    
    $\because\boldsymbol{b}_i\in U$, $\therefore\left<\boldsymbol{b}_1,\boldsymbol{b}_2,\cdots,\boldsymbol{b}_t\right>\subset U$, $\therefore\left<\boldsymbol{b}_1,\boldsymbol{b}_2,\cdots,\boldsymbol{b}_t\right>+W\subset U+W$, $\therefore\left<\boldsymbol{b}_1,\boldsymbol{b}_2,\cdots,\boldsymbol{b}_t\right>+W=U+W$.

    $\because\boldsymbol{b}_i\notin W$, $\therefore\left<\boldsymbol{b}_1,\boldsymbol{b}_2,\cdots,\boldsymbol{b}_t\right>\cap W=\{\boldsymbol{0}\}$, $\left<\boldsymbol{b}_1,\boldsymbol{b}_2,\cdots,\boldsymbol{b}_t\right>+W=(U+W)$ 是直和.

    对称地, $\exists$ 线性无关的 $\boldsymbol{c}_1,\boldsymbol{c}_2,\cdots,\boldsymbol{c}_q$ 满足
    \[\boldsymbol{c}_i\in W\backslash(U+\left<\boldsymbol{c}_1,\boldsymbol{c}_2,\cdots,\boldsymbol{c}_{i-1}\right>),\]
    
    且 $\left<\boldsymbol{c}_1,\boldsymbol{c}_2,\cdots,\boldsymbol{c}_t\right>+W=(U+W)$ 是直和.

    设 $B=\left<\boldsymbol{b}_1,\boldsymbol{b}_2,\cdots,\boldsymbol{b}_t\right>,C=\left<\boldsymbol{c}_1,\boldsymbol{c}_2,\cdots,\boldsymbol{c}_q\right>$. 由引理 \ref{l4.3} 得
    \[U+W=B\oplus C\oplus(U\cap W).\]
        
    由定理 \ref{t1.7} 得 $U+W$ 的补空间存在. 设 $A$ 是 $U+W$ 的一个补空间, $\boldsymbol{a}_1,\boldsymbol{a}_2,\cdots,\boldsymbol{a}_s$ 是 $A$ 的一个基, 则
    \[V=A\oplus(U+W)=A\oplus B\oplus W=A\oplus C\oplus U=A\oplus B\oplus C\oplus(U\cap W).\]

    通过构造典范映射可以验证
    \[A\oplus B\simeq W',\quad A\oplus C\simeq U',\quad A\oplus B\oplus C\simeq V/(U\cap W).\]

    $\therefore$
    \begin{align*}
        \codim W+\codim U & =(\dim A+\dim B)+(\dim A+\dim C) \\
        & =\dim A+(\dim A+\dim B+\dim C) \\
        & =\codim(U+W)+\codim(U\cap W).\qedhere
    \end{align*}
\end{proof}
\addtocounter{exercise}{2}
\begin{exercise}% 2.12
    设 $V_1,V_2,\cdots,V_k$ 是 $n$ 维向量空间 $V$ 的子空间. 证明: 如果 $\dim V_1+\dim V_2+\cdots+\dim V_k>n(k-1)$, 那么 $\bigcap\limits_{i=1}^kV_i\neq\{\boldsymbol{0}\}$.
\end{exercise}
\begin{proof}
    下面的直和一律指外直和.

    考虑映射
    \[\varphi:\begin{array}{rcl}
        V_1\oplus V_2\oplus\cdots\oplus V_k & \to & (V_1+V_2)\oplus(V_2+V_3)\oplus\cdots\oplus(V_{k-1}+V_k) \\
        (\boldsymbol{v}_1,\boldsymbol{v}_2,\cdots,\boldsymbol{v}_k) & \to & (\boldsymbol{v}_1-\boldsymbol{v}_2,\boldsymbol{v}_2-\boldsymbol{v}_3,\cdots,\boldsymbol{v}_{k-1}-\boldsymbol{v}_k) \\
    \end{array},\]

    则 $\dim(V_1\oplus V_2\oplus\cdots\oplus V_k)=\dim V_1+\dim V_2+\cdots+\dim V_k>n(k-1)$.

    $\because\varphi(\boldsymbol{v}_1,\boldsymbol{v}_2,\cdots,\boldsymbol{v}_k)=(\underbrace{\boldsymbol{0},\boldsymbol{0},\cdots,\boldsymbol{0}}_{k\text{个}\boldsymbol{0}})$ 当且仅当 $\boldsymbol{v}_1=\boldsymbol{v}_2=\cdots=\boldsymbol{v}_k$, $\therefore$
    \[\ker\varphi=\bigg\{(\underbrace{\boldsymbol{v},\boldsymbol{v},\cdots,\boldsymbol{v}}_{k-1\text{个}\boldsymbol{v}})\bigg|\boldsymbol{v}\in\bigcap\limits_{i=1}^kV_i\bigg\}.\]

    容易验证 $\ker\varphi$ 与 $\bigcap\limits_{i=1}^kV_i$ 同构. $\therefore\dim\ker\varphi=\dim\bigcap\limits_{i=1}^kV_i$.

    由书上第 2 章第 1 节的定理 4 得
    \[\dim\ker\varphi+\dim\im \varphi=\dim(V_1\oplus V_2\oplus\cdots\oplus V_k)>n(k-1).\]

    $\because$
    \[\dim\im \varphi\leq\dim\bigoplus\limits_{i=1}^{k-1}(V_i+V_{i+1})=\sum\limits_{i=1}^{k-1}\dim(V_i+V_{i+1})\leq\sum\limits_{i=1}^{k-1}\dim V=n(k-1),\]

    $\therefore\dim\bigcap\limits_{i=1}^kV_i=\dim\ker\varphi>0$.
\end{proof}
\begin{exercisec}[1.2.3(4)]
    证明 $\sin x,\sin^2x,\cdots,\sin^nx$ 线性无关.
\end{exercisec}
\begin{proof}
    只需证明 $1,\sin x,\sin^2x,\cdots,\sin^nx$ 线性无关.
    
    用数学归纳法. 当 $n=0$ 时显然成立. 设 $1,\sin x,\sin^2x,\cdots,\sin^{n-1}x$ 线性无关. 设
    \begin{equation}\label{eq4.3}
        a_0+a_1\sin x+a_2\sin^2x+\cdots+a_n\sin^nx=0.
    \end{equation}

    在式 (\ref{eq4.3}) 中令 $x=\dfrac{\pi}{2}$ 得
    \[a_0+a_1+\cdots+a_n=0.\]

    式 (\ref{eq4.3}) 减去上式得
    \[a_1(\sin x-1)+a_2(\sin^2x-1)+\cdots+a_n(\sin^nx-1)=0.\]

    上式两边除 $\sin x-1$ 得
    \begin{align*}
        & a_1+a_2(1+\sin x)+a_3(1+\sin x+\sin^2x)+\cdots+a_n(1+\sin x+\cdots+\sin^{n-1}x)=0 \\
        & \Rightarrow(a_1+a_2+\cdots+a_n)+(a_2+\cdots+a_n)\sin x+(a_3+\cdots+a_n)\sin^2x \\
        & \quad+\cdots+(a_{n-1}+a_n)\sin^{n-2}x+a_n\sin^{n-1}x=0. \\
    \end{align*}

    由归纳假定,
    \[\begin{cases}
        a_1+a_2+\cdots+a_n=0, \\
        a_2+\cdots+a_n=0, \\
        \cdots \\
        a_{n-1}+a_n=0, \\
        a_n=0, \\
    \end{cases}\Rightarrow\begin{cases}
        a_1=0, \\
        a_2=0, \\
        \cdots \\
        a_n=0.
    \end{cases}\]

    $\therefore$ 式 (\ref{eq4.3}) $\Rightarrow a_0=0$, $\therefore1,\sin x,\sin^2x,\cdots,\sin^nx$ 线性无关.
\end{proof}
\begin{note}
    第 1.2.4 题的 (1) (2) 也可以用类似的方法证明, 比如证明 $e^{a_1x},\cdots,e^{a_nx}$ 线性无关, 先在
    \[b_1e^{a_1x}+\cdots+b_ne^{a_nx}=0\]
    中令 $x=0$ 得 $b_1+\cdots+b_n=0$, 上式再两边除 $e^{a_1x}$, 减去 $b_1+\cdots+b_n$, 就可以得到少一个元素的式子.
\end{note}
\begin{exercisec}[1.2.5]
    证明: 单变量实函数空间中的向量 $f_1,\cdots,f_n$ 线性无关当且仅当 $\exists a_1,\cdots,a_n$ 使得 $\det(f_i(a_j))\neq0$.
\end{exercisec}
\begin{proof}  
    ($\Leftarrow$) $\because\det(f_i(a_j))\neq0$, $\therefore$ 关于 $\alpha_1,\alpha_2,\cdots,\alpha_n$ 的方程组
    \begin{equation}\label{eq4.4}
        \begin{cases}
            \alpha_1f_1(a_1)+\alpha_2f_2(a_1)+\cdots+\alpha_nf_n(a_1)=0 \\
            \alpha_1f_1(a_2)+\alpha_2f_2(a_2)+\cdots+\alpha_nf_n(a_2)=0 \\
            \cdots \\
            \alpha_1f_1(a_n)+\alpha_2f_2(a_n)+\cdots+\alpha_nf_n(a_n)=0 \\
        \end{cases}
    \end{equation}
    只有零解.

    $\therefore$ 如果 $\alpha_1,\alpha_2,\cdots,\alpha_n$ 满足 $\alpha_1f_1+\alpha_2f_2+\cdots+\alpha_nf_n=0$, 那么 $\alpha_1,\alpha_2,\cdots,\alpha_n$ 是方程组 (\ref{eq4.4}) 的解, $\therefore\alpha_1=\alpha_2=\cdots=\alpha_n=0$.

    ($\Rightarrow$) 对 $a_1,a_2,\cdots,a_n\in\mathbb{R}$, 考虑映射
    \[\varphi_{a_1,a_2,\cdots,a_n}:\begin{array}{rcl}
        \left<f_1,\cdots,f_n\right> & \to & \mathbb{R}^n \\
        f & \mapsto & Y_f=[f(a_1),f(a_2),\cdots,f(a_n)] \\
    \end{array}.\]

    容易验证 $\varphi_{a_1,a_2,\cdots,a_n}$ 是线性映射.

    对 $n$ 用数学归纳法证明: 如果 $f_1,\cdots,f_n$ 线性无关, 那么 $\exists a_1,a_2,\cdots,a_n$ 使得 $\varphi_{a_1,a_2,\cdots,a_n}$ 是满射.
    
    当 $n=1$ 时, $\because\{f_1\}$ 线性无关, $\therefore f_1\neq0$, $\therefore\exists a_1\in\mathbb{R}$ 使得 $f_1(a_1)\neq0$. $\therefore\forall y\in\mathbb{R},\exists f=(y/f_1(a_1))f_1\in\left<f_1\right>$ 使得
    \[\varphi_{a_1}(f)=f(a_1)=(y/f_1(a_1))f_1(a_1)=y.\]

    $\therefore\varphi_{a_1}$ 是满射.
    
    假定结论对 $n-1$ 个函数构成的向量组成立. 设 $f_1,\cdots,f_n$ 线性无关, 则 $f_1,\cdots,f_{n-1}$ 线性无关, 由归纳假定, $\exists a_1,a_2,\cdots,a_{n-1}$ 使得 $\varphi_{a_1,a_2,\cdots,a_{n-1}}$ 是满射. $\therefore\exists f_{(1)},\cdots,f_{(n-1)}\in\left<f_1,\cdots,f_{n-1}\right>$ 使得
    \[\varphi_{a_1,a_2,\cdots,a_{n-1}}(f_{(i)})=[0,\cdots,0,1(\text{第}i\text{个}),0,\cdots,0].\]

    有
    \begin{align*}
        & \varphi_{a_1,a_2,\cdots,a_{n-1}}(f_n-f_n(a_1)f_{(1)}-f_n(a_2)f_{(2)}-\cdots-f_n(a_{n-1})f_{(n-1)}) \\
        & =[f_n(a_1),\cdots,f_n(a_{n-1})]-[f_n(a_1),0,\cdots,0]-[0,f_n(a_2),0,\cdots,0] \\
        & \quad-\cdots-[0,\cdots,0,f_n(a_{n-1})]=0.
    \end{align*}

    记 $g=f_n-f_n(a_1)f_{(1)}-\cdots-f_n(a_{n-1})f_{(n-1)}$, 则 $g(a_i)=0\ (i=1,2,\cdots,n-1)$.
    
    $\because f_1,\cdots,f_n$ 线性无关, $\therefore f_n\notin\left<f_1,\cdots,f_{n-1}\right>$. $\therefore$
    \[f_n\neq f_n(a_1)f_{(1)}+f_n(a_2)f_{(2)}+\cdots+f_n(a_{n-1})f_{(n-1)}\Rightarrow g\neq0.\]

    $\therefore\exists a_n\in\mathbb{R}\backslash\{a_1,a_2,\cdots,a_{n-1}\},g(a_n)\neq0$.

    $\therefore\forall[y_1,y_2,\cdots,y_n]\in\mathbb{R}^n,\exists$
    \begin{align*}
        h & =y_1f_{(1)}+\cdots+y_{n-1}f_{(n-1)}+\dfrac{y_n-y_1f_{(1)}(a_n)-\cdots-y_{n-1}f_{(n-1)}(a_{n-1})}{g(a_n)}g \\
        & \in\left<f_{(1)},\cdots,f_{(n-1)},g\right>\subset\left<f_1,\cdots,f_{n-1}\right>
    \end{align*}
    满足 $h(a_i)=y_i\ (i=1,2,\cdots,n)\Rightarrow\varphi_{a_1,a_2,\cdots,a_n}(h)=[y_1,y_2,\cdots,y_n]$. $\therefore\varphi_{a_1,a_2,\cdots,a_n}$ 是满射.

    $\because\varphi_{a_1,a_2,\cdots,a_n}$ 是线性映射, $\therefore\im\varphi_{a_1,a_2,\cdots,a_n}=\left<Y_{f_1},Y_{f_2},\cdots,Y_{f_n}\right>$.
    
    $\varphi_{a_1,a_2,\cdots,a_n}$ 是满射, $\therefore\left<Y_{f_1},Y_{f_2},\cdots,Y_{f_n}\right>=\im\varphi_{a_1,a_2,\cdots,a_n}=\mathbb{R}^n$. $\therefore Y_{f_1},Y_{f_2},\cdots,Y_{f_n}$ 线性无关, 有
    \[\det(f_i(a_j))=\det(Y_{f_1},Y_{f_2},\cdots,Y_{f_n})\neq0.\qedhere\]
\end{proof}
\begin{exercisec}[1.3.2]
    设 $V$ 是 $p$ 元域 $K$ 上的 $n$ 维向量空间 ($n\geq2$). 求:
    \begin{enumerate}
        \def\labelenumi{(\arabic{enumi})}
        \item $V$ 的基的个数;
        \stepcounter{enumi}
        \item $M_n(K)$ 中的退化矩阵的个数.
    \end{enumerate}
\end{exercisec}
\begin{solution}
    与 [BAI] 第 4 章笔记的例 3.6 类似, 得
    \[| GL_n(K)|=(p^n-1)(p^n-p)(p^n-p^2)\cdots(p^n-p^{n-1}).\]

    (1) 由定理 \ref{t1.1} 得 $V$ 的基与 $ GL_n(K)$ 间能建立双射, $\therefore V$ 的基的个数为 $| GL_n(K)|$.

    (3) $\because M_n(K)$ 中的退化矩阵全体为 $M_n(K)\backslash GL_n(K)$, $\therefore M_n(K)$ 中的退化矩阵的个数为
    \[|M_n(K)|-| GL_n(K)|=p^{n^2}-(p^n-1)(p^n-p)(p^n-p^2)\cdots(p^n-p^{n-1}).\]
\end{solution}
\begin{exercisec}[1.3.5]
    设 $K[x_1,x_2,\cdots,x_m]$ 是 $K$ 上的 $m$ 元多项式环, 求下列空间的维数:
    \begin{enumerate}
        \def\labelenumi{(\arabic{enumi})}
        \item 所有 $k$ 次齐次多项式张成的空间;
        \item 所有对称的 $k$ 次齐次多项式张成的空间.
    \end{enumerate}
\end{exercisec}
\begin{solution}
    (1) 所有 $k$ 次齐次多项式张成的空间的一个基是 $\{k$ 次 $m$ 元单项式全体$\}$.
    
    把 $m$ 元单项式的变元看成是 $m$ 个盒子, 每个变元的次数看成是盒子中的球的个数, 空间的维数 $|\{k$ 次 $m$ 元单项式全体$\}|$ 等价于下面的问题的解: 把相同的 $k$ 个球放进 $m$ 个盒子, 求放置方法的个数(记为 $V_{m,k}$).

    把 $k$ 个球放进 $m$ 个盒子可以看成是先把 $i$ 个球放进第一个盒子, 再把 $k-i$ 个球放进后 $m-1$ 个盒子. $\therefore V_{m,k}$ 有递推式
    \[V_{m,k}=\sum\limits_{i=0}^kV_{m-1,k-i}.\]

    (2) 按照 $S(\alpha u+\beta v)=\alpha S(u)+\beta S(v)$ 将 [BAI] 第 6 章第 2 节第 3 小节定义的 $S(v)$ 的定义延拓为 $m$ 元多项式空间到 $m$ 元对称多项式空间 $U$ 的线性映射. 设 $V$ 是 $m$ 元单调单项式全体, 容易证明 $S:\left<V\right>\to U$ 是同构. $\therefore\dim U=|V|$.
\end{solution}
\begin{note}
    写程序来验证这两题.

    (1) 下面的代码中的 \verb|splitList[k_, m_]| 可以生成一个由 $m$ 元组构成的列表, 每个 $m$ 元组对应一个 $k$ 次单项式的各个元的次数或者把相同的 $k$ 个球放进 $m$ 个盒子, 每个盒子里球的个数.
    \begin{lstlisting}
split[list_] := 
  ReplaceList[
   list, {x___, y_} :> {x, y - #, #} /; 0 <= # <= y & /@ 
    Range[0, Max[list]]];
splitList[m_, k_] := Nest[Flatten[split /@ #, 1] &, {{k}}, m - 1];
    \end{lstlisting}

    下面的代码可以用递推式计算 $V_{m,k}$, 并且保存中间步骤:
    \begin{lstlisting}
V[1, k_] = 1;
V[m_, k_] := V[m, k] = Sum[V[m - 1, k - i], {i, 0, k}];
    \end{lstlisting}

    列出当 $m,k<6$ 时 $V_{m,k}$ 的理论值和真实值:
    \begin{lstlisting}
TableForm[Array[V, {6, 6}], TableHeadings -> Automatic]
TableForm[Array[Length[splitList[##]] &, {6, 6}], 
 TableHeadings -> Automatic]
    \end{lstlisting}

    (2) 从 \verb|splitList[k_, m_]| 中去掉反序的 $m$ 元组就得到了全体单调单项式对应的 $m$ 元组:
    \begin{lstlisting}
splitMonoList[m_, k_] := 
  Cases[splitList[m, k], Except[{___, x_, ___, y_, ___} /; x < y]];
TableForm[Array[Length[splitMonoList[##]] &, {6, 6}], 
  TableHeadings -> Automatic]
    \end{lstlisting}
\end{note}
\begin{exercisec}[1.3.9]
    证明: 向量空间 $V$ 是无限维的当且仅当 $V$ 中有一个向量序列 $\boldsymbol{v}_1,\boldsymbol{v}_2,\cdots$ 使得对 $\forall k\in\mathbb{N}_+,\boldsymbol{v}_1,\boldsymbol{v}_2,\cdots,\boldsymbol{v}_k$ 线性无关.
\end{exercisec}
\begin{proof}
    ($\Rightarrow$) $V$ 的一个基就是满足条件的序列.

    ($\Leftarrow$) 由书上的命题 1.29, $\left<\boldsymbol{v}_k|k\in\mathbb{N}_+\right>$ 是无限维的. $\because\left<\boldsymbol{v}_k|k\in\mathbb{N}_+\right>\subset V$, $\therefore V$ 是无限维的.
\end{proof}
\begin{exercisec}[1.3.10, 有修改]
    设 $S,T$ 是一个向量空间的子集, 证明: $\left<S\right>\cap\left<T\right>\supset\left<S\cap T\right>$.

    举例说明真包含关系可以成立.
\end{exercisec}
\begin{proof}
    设 $\boldsymbol{u}_1,\boldsymbol{u}_2,\cdots,\boldsymbol{u}_m\in S\cap T$ 是 $S\cap T$ 的一个极大线性无关组, 则 $\left<\boldsymbol{u}_1,\boldsymbol{u}_2,\cdots,\boldsymbol{u}_m\right>$ 是 $\left<S\right>$ 和 $\left<T\right>$ 的子集.
    
    $\forall\boldsymbol{x}\in\left<S\cap T\right>$, $\boldsymbol{x}\in\left<\boldsymbol{u}_1,\boldsymbol{u}_2,\cdots,\boldsymbol{u}_m\right>\Rightarrow\boldsymbol{x}\in\left<S\right>\wedge\boldsymbol{x}\in\left<T\right>$. $\therefore\left<S\right>\cap\left<T\right>\supset\left<S\cap T\right>$.

    在 $\mathbb{R}^2$ 上, 令
    \[S=\{(1,0),(0,1)\},\quad T=\{(1,2),(3,4)\},\]

    有 $\left<S\right>\cap\left<T\right>=\mathbb{R}^2,\left<S\cap T\right>=\{0\}$.
\end{proof}
\begin{exercisec}[1.40]
    举例说明: 书上的定理 1.38 不能推广到三个子空间的情形.
\end{exercisec}
\begin{solution}
    考虑 $\mathbb{R}^2$ 中的子空间 $U_1=\left<(0,1)\right>,U_2=\left<(1,0)\right>,U_3=\left<(1,1)\right>$. 设 $\mathbb{R}^2$ 的基 $\boldsymbol{e}_1,\boldsymbol{e}_2$ 与 $U_1,U_2$ 相合, 则 $\boldsymbol{e}_1\in U_1,\boldsymbol{e}_2\in U_2$ 或者 $\boldsymbol{e}_1\in U_2,\boldsymbol{e}_2\in U_1$.
    
    $\because U_3\cap U_2=\{\boldsymbol{0}\},U_3\cap U_1=\{\boldsymbol{0}\}$, $\therefore\boldsymbol{e}_1\notin U_3\wedge\boldsymbol{e}_2\notin U_3$, $\therefore\boldsymbol{e}_1,\boldsymbol{e}_2$ 不与 $U_3$ 相合.
\end{solution}
\begin{exercisec}[1.4.1]
    设 $U_1,U_2,U_3$ 是有限维向量空间 $V$ 的子空间, 证明
    \begin{align*}
        \dim(U_1+U_2+U_3) & \leq\dim U_1+\dim U_2+\dim U_3 \\
        & \quad-\dim U_1\cap U_2-\dim U_2\cap U_3-\dim U_3\cap U_1+\dim U_1\cap U_2\cap U_3.
    \end{align*}

    举例说明严格的小于号可以成立.
\end{exercisec}
\begin{proof}
    由补充题 \ref{exc1.4.4} 得
    \[\dim((U_1+U_2)\cap U_3)\geq\dim(U_1\cap U_3+U_2\cap U_3),\]

    $\therefore$
    \begin{align*}
        LHS & =\dim(U_1+U_2)+\dim U_3-\dim((U_1+U_2)\cap U_3) \\
        & \leq(\dim U_1+\dim U_2-\dim U_1\cap U_2)+\dim U_3-\dim(U_1\cap U_3+U_2\cap U_3) \\
        & =\dim U_1+\dim U_2+\dim U_3-\dim U_1\cap U_2 \\
        & \quad-\dim(U_1\cap U_3)-\dim(U_2\cap U_3)+\dim(U_1\cap U_2\cap U_3) \\
        & =RHS.
    \end{align*}

    补充题 \ref{exc1.4.4} 的例子在这里也适用.
\end{proof}
\begin{exercisec}[1.4.2]
    设 $U,W$ 是 $V$ 的有限维子空间, $\dim(U+W)=1+\dim U\cap W$. 证明: $U$ 和 $W$ 一个是 $U+W$, 另一个是 $U\cap W$.
\end{exercisec}
\begin{proof}
    只需证明: $U\subset W$ 或 $W\subset U$. 假设结论不成立, 即 $\exists\boldsymbol{u}\in U\backslash W,\boldsymbol{w}\in W\backslash U$.

    $\because\boldsymbol{u}\notin W,\therefore\boldsymbol{u}\notin U\cap W$. 同理 $\boldsymbol{w}\notin U\cap W$.

    设 $\boldsymbol{v}_1,\cdots,\boldsymbol{v}_m$ 是 $U\cap W$ 的一个基, 则由 $\boldsymbol{u}\notin U\cap W=\left<\boldsymbol{v}_1,\cdots,\boldsymbol{v}_m\right>$ 得 $\boldsymbol{v}_1,\cdots,\boldsymbol{v}_m,\boldsymbol{u}$ 线性无关. 令
    \[\alpha_1\boldsymbol{v}_1+\alpha_2\boldsymbol{v}_2+\cdots+\alpha_n\boldsymbol{v}_n+\beta\boldsymbol{u}+\gamma\boldsymbol{w}=\boldsymbol{0}.\]

    假设 $\gamma\neq0$, 则
    \[\boldsymbol{w}=-\dfrac{\alpha_1}{\gamma}\boldsymbol{v}_1-\dfrac{\alpha_2}{\gamma}\boldsymbol{v}_2-\cdots-\dfrac{\alpha_n}{\gamma}\boldsymbol{v}_n-\dfrac{\beta}{\gamma}\boldsymbol{u}\in U,\]

    与 $\boldsymbol{w}\notin U$ 矛盾. $\therefore\gamma=0$,
    \[\alpha_1\boldsymbol{v}_1+\alpha_2\boldsymbol{v}_2+\cdots+\alpha_n\boldsymbol{v}_n+\beta\boldsymbol{u}=\boldsymbol{0}.\]

    $\because\boldsymbol{v}_1,\cdots,\boldsymbol{v}_m,\boldsymbol{u}$ 线性无关, $\therefore\alpha_1=\alpha_2=\cdots=\alpha_n=\beta=0$. $\therefore\boldsymbol{v}_1,\cdots,\boldsymbol{v}_m,\boldsymbol{u},\boldsymbol{w}$ 线性无关. $\therefore$
    \[\dim(U+V)\geq\dim\left<\boldsymbol{v}_1,\cdots,\boldsymbol{v}_m,\boldsymbol{u},\boldsymbol{w}\right>=m+2=\dim U\cap V+2,\]

    与 $\dim(U+W)=1+\dim U\cap W$ 矛盾.
\end{proof}
\begin{exercisec}[1.4.4]\label{exc1.4.4}
    设 $U,V,W$ 是向量空间的子空间, 证明
    \[U\cap(V+W)\supset(U\cap V)+(U\cap W).\]

    举例说明真包含关系可以成立.
\end{exercisec}
\begin{proof}
    $\forall\boldsymbol{x}\in(U\cap V)+(U\cap W),\exists\boldsymbol{y}_1\in U\cap V,\boldsymbol{y}_2\in U\cap W$ 使得 $\boldsymbol{x}=\boldsymbol{y}_1+\boldsymbol{y}_2$.

    $\because\boldsymbol{y}_1,\boldsymbol{y}_2\in U$, $\therefore\boldsymbol{x}=\boldsymbol{y}_1+\boldsymbol{y}_2\in U$. $\because\boldsymbol{y}_1\in V,\boldsymbol{y}_2\in W$, $\therefore\boldsymbol{x}=\boldsymbol{y}_1+\boldsymbol{y}_2\in V+W$. $\therefore\boldsymbol{x}\in U\cap(V+W)$.

    考虑 $\mathbb{R}^3$ 的子空间
    \[U=\left<(1,1,0)\right>,\quad V=\left<(1,0,0)\right>,\quad W=\left<(0,1,0)\right>,\]

    有
    \[U\cap(V+W)=U,\quad(U\cap V)+(U\cap W)=\{\boldsymbol{0}\}.\qedhere\]
\end{proof}
\begin{exercisec}[1.4.7(1)]
    设 $\boldsymbol{u}_1=(1,2,1),\boldsymbol{u}_2=(1,1,-1),\boldsymbol{u}_3=(1,3,3),\boldsymbol{v}_1=(1,2,2),\boldsymbol{v}_2=(2,3,-1),\boldsymbol{v}_3=(1,1,-3)$, 求出 $\left<\boldsymbol{u}_1,\boldsymbol{u}_2,\boldsymbol{u}_3\right>$ 与 $\left<\boldsymbol{v}_1,\boldsymbol{v}_2,\boldsymbol{v}_3\right>$ 的和与交的一个基.
\end{exercisec}
\begin{solution}
    $\left<\boldsymbol{u}_1,\boldsymbol{u}_2,\boldsymbol{u}_3\right>$ 与 $\left<\boldsymbol{v}_1,\boldsymbol{v}_2,\boldsymbol{v}_3\right>$ 的和为 $\left<\boldsymbol{u}_1,\boldsymbol{u}_2,\boldsymbol{u}_3,\boldsymbol{v}_1,\boldsymbol{v}_2,\boldsymbol{v}_3\right>$. $\because$ 对矩阵
    \[[\boldsymbol{u}_1,\boldsymbol{u}_2,\boldsymbol{u}_3,\boldsymbol{v}_1,\boldsymbol{v}_2,\boldsymbol{v}_3]\]
    作行变换可以得到标准基, $\therefore\left<\boldsymbol{u}_1,\boldsymbol{u}_2,\boldsymbol{u}_3\right>+\left<\boldsymbol{v}_1,\boldsymbol{v}_2,\boldsymbol{v}_3\right>$ 的一个基是标准基.

    解方程
    \begin{equation}\label{eq4.5}
        \alpha_1\boldsymbol{u}_1+\alpha_2\boldsymbol{u}_2+\alpha_3\boldsymbol{u}_3=\beta_1\boldsymbol{v}_1+\beta_2\boldsymbol{v}_2+\beta_3\boldsymbol{v}_3
    \end{equation}
    可以得到 $\left<\boldsymbol{u}_1,\boldsymbol{u}_2,\boldsymbol{u}_3\right>\cap\left<\boldsymbol{v}_1,\boldsymbol{v}_2,\boldsymbol{v}_3\right>$ 中的元素. $\because$
    \begin{align*}
        & \dim(\left<\boldsymbol{u}_1,\boldsymbol{u}_2,\boldsymbol{u}_3\right>\cap\left<\boldsymbol{v}_1,\boldsymbol{v}_2,\boldsymbol{v}_3\right>) \\
        & =\dim\left<\boldsymbol{u}_1,\boldsymbol{u}_2,\boldsymbol{u}_3\right>+\dim\left<\boldsymbol{v}_1,\boldsymbol{v}_2,\boldsymbol{v}_3\right>-\dim(\left<\boldsymbol{u}_1,\boldsymbol{u}_2,\boldsymbol{u}_3\right>+\left<\boldsymbol{v}_1,\boldsymbol{v}_2,\boldsymbol{v}_3\right>) \\
        & =2+2-3=1,
    \end{align*}

    $\therefore$ 只需要求方程 (\ref{eq4.5}) 的一个满足 $\beta_i$ 非零的解. 将方程 (\ref{eq4.5}) 变形为
    \[(^t\boldsymbol{u}_1,^t\boldsymbol{u}_2,^t\boldsymbol{u}_3,^t\boldsymbol{v}_1,^t\boldsymbol{v}_2,^t\boldsymbol{v}_3)[\alpha_1,\alpha_2,\alpha_3,-\beta_1,-\beta_2,-\beta_3]=\boldsymbol{0},\]
    
    系数矩阵作行变换得到
    \[\begin{pmatrix}
        1 & 0 & 2  & 0 & 2  & 2 \\
        0 & 1 & -1 & 0 & 1  & 1 \\
        0 & 0 & 0  & 1 & -1 & -2 \\
    \end{pmatrix}.\]

    令 $-\beta_3=1,\alpha_3=\beta_2=0$, 得 $\alpha_1=-2,\alpha_2=-1,-\beta_1=2$, 有
    \[-2\boldsymbol{u}_1-\boldsymbol{u}_2+2\boldsymbol{v}_1+\boldsymbol{v}_3=\boldsymbol{0}\Rightarrow2\boldsymbol{u}_1+\boldsymbol{u}_2=2\boldsymbol{v}_1+\boldsymbol{v}_3=(3,5,1).\]

    $\therefore\left<\boldsymbol{u}_1,\boldsymbol{u}_2,\boldsymbol{u}_3\right>\cap\left<\boldsymbol{v}_1,\boldsymbol{v}_2,\boldsymbol{v}_3\right>$ 的一个基为 $(3,5,1)$.
\end{solution}
\subsection{习题1.3}
\stepcounter{exsection}
\begin{exercise}\label{ex3.1}
    设 $K$ 是域. 证明: $M_n(K)$ 上的每个线性函数 $f$ 必形如 $f(X)=\tr A_fX$, 其中矩阵 $A_f$ 是唯一确定的.
\end{exercise}
\begin{proof}
    设 $X,Y\in M_n(K),a,b\in K$, 容易验证 $\tr A_f(aX+bY)=a\tr A_fX+b\tr A_fY.\therefore$ 由 $\tilde{f}(X)=\tr A_fX$ 定义的函数 $\tilde{f}\in(M_n(K))^*$.

    $E_{ij}(1\leq i,j\leq n)$ 为 $M_n(K)$ 的一个基. 设 $A_f=(a_{ij})=(f(E_{ji}))$, 则若 $f$ 确定, 则 $A_f$ 唯一确定. 有
    \[A_fE_{ij}=\begin{pmatrix}
               &        &        & (\text{第}j\text{列}) \\
        0      & \cdots & 0      & a_{1i} & 0      & \cdots & 0 \\
        0      & \cdots & 0      & a_{2i} & 0      & \cdots & 0 \\
        \vdots & \ddots & \vdots & \vdots & \vdots & \ddots & \vdots \\
        0      & \cdots & 0      & a_{ni} & 0      & \cdots & 0 \\
    \end{pmatrix},\]

    $\tilde{f}(E_{ij})=\tr A_fE_{ij}=a_{ji}=f(E_{ij}).\therefore f(E_{ij})-\tilde{f}(E_{ij})=0$.
    
    $\because f-\tilde{f}\in(M_n(K))^*$, 由定理 \ref{t2.1}, $f-\tilde{f}=0\Rightarrow f=\tilde{f}$.
\end{proof}
\begin{proof}[另一种证法]
    在 $(M_n(K))^*$ 中与 $E_{ij}$ 对偶的基为 $\{f_{ij}|1\leq i,j\leq n\}$, 其中
    \[f_{ij}:\begin{array}{rcll}
        M_n(K) & \to & K \\
        E_{ij} & \mapsto & 1 \\
        E_{i'j'} & \mapsto & 0 & (i'\neq i,j'\neq j) \\
    \end{array}.\]

    $\forall f\in(M_n(K))^*,\exists!A_f=(a_{ij})\in M_n(K)$ 使得 $f=\sum\limits_{i,j=1}^na_{ij}f_{ji}$.

    $\forall X\in M_n(K)$, 设 $X=(x_{ij})=\sum\limits_{i,j=1}^nx_{ij}E_{ij}$, 则
    \begin{align*}
        f(X) & =f\left(\sum\limits_{k,l=1}^nx_{kl}E_{kl}\right) \\
        & =\sum\limits_{i,j=1}^na_{ij}f_{ji}\left(\sum\limits_{k,l=1}^nx_{kl}E_{kl}\right) \\
        & =\sum\limits_{i,j=1}^na_{ij}\sum\limits_{k,l=1}^nx_{kl}f_{ji}(E_{kl}) \\
        & =\sum\limits_{i=1}^n\sum\limits_{j=1}^na_{ij}x_{ji}.
    \end{align*}

    设 $A_fX=(b_{ij})$, 则 $b_{kl}=\sum\limits_{j=1}^na_{kj}x_{jl}$, 有
    \[\sum\limits_{i=1}^n\sum\limits_{j=1}^na_{ij}x_{ji}=\sum\limits_{i=1}^nb_{ii}=\tr A_fX.\qedhere\]
\end{proof}
\begin{note}
    这题是张量卷积(在第 6 章会介绍)的一个特殊情况, 第二种证明使用的方法可以推广到一般的张量卷积上.
\end{note}
\begin{exercise}% 3.2
    设 $a(X)$ 是 $\mathbb{R}[X]$ 中的一个固定的多项式, $P_n$ 是所有次数 $\leq n-1$ 的实多项式的子空间. 下列 $P_n\to\mathbb{R}$ 的函数是否是线性函数?

    (1) $f(u)=\int_{-1}^1a(t)u(t)\mathrm{d}t,\quad u[X]\in P_n$;

    (2) $f(u)=\int_0^1a(t)u(t^2)\mathrm{d}t$;

    (3) $f(u)=\int_0^1a(t)u^2(t)\mathrm{d}t$;

    (4) $f(u)=\dfrac{\mathrm{d}^3}{\mathrm{d}t^3}a(t)u(t)\Big|_{t=-1}$.
\end{exercise}
\begin{solution}
    按照定义逐一验证. (1)(2)(4) 是线性函数.

    (3) 设 $v(t)=\dfrac{1}{u(t)a(t)}.\because$
    \begin{align*}
        f(u+v) & =\int_0^1a(t)(u(t)+v(t))^2\mathrm{d}t \\
        & =\int_0^1a(t)u^2(t)\mathrm{d}t+\int_0^1a(t)v^2(t)\mathrm{d}t+2\int_0^1a(t)u(t)v(t)\mathrm{d}t \\
        & =\int_0^1a(t)u^2(t)\mathrm{d}t+\int_0^1a(t)v^2(t)\mathrm{d}t+2\int_0^11\mathrm{d}t \\
        & \neq\int_0^1a(t)u^2(t)\mathrm{d}t+\int_0^1a(t)v^2(t)\mathrm{d}t,
    \end{align*}
    
    $\therefore f(u)$ 不是线性函数.
\end{solution}
\begin{note}
    用下面这段代码验证 (4), 输出 $0$ 则说明 $f(mu+nv)=mf(u)+nf(v)$ (没错我又偷懒了):
    \begin{lstlisting}
D[a[x] m u[x], {x, 3}] + D[a[x] n v[x], {x, 3}] - 
  D[a[x] (m u[x] + n v[x]), {x, 3}] // Simplify
    \end{lstlisting}
\end{note}
\begin{exercise}% 3.3
    设 $f,g\in V^*$ 满足 $\ker f=\ker g$. 证明: $\exists\lambda\in K$ 使得 $g=\lambda f$.
\end{exercise}
\begin{solution}
    设 $\boldsymbol{x}\in\ker f=\ker g$. 则在 $V^{**}$ 中有
    \[\varepsilon_{\boldsymbol{x}}(f)=\varepsilon_{\boldsymbol{x}}(g)=0.\]

    $\because\ker f$ 是方程 $f(\boldsymbol{x})=0$ 的解空间, 由书上的定理 4(i) 得 $\dim\ker f\geq n-1$(当且仅当 $f=0$ 时取大于号).

    $\therefore\exists r\ (r\geq n-1)$ 个线性无关的向量 $\boldsymbol{x}_1,\boldsymbol{x}_2,\cdots,\boldsymbol{x}_r$ 使得
    \begin{equation}\label{eq4.6}
        \begin{cases}
            \varepsilon_{\boldsymbol{x_1}}(f)=f(\boldsymbol{x_1})=0, \\
            \varepsilon_{\boldsymbol{x_2}}(f)=f(\boldsymbol{x_2})=0, \\
            \cdots, \\
            \varepsilon_{\boldsymbol{x_r}}(f)=f(\boldsymbol{x_r})=0. \\
        \end{cases}
    \end{equation}

    $\because\boldsymbol{x}\to\varepsilon_{\boldsymbol{x}}$ 是同构, $\therefore\varepsilon_{\boldsymbol{x_1}},\cdots,\varepsilon_{\boldsymbol{x_r}}$ 线性无关, 秩为 $r$. 由书上的定理 4 得方程组 (\ref{eq4.6}) 的解空间 $U$ 满足 $\dim U=n-r\leq 1$.

    $\because f,g\in U,\therefore\exists\lambda\in K$ 使得 $g=\lambda f$.
\end{solution}
\begin{exercise}% 3.4
    设 $\boldsymbol{x}\in V\backslash\{0\}$. 条件 $f(\boldsymbol{x})=1$ 能将 $f\in V^*$ 唯一决定吗?
\end{exercise}
\begin{solution}
    不能. $\because f(\boldsymbol{x})=1,\therefore\boldsymbol{x}\neq0,\rank \{\boldsymbol{x}\}=1$. 假设若 $f(\boldsymbol{x})=1,g(\boldsymbol{x})=1$, 则 $f=g.\therefore$ 在 $V^{**}$ 中有
    \[\varepsilon_{\boldsymbol{x}}(f-g)=0\Rightarrow f-g=0.\]

    $\therefore\ker\varepsilon_{\boldsymbol{x}}=\{0\}$.
    
    另一方面, 由书上的定理 4(i) 得 $\dim\ker\varepsilon_{\boldsymbol{x}}=n-\rank \{\boldsymbol{x}\}$, 与 $\ker\varepsilon_{\boldsymbol{x}}=\{0\}$ 矛盾.
\end{solution}
\begin{exercise}% 3.5
    证明: $\forall f\in V^*\backslash\{0\},i=1,2,\cdots,n,\exists V$ 的一个基 $\boldsymbol{e}_1,\boldsymbol{e}_2,\cdots,\boldsymbol{e}_n$ 使得 $\forall\boldsymbol{x}=\alpha_1\boldsymbol{e}_1+\alpha_2\boldsymbol{e}_2+\cdots+\alpha_n\boldsymbol{e}_n,f(\boldsymbol{x})=\alpha_i$.
\end{exercise}
\begin{proof}
    $\because f\neq 0,\therefore f$ 可以扩充为 $V^*$ 的一个基 $e^1,\cdots,e^{i-1},f,e^{i+1},\cdots,e^n$.
    
    由书上第 3 小节的最后一句话, $\exists V$ 的一个基与 $e^1,\cdots,e^{i-1},f,e^{i+1},\cdots,e^n$ 对偶. 设 $\boldsymbol{e}_1,\boldsymbol{e}_2,\cdots,\boldsymbol{e}_n$ 与 $e^1,\cdots,e^{i-1},f,e^{i+1},\cdots,e^n$ 对偶, 则 $\boldsymbol{e}_1,\boldsymbol{e}_2,\cdots,\boldsymbol{e}_n$ 满足 $f(\boldsymbol{e}_j)=\delta_{ij},f(\boldsymbol{x})=\alpha_i$.
\end{proof}
\begin{exercisec}[1.6.2]\label{exc1.6.2}
    证明: $n$ 维向量空间的任何 $k$ 维子空间 $U$ 都是 $n-k$ 个线性函数的核的交.
\end{exercisec}
\begin{proof}
    设 $\boldsymbol{e}_1,\boldsymbol{e}_2,\cdots,\boldsymbol{e}_k$ 是 $U$ 的一个基, 将其扩充为 $V$ 的一个基 $\boldsymbol{e}_1,\boldsymbol{e}_2,\cdots,\boldsymbol{e}_n$. 设这个基在 $V^*$ 上的对偶基为 $e^1,e^2,\cdots,e^n$, 则 $\forall i>k,j\leq k,e^i(\boldsymbol{e}_j)=0$. 

    $\therefore\forall i>k,\forall\boldsymbol{x}\in U,e^i(\boldsymbol{x})=0$. $\therefore U\subset\ker e^i$. $\therefore U\subset\bigcap\limits_{i=k+1}^n\ker e^i$.

    另一方面, $\bigcap\limits_{i=k+1}^n\ker e^i$ 是方程组 $e^i(\boldsymbol{x})=0,i=k+1,\cdots,n$ 的解空间. $\because e^{k+1},\cdots,e^n$ 的秩为 $n-k$, 由书上定理 4(i) 得 $\dim\bigcap\limits_{i=k+1}^n\ker e^i=n-(n-k)=k$, $\therefore U=\bigcap\limits_{i=k+1}^n\ker e^i$.
\end{proof}
\begin{exercisec}[1.6.3]
    证明: $n$ 维向量空间上的 $n$ 个线性函数 $f^1,f^2,\cdots,f^n$ 线性无关当且仅当它们的核的交是 $\{\boldsymbol{0}\}$.
\end{exercisec}
\begin{proof}
    ($\Leftarrow$) 在补充题 \ref{exc1.6.2} 的证明中, 令 $k=0$ 得.

    ($\Rightarrow$) 由书上定理 4(i) 得方程组 $f^1(\boldsymbol{x}),f^2(\boldsymbol{x}),\cdots,f^n(\boldsymbol{x})$ 的解空间 $U=\{\boldsymbol{0}\}$, $\therefore$
    \[\bigcap\limits_{i=1}^n\ker f^i=U=\{\boldsymbol{0}\}.\qedhere\]
\end{proof}
\begin{exercisec}[1.6.4]
    设 $f,g$ 是向量空间 $V$ ($\charop K\neq 2$) 的两个线性函数. 证明: 如果 $\forall\boldsymbol{x}\in V,f(\boldsymbol{x})g(\boldsymbol{x})=0$, 那么 $f=0\vee g=0$.
\end{exercisec}
\begin{proof}
    取 $V$ 的一个基 $\boldsymbol{e}_1,\boldsymbol{e}_2,\cdots,\boldsymbol{e}_n$, 设 $\boldsymbol{x}$ 在这个基下的坐标为 $X$, 则
    \[f(\boldsymbol{x})=(f(\boldsymbol{e}_1),f(\boldsymbol{e}_2),\cdots,f(\boldsymbol{e}_n))X,\quad g(\boldsymbol{x})=(g(\boldsymbol{e}_1),g(\boldsymbol{e}_2),\cdots,g(\boldsymbol{e}_n))X.\]

    $\therefore$
    \begin{align*}
        f(\boldsymbol{x})g(\boldsymbol{x}) & =(f(\boldsymbol{e}_1),f(\boldsymbol{e}_2),\cdots,f(\boldsymbol{e}_n))X(g(\boldsymbol{e}_1),g(\boldsymbol{e}_2),\cdots,g(\boldsymbol{e}_n))X \\
        & =X{}^t[f(\boldsymbol{e}_1),f(\boldsymbol{e}_2),\cdots,f(\boldsymbol{e}_n)](g(\boldsymbol{e}_1),g(\boldsymbol{e}_2),\cdots,g(\boldsymbol{e}_n))X.
    \end{align*}

    $\because\forall\boldsymbol{x}\in V,f(\boldsymbol{x})g(\boldsymbol{x})=0$, $\therefore$ 由补充题 \ref{exc1.7.11} 得矩阵
    \[[f(\boldsymbol{e}_1),f(\boldsymbol{e}_2),\cdots,f(\boldsymbol{e}_n)](g(\boldsymbol{e}_1),g(\boldsymbol{e}_2),\cdots,g(\boldsymbol{e}_n))\]
    是斜对称的, 即 $f(\boldsymbol{e}_i)g(\boldsymbol{e}_j)=-f(\boldsymbol{e}_j)g(\boldsymbol{e}_i)$.

    假设 $f\neq0\wedge g\neq0$, 则 $f,g$ 分别在 $\boldsymbol{e}_1,\boldsymbol{e}_2,\cdots,\boldsymbol{e}_n$ 上的取值不全为 $0$.

    不妨设 $f(\boldsymbol{e}_i)\neq0,g(\boldsymbol{e}_j)\neq0$, 则 $f(\boldsymbol{e}_i)g(\boldsymbol{e}_j)\neq0$. $\therefore f(\boldsymbol{e}_j)g(\boldsymbol{e}_i)=-f(\boldsymbol{e}_i)g(\boldsymbol{e}_j)\neq0\Rightarrow f(\boldsymbol{e}_j)\neq0\Rightarrow f(\boldsymbol{e}_j)g(\boldsymbol{e}_j)\neq0$, 与 $f(\boldsymbol{e}_j)g(\boldsymbol{e}_j)=0$ 矛盾.
\end{proof}
\subsection{习题1.4}
\subsubsection{基本概念}
\begin{exercisec}[1.7.1(2), 有修改]
    证明映射
    \[\varphi:\begin{array}{rcl}
        M_n(K)\times M_n(K) & \to & K \\
        (A,B) & \to & \tr(AB) \\
    \end{array}\]
    是对称的双线性型. 计算其秩.
\end{exercisec}
\begin{proof}
    设
    \[L_A:\begin{array}{rcl}
            M_n(K) & \to & M_n(K) \\
            X & \to & AX \\
        \end{array},\quad R_A:\begin{array}{rcl}
            M_n(K) & \to & M_n(K) \\
            X & \to & XA \\
        \end{array}.\]
    容易验证 $L_A,R_A$ 是线性映射. 由第 \ref{ex3.1} 题的证明得 $\tr $ 是线性映射.

    与性质 \ref{p2.1} 类似, 得 $\varphi_A(X)=\varphi(X,A)=\tr \circ R_A$ 和 $\varphi_A'(X)=\varphi(A,X)=\tr \circ L_A$ 是线性映射. $\therefore\varphi$ 是双线性映射.

    $E_{ij}(1\leq i,j\leq n)$ 是 $M_n(K)$ 的一个基. 将 $E_{ij}$ 排成一行:
    \[E_{11},\cdots,E_{1n},E_{21},\cdots,E_{2n},E_{31},\cdots,E_{n1},\cdots,E_{nn}.\]

    记 $\tilde{E}_k\ (1\leq k\leq n^2)$ 为上述序列的第 $k$ 个, 则 $\tilde{E}_k\ (1\leq k\leq n^2)$ 是 $M_n(K)$ 的一个基.
    
    设 $F=(f_{ij})$ 是 $\varphi$ 在 $\tilde{E}_k\ (1\leq k\leq n^2)$ 下的矩阵, 则
    \[f_{n(i-1)+j,n(k-1)+l}=\tr (E_{ij}E_{kl}).\]

    $\because E_{ij}E_{kl}=\delta_{jk}E_{il},\therefore f_{n(i-1)+j,n(j-1)+i}=1,F$ 的其余元为 $0$.

    $\therefore F$ 是对称矩阵, $\therefore\varphi$ 是对称的双线性型.

    交换 $F$ 的第 $n(i-1)+j,n(j-1)+i\ (1\leq i,j\leq n)$ 行得到 $n^2$ 阶单位矩阵 $E.\because$ 初等行变换不改变矩阵的秩, $\therefore\rank F=\rank E=n^2$.
\end{proof}
\begin{exercisec}
    设 $V=P_n(X)$ 为次数 $\leq n$ 的实多项式, 容易验证
    \[\varphi:\begin{array}{rcl}
        V\times V & \to & \mathbb{R} \\
        (f,g) & \to & \int_{-1}^1fg\mathrm{d}x \\
    \end{array}\]
    是对称的双线性型. 对 $n=1,2$, 求规范基.
\end{exercisec}
\begin{solution}
    $\because\int_{-1}^11\cdot 1\mathrm{d}x\neq0,\int_{-1}^1x\cdot x\mathrm{d}x\neq0,\int_{-1}^11\cdot x\mathrm{d}x=0,\therefore1,X$ 是 $P_1(X)$ 的一个规范基.

    $\because$
    \[\int_{-1}^1\left(x^2-\dfrac{2}{3}\right)\cdot 1\mathrm{d}x=0,\quad\int_{-1}^1\left(x^2-\dfrac{2}{3}\right)\cdot x\mathrm{d}x=0,\quad\int_{-1}^1\left(x^2-\dfrac{2}{3}\right)^2\mathrm{d}x\neq0,\]

    $\therefore1,X,X^2-\dfrac{2}{3}$ 是 $P_1(X)$ 的一个规范基.
\end{solution}
\begin{exercisec}[1.72(1)]
    定义双线性型 $f$ 的右核 $R_f=\{\boldsymbol{y}\in V|f(\boldsymbol{x},\boldsymbol{y})=0,\forall\boldsymbol{x}\in V\}$. 证明: $\dim R_f=\dim V-\rank f$.
\end{exercisec}
\begin{proof}
    设 $\boldsymbol{e}_1,\boldsymbol{e}_2,\cdots,\boldsymbol{e}_n$ 是 $V$ 的一个基, 则 $R_f$ 是方程组
    \[f(\boldsymbol{x},\boldsymbol{e}_1)=0,f(\boldsymbol{x},\boldsymbol{e}_2)=0,\cdots,f(\boldsymbol{x},\boldsymbol{e}_n)=0\]
    的解空间. 设 $f_i(\boldsymbol{x})=f(\boldsymbol{x},\boldsymbol{e}_i)\in V^*$, 则 $R_f$ 是方程组
    \[f_1(\boldsymbol{x})=0,f_2(\boldsymbol{x})=0,\cdots,f_n(\boldsymbol{x})=0\]
    的解空间. 由书上第 3 节的定理 4(i) 得 $\dim R_f=\dim V-\rank\{f_1,f_2,\cdots,f_n\}$.

    把 $\boldsymbol{e}_i$ 看成是 $V^*$ 上的线性函数: $\forall f\in V^*$,
    \[\boldsymbol{e}_i(f)=f(\boldsymbol{e}_i).\]

    $\because\boldsymbol{e}_1,\boldsymbol{e}_2,\cdots,\boldsymbol{e}_n$ 是 $V^{**}$ 的一个基, 由书上第 3 节的定理 3 (或者书上的定理 1.57, 后者在叙述和证明上都更清楚) 得
    \[\rank\{f_1,f_2,\cdots,f_n\}=\rank(\boldsymbol{e}_i(f_j))=\rank(f_j(\boldsymbol{e}_i))=\rank(f(\boldsymbol{e}_i,\boldsymbol{e}_j))=\rank f.\qedhere\]
\end{proof}
\subsubsection{对称双线性型}
\stepcounter{exsection}
\begin{exercise}\label{ex4.1}
    设 $\Delta_1,\Delta_2,\cdots,\Delta_n=F$ 是矩阵 $F$ 对应的实二次型 $q$ 的主子式. 证明: $q$ 和 $F$ 是负定的当且仅当 $(-1)^k\Delta_k>0$ 对 $\forall k=1,2,\cdots,n$ 成立.
\end{exercise}
\begin{proof}
    ($\Leftarrow$) 设 $X=[x_1,x_2,\cdots,x_n]$ 满足 $q(\boldsymbol{x})={}^tXFX$. 由定理 \ref{t3.6} 得
    \[q(\boldsymbol{x})=\dfrac{\Delta_1}{\Delta_0}x_1^2+\dfrac{\Delta_2}{\Delta_1}x_2^2+\cdots+\dfrac{\Delta_n}{\Delta_{n-1}}x_n^2.\]

    $\because(-1)^k\Delta_k>0,\therefore\dfrac{\Delta_k}{\Delta_{k-1}}<0\ (k=1,2,\cdots,n),\therefore\forall\boldsymbol{x},q(\boldsymbol{x})<0.\therefore q$ 和 $F$ 是负定的.

    ($\Rightarrow$) 对 $\dim V$ 用数学归纳法. 当 $\dim V=1$ 时成立. 假设当 $\dim V=n-1$ 时成立. 当 $\dim V=n$ 时与书上定理 8 的证明一样, 得 $(-1)^k\Delta_k>0,k=1,2,\cdots,n-1$.

    假设 $(-1)^n\Delta_n\leq0$, 则 $(-1)^{n-1}\Delta_n\geq0$. 设 $\boldsymbol{x}=\boldsymbol{e}_n$, 则由定理 \ref{t3.6} 得
    \[q(\boldsymbol{x})=\dfrac{\Delta_n}{\Delta_{n-1}}=\dfrac{(-1)^{n-1}\Delta_n}{(-1)^{n-1}\Delta_{n-1}}\geq0,\]

    与 $q$ 是负定的矛盾. $\therefore(-1)^n\Delta_n>0$.
\end{proof}
\begin{exercise}[有修改]% 4.2
    举出例子:
    
    (1) 正定矩阵 $A=(a_{ij})$ 的某个元素 $a_{ij}<0$;

    (1) 矩阵 $A=(a_{ij})$ 的每个元素 $a_{ij}$ 都 $>0$, 但 $A$ 却不是正定的.
\end{exercise}
\begin{solution}
    \[(1)\begin{pmatrix}
        1 & -\dfrac{1}{2} \\
        -\dfrac{1}{2} & 1
    \end{pmatrix},\quad (2)\begin{pmatrix}
        1 & 1 \\
        1 & 1
    \end{pmatrix}.\]
\end{solution}
\begin{exercise}% 4.3
    找出所有的 $\lambda,\mu\in\mathbb{R}$ 使得矩阵
    \[\begin{pmatrix}
        1 & \lambda & \lambda \\
        \lambda & 1 & \lambda \\
        \lambda & \lambda & 1 \\
    \end{pmatrix},\]
    是正定的, 而矩阵
    \[\begin{pmatrix}
        1 & 1 & \mu \\
        1 & \mu & 1 \\
        \mu & 1 & 1 \\
    \end{pmatrix}\]
    是负定的.
\end{exercise}
\begin{solution}
    由书上的定理 8, 只需找到满足 $\Delta_i>0,i=1,2,3$ 的 $\lambda$. 有
    \[\begin{cases}
        \Delta_1=1>0, \\
        \Delta_2=1-\lambda^2>0, \\
        \Delta_3=1+2\lambda^3-3\lambda^2>0,
    \end{cases}\Rightarrow-\dfrac{1}{2}\leq\lambda\leq1.\]

    由第 \ref{ex4.1} 题, 只需找到满足 $(-1)^i\Delta_i>0,i=1,2,3$ 的 $\mu$. 有
    \[\begin{cases}
        \Delta_1=1>0, \\
        \Delta_2=\mu-1<0, \\
        \Delta_3=-\mu^3+3\mu-2>0,
    \end{cases}\Rightarrow\mu\leq-2.\]
\end{solution}
\begin{note}
    原题要求两个矩阵正定, 但第二个矩阵的行列式 $\leq0$.
\end{note}
\begin{exercise}% 4.4
    设 $\boldsymbol{x}=[x_1,x_2,x_3]\in\mathbb{C}^3$,
    \[Q(\boldsymbol{x})=x_1^3+x_2^3+x_3^3-3x_1x_2x_3=(x_1+x_2+x_3)(x_1+\varepsilon x_2+\varepsilon^2x_3)(x_1+\varepsilon^2x_2+\varepsilon x_3),\]

    其中 $\varepsilon$ 是 $3$ 次本原根. 证明 $Q(\boldsymbol{x})Q(\boldsymbol{y})=Q(\boldsymbol{z})$, 其中 $z_i=z_i(\boldsymbol{x},\boldsymbol{y})=\sum\limits_{j,k}a^{(i)}_{jk}x_jy_k$ 是对称的双线性型.
\end{exercise}
\begin{proof}
    设
    \[z_1=x_1y_1+x_2y_3+x_3y_2,\quad z_2=x_1y_2+x_2y_1+x_3y_3,\quad z_3=x_1y_3+x_3y_1+x_2y_2.\]

    显然 $z_i(\boldsymbol{x},\boldsymbol{y})$ 是对称的双线性型. 有
    \begin{align*}
        z_1+z_2+z_3 & =x_1y_1+x_2y_3+x_3y_2+x_1y_2+x_2y_1+x_3y_3+x_1y_3+x_3y_1+x_2y_2 \\
        & =x_1y_1+x_1y_2+x_2y_1+x_1y_3+x_2y_2+x_3y_1+x_2y_3+x_3y_2+x_3y_3 \\
        & =(x_1+x_2+x_3)(y_1+y_2+y_3),
    \end{align*}
    \begin{align*}
        & z_1+\varepsilon z_2+\varepsilon^2z_3 \\
        & =x_1y_1+x_2y_3+x_3y_2+\varepsilon(x_1y_2+x_2y_1+x_3y_3)+\varepsilon^2(x_1y_3+x_3y_1+x_2y_2) \\
        & =x_1y_1+\varepsilon(x_1y_2+x_2y_1)+\varepsilon^2(x_1y_3+x_2y_2+x_3y_1)+\varepsilon^3(x_2y_3+x_3y_2)+\varepsilon^4x_3y_3 \\
        & =(x_1+\varepsilon x_2+\varepsilon^2x_3)(y_1+\varepsilon y_2+\varepsilon^2y_3),
    \end{align*}
    \begin{align*}
        & z_1+\varepsilon^2z_2+\varepsilon z_3 \\
        & =x_1y_1+x_2y_3+x_3y_2+\varepsilon^2(x_1y_2+x_2y_1+x_3y_3)+\varepsilon(x_1y_3+x_3y_1+x_2y_2) \\
        & =x_1y_1+\varepsilon^2(x_1y_2+x_2y_1+x_3y_3)+\varepsilon(x_1y_3+x_2y_2+x_3y_1)+\varepsilon^3(x_2y_3+x_3y_2)+\varepsilon^4x_2y_2 \\
        & =(x_1+\varepsilon^2x_2+\varepsilon x_3)(y_1+\varepsilon^2y_2+\varepsilon y_3),
    \end{align*}

    $\therefore$
    \begin{align*}
        Q(\boldsymbol{z}) & =(z_1+z_2+z_3)(z_1+\varepsilon z_2+\varepsilon^2z_3)(z_1+\varepsilon^2z_2+\varepsilon z_3) \\
        & =(x_1+x_2+x_3)(y_1+y_2+y_3)(x_1+\varepsilon x_2+\varepsilon^2x_3)(y_1+\varepsilon y_2+\varepsilon^2y_3) \\
        & \quad\cdot(x_1+\varepsilon^2x_2+\varepsilon x_3)(y_1+\varepsilon^2y_2+\varepsilon y_3) \\
        & =Q(\boldsymbol{x})Q(\boldsymbol{y}).\qedhere
    \end{align*}
\end{proof}
\begin{exercise}% 4.5
    证明: $\forall$ 实对称矩阵 $A=(a_{ij}),\exists\varepsilon\in\mathbb{R}$ 使得矩阵 $B=E+\varepsilon A$ 正定.
\end{exercise}
\begin{proof}
    对矩阵的阶 $n$ 用数学归纳法. 当 $n=1$ 时取 $\varepsilon=-\operatorname{sgn}a_{11}$ 即可.

    假设对任一 $n-1$ 阶矩阵成立, 对 $n$ 阶矩阵 $A$, 设 $E+\varepsilon A$ 的主子式为 $\Delta_i$, $E+\varepsilon A$ 去掉最后一行和最后一列得到的矩阵 $C$ 的主子式为 $\overline{\Delta}_i$, 则 $\Delta_i=\overline{\Delta}_i,\forall i=1,2,\cdots,n-1$.

    由归纳假定, $C$ 正定, 由书上的定理 8 得 $\Delta_i=\overline{\Delta}_i>0$.
    
    将 $\Delta_n=\det(E+\varepsilon A)$ 按第 $n$ 行展开:
    \begin{align*}
        \Delta_n & =\varepsilon a_{n1}A_{n1}+\cdots+\varepsilon a_{n,n-1}A_{n,n-1}+(1+\varepsilon a_{nn})\Delta_{n-1} \\
        & =\Delta_{n-1}+\varepsilon(a_{n1}A_{n1}+\cdots+a_{n,n-1}A_{n,n-1}+a_{nn}\Delta_{n-1}),
    \end{align*}

    其中 $A_{ni}$ 是 $E+\varepsilon A$ 的某个子式, 因而是有界量. $\therefore$ 取 $\varepsilon$ 足够小可以使得 $\Delta_n$ 与 $\Delta_{n-1}$ 同号.
    
    $\because\Delta_{n-1}>0,\therefore\Delta_n>0$. 由书上的定理 8 得 $B=E+\varepsilon A$ 正定.
\end{proof}
\begin{exercisec}[1.7.2]\label{exc1.7.2}
    求
    \[^tX\begin{pmatrix}
        2 & 1 \\
        1 & 3
    \end{pmatrix}Y\]
    的规范基.
\end{exercisec}
\begin{solution}
    对矩阵同时进行初等行,列变换:
    \[\begin{pmatrix}
            2 & 1 \\
            1 & 3
        \end{pmatrix}=\begin{pmatrix}
            1 & 0 \\
            \dfrac{1}{2} & 1
        \end{pmatrix}\begin{pmatrix}
            2 & 0 \\
            0 & \dfrac{5}{2}
        \end{pmatrix}\begin{pmatrix}
            1 & \dfrac{1}{2} \\
            0 & 1
        \end{pmatrix}.\]

        设基 $(\boldsymbol{e}_i')$ 满足
        \[A=\begin{pmatrix}
            1 & \dfrac{1}{2} \\
            0 & 1
        \end{pmatrix}\]
        是 $(\boldsymbol{e}_i')$ 到 $(\boldsymbol{e}_i)$ 的转换矩阵, 由定理 \ref{t3.1}, 题中的双线性型的规范基为 $(\boldsymbol{e}_i')$.

        $\therefore\left(\boldsymbol{e}_1,\dfrac{1}{2}\boldsymbol{e}_1+\boldsymbol{e}_2\right)$ 是题中的双线性型的规范基.
\end{solution}
\begin{exercisec}[1.7.3]
    用 Jacobi 方法把双线性型
    \[f(\boldsymbol{x},\boldsymbol{y})=x_1y_1-x_1y_2+x_1y_3-x_2y_1+x_2y_2+2x_2y_3+x_3y_1+2x_3y_2+x_3y_3\]
    化为典范型.
\end{exercisec}
\begin{solution}
    $f$ 在基 $[0,0,1],[0,1,0],[1,0,0]$ 下的矩阵为
    \[F=\begin{pmatrix}
        1 & 2  & 1  \\
        2 & 1  & -1 \\
        1 & -1 & 1  \\
    \end{pmatrix}.\]

    有
    \[\Delta_1=1,\quad\Delta_2=-3,\quad\Delta_3=-9.\]

    设 $f$ 在 $\left<[0,0,1],[0,1,0]\right>$ 上的限制为 $\bar{f}$. 考虑 $\left<[0,0,1],[0,1,0]\right>$ 上的方程
    \[\bar{f}(\boldsymbol{x},[0,0,1])=0\Rightarrow2x_2+x_3=0.\]

    $[0,1,-2]$ 是上述方程在 $\left<[0,0,1],[0,1,0]\right>$ 中的一个解, 且
    \[\begin{pmatrix}
        0 & 0 \\
        0 & 1 \\
        1 & 0 \\
    \end{pmatrix}=\begin{pmatrix}
        0 & 0 \\
        0 & 1 \\
        1 & -2 \\
    \end{pmatrix}\begin{pmatrix}
        1 & 2 \\
        0 & 1 \\
    \end{pmatrix}.\]

    $\therefore$ 令
    \[\begin{pmatrix}
        0 \\
        x_2 \\
        x_3 \\
    \end{pmatrix}=x_1'\begin{pmatrix}
        0 \\
        0 \\
        1 \\
    \end{pmatrix}+x_2'\begin{pmatrix}
        0 \\
        1 \\
        -2 \\
    \end{pmatrix}\Rightarrow\begin{cases}
        x_2'=x_2 \\
        x_1'=x_3+2x_2 \\
    \end{cases}\]
    (对 $y_1',y_2'$ 同理), 则 $\bar{f}$ 有典范型
    \[\bar{f}(\boldsymbol{x},\boldsymbol{y})=\dfrac{\Delta_1}{\Delta_0}x_1'y_1'+\dfrac{\Delta_2}{\Delta_1}x_2'y_2'=(x_3+2x_2)(y_3+2y_2)-3x_2y_2.\]

    考虑 $\mathbb{R}^3$ 上的方程组
    \[\begin{cases}
        f(\boldsymbol{x},[0,0,1])=0, \\
        f(\boldsymbol{x},[0,1,-2])=0 \\
    \end{cases}\Rightarrow\begin{cases}
        x_1+2x_2+x_3=0, \\
        -3x_2-3x_3=0. \\
    \end{cases}\]

    $[1,-1,1]$ 是上述方程组的一个解, 且
    \[\begin{pmatrix}
        0 & 0 & 1 \\
        0 & 1 & 0 \\
        1 & 0 & 0 \\
    \end{pmatrix}=\begin{pmatrix}
        0 & 0  & 1 \\
        0 & 1  & -1 \\
        1 & -2 & 1 \\
    \end{pmatrix}\begin{pmatrix}
        1 & 2 & 1 \\
        0 & 1 & 1 \\
        0 & 0 & 1 \\
    \end{pmatrix}.\]

    $\therefore$ 令
    \[\begin{pmatrix}
        x_1 \\
        x_2 \\
        x_3 \\
    \end{pmatrix}=x_1''\begin{pmatrix}
        0 \\
        0 \\
        1 \\
    \end{pmatrix}+x_2''\begin{pmatrix}
        0 \\
        1 \\
        -2 \\
    \end{pmatrix}+x_3''\begin{pmatrix}
        1 \\
        -1 \\
        1 \\
    \end{pmatrix}\Rightarrow\begin{cases}
        x_3''=x_1 \\
        x_2''=x_1+x_2 \\
        x_1''=x_1+2x_2+x_3 \\
    \end{cases}\]
    (对 $y_1'',y_2'',y_3''$ 同理), 则 $f$ 有典范型
    \begin{align*}
        f(\boldsymbol{x},\boldsymbol{y}) & =\dfrac{\Delta_1}{\Delta_0}x_1''y_1''+\dfrac{\Delta_2}{\Delta_1}x_2''y_2''+\dfrac{\Delta_3}{\Delta_2}x_3''y_3'' \\
        & =(x_1+2x_2+x_3)(y_1+2y_2+y_3)-3(x_1+x_2)(y_1+y_2)+3x_1y_1.
    \end{align*}
\end{solution}
\begin{exercisec}[1.7.4]
    用 Jacobi 方法判断下面两个矩阵是否合同:
    \[\begin{pmatrix}
        1 & 2 & 3 \\
        2 & 0 & -1 \\
        3 & -1 & 3 \\
    \end{pmatrix},\quad\begin{pmatrix}
        1 & 3 & 0 \\
        3 & 1 & 1 \\
        0 & 1 & 5 \\
    \end{pmatrix}.\]
\end{exercisec}
\begin{proof}
    这两个矩阵的主子式分别为
    \[\Delta_1=1,\quad\Delta_2=-4,\quad\Delta_3=-25,\quad\Delta_1'=1,\quad\Delta_2'=-8,\quad\Delta_3'=-41.\]

    $\therefore$ 这两个矩阵分别合同于
    \[\diag(1,-4,25/4),\quad\diag(1,-8,41/8).\]

    $\therefore$ 这两个矩阵不合同.
\end{proof}
\begin{exercisec}
    把 $X_1X_2+X_2^2+X_2X_3$ 化为规范型.
\end{exercisec}
\begin{solution}
    \begin{align*}
        & X_1X_2+X_2^2+X_2X_3 \\
        & =\left(X_2^2+X_1X_2+X_2X_3+\dfrac{1}{4}X_1^2+\dfrac{1}{2}X_1X_3+\dfrac{1}{4}X_3^2\right)-\dfrac{1}{4}X_1^2-\dfrac{1}{4}X_3^2-\dfrac{1}{2}X_1X_3 \\
        & =\left(X_2+\dfrac{1}{2}X_1+\dfrac{1}{2}X_3\right)^2-\dfrac{1}{4}(X_1^2+X_3^2+2X_1X_3) \\
        & =\left(X_2+\dfrac{1}{2}X_1+\dfrac{1}{2}X_3\right)^2-\left(\dfrac{X_1+X_3}{2}\right)^2.
    \end{align*}
\end{solution}
\begin{exercisec}\label{exc26}
    设 $F=(f_{ij})\in M_n(\mathbb{R})$ 是对称矩阵. 证明: $F$ 半正定 $\Leftrightarrow\exists A\in M_n(\mathbb{R}),F={}^tAA$.
\end{exercisec}
\begin{solution}
    ($\Rightarrow$) 由书上的推论 1\', $F$ 有分解式
    \[F={}^tA'\begin{pmatrix}
        E_r & 0 \\
        0 & 0 \\
    \end{pmatrix}A'={}^tA'\begin{pmatrix}
        E_r & 0 \\
        0 & 0 \\
    \end{pmatrix}\begin{pmatrix}
        E_r & 0 \\
        0 & 0 \\
    \end{pmatrix}A',\]

    其中 $A'=(a_{ij})\in GL_n(\mathbb{R})$. $\because$
    \[{}^t\begin{pmatrix}
        E_r & 0 \\
        0 & 0 \\
    \end{pmatrix}=\begin{pmatrix}
        E_r & 0 \\
        0 & 0 \\
    \end{pmatrix},\]

    $\therefore$ 设
    \[A=\begin{pmatrix}
        E_r & 0 \\
        0 & 0 \\
    \end{pmatrix}A',\]

    则
    \[{}^tA={}^tA'\begin{pmatrix}
        E_r & 0 \\
        0 & 0 \\
    \end{pmatrix},\quad F={}^tAA.\]

    ($\Leftarrow$) $\forall A\in M_n(\mathbb{R}),A$ 有分解式
    \[A=P\begin{pmatrix}
        E_r & 0 \\
        0 & 0 \\
    \end{pmatrix}Q,\]

    其中 $P,Q\in GL_n(\mathbb{R}).\therefore$
    \begin{align*}
        F & ={}^tAA \\
        & ={}^tQ\begin{pmatrix}
            E_r & 0 \\
            0 & 0 \\
        \end{pmatrix}{}^tPP\begin{pmatrix}
            E_r & 0 \\
            0 & 0 \\
        \end{pmatrix}Q \\
        & ={}^tQP\begin{pmatrix}
            E_r & 0 \\
            0 & 0 \\
        \end{pmatrix}\begin{pmatrix}
            E_r & 0 \\
            0 & 0 \\
        \end{pmatrix}{}^tPQ \\
        & ={}^t({}^tPQ)\begin{pmatrix}
            E_r & 0 \\
            0 & 0 \\
        \end{pmatrix}{}^tPQ,
    \end{align*}

    其中 ${}^tPQ\in GL_n(\mathbb{R}).\therefore F$ 是半正定的.
\end{solution}

% 证明补充题 \ref{exc1.7.6} 需要先证明一个引理.
% \begin{lemma}
%     $q$ 半正定当且仅当 $\forall$ 指标 $1\leq i_1<i_2<\cdots<i_k\leq n\ (1\leq k<n)$, $q$ 在 $V$ 的子空间 $\left<\boldsymbol{e}_{i_1},\boldsymbol{e}_{i_2},\cdots,\boldsymbol{e}_{i_k}\right>$ 上的限制 $\bar{q}_{i_1,i_2,\cdots,i_k}$ 半正定.
% \end{lemma}
% \begin{proof}
%     ($\Rightarrow$) $\forall\boldsymbol{x}\in\left<\boldsymbol{e}_{i_1},\boldsymbol{e}_{i_2},\cdots,\boldsymbol{e}_{i_k}\right>,\boldsymbol{x}\in V$.
    
%     $\because q$ 半正定, $\therefore\bar{q}_{i_1,i_2,\cdots,i_k}(\boldsymbol{x})=q(\boldsymbol{x})\geq0$, $\therefore\bar{q}_{i_1,i_2,\cdots,i_k}$ 半正定.

%     ($\Leftarrow$)
% \end{proof}
\begin{exercisec}[1.7.6]\label{exc1.7.6}
    设 $\boldsymbol{e}_1,\boldsymbol{e}_2,\cdots,\boldsymbol{e}_n$ 是 $V$ 的一个基, $V$ 上的实二次型 $q$ 在 $\boldsymbol{e}_1,\boldsymbol{e}_2,\cdots,\boldsymbol{e}_n$ 下的矩阵为 $A=(a_{ij})$. 证明 $q$ 是半正定的当且仅当 $\forall$ 指标 $1\leq i_1<i_2<\cdots<i_k\leq n\ (1\leq k\leq n)$, $A$ 的 $k$ 阶子式(见 [BAI] 第 3 章第 3 节的定义)
    \[M\begin{pmatrix}
        i_1,i_2,\cdots,i_k \\
        i_1,i_2,\cdots,i_k \\
    \end{pmatrix}\]
    非负.
\end{exercisec}
\begin{proof}
    ($\Rightarrow$) $\forall$ 指标 $1\leq i_1<i_2<\cdots<i_k\leq n$, 设 $q$ 在 $V$ 的子空间 $\left<\boldsymbol{e}_{i_1},\boldsymbol{e}_{i_2},\cdots,\boldsymbol{e}_{i_k}\right>$ 上的限制为 $\bar{q}_{i_1,i_2,\cdots,i_k}$.

    $\forall\boldsymbol{x}\in\left<\boldsymbol{e}_{i_1},\boldsymbol{e}_{i_2},\cdots,\boldsymbol{e}_{i_k}\right>,\boldsymbol{x}\in V$. $\because q$ 半正定, $\therefore\bar{q}_{i_1,i_2,\cdots,i_k}(\boldsymbol{x})=q(\boldsymbol{x})\geq0$, $\therefore\bar{q}_{i_1,i_2,\cdots,i_k}$ 半正定.
    
    由补充题 \ref{exc26} 得 $\exists B\in M_k(\mathbb{R})$ 使得 $\bar{q}_{i_1,i_2,\cdots,i_k}$ 在 $\boldsymbol{e}_{i_1},\boldsymbol{e}_{i_2},\cdots,\boldsymbol{e}_{i_k}$ 下的矩阵为 ${}^tBB$.

    $\because\exists B\in M_k(\mathbb{R})$ 使得 $\bar{q}_{i_1,i_2,\cdots,i_k}$ 在 $\boldsymbol{e}_{i_1},\boldsymbol{e}_{i_2},\cdots,\boldsymbol{e}_{i_k}$ 下的矩阵为 ${}^tBB$, $\therefore\bar{q}_{i_1,i_2,\cdots,i_k}$ 在 $\boldsymbol{e}_{i_1},\boldsymbol{e}_{i_2},\cdots,\boldsymbol{e}_{i_k}$ 下的矩阵的行列式
    \[M\begin{pmatrix}
        i_1,i_2,\cdots,i_k \\
        i_1,i_2,\cdots,i_k \\
    \end{pmatrix}=\det{}^tBB=\det{}^tB\det B=(\det B)^2\]
    非负.

    ($\Leftarrow$) 对 $n$ 用数学归纳法. $n=1$ 时的情形是显然的. 设命题对 $n-1$ 维向量空间成立.
    
    对 $n$ 维向量空间 $V=\left<\boldsymbol{e}_1,\boldsymbol{e}_2,\cdots,\boldsymbol{e}_n\right>$ 上的 $q$, $q$ 在 $U=\left<\boldsymbol{e}_1,\boldsymbol{e}_2,\cdots,\boldsymbol{e}_{n-1}\right>$ 上的限制 $\bar{q}$ 满足 $\forall$ 指标 $1\leq i_1<i_2<\cdots<i_k\leq n-1\ (1\leq k\leq n-1)$, $A$ 的 $k$ 阶子式
    $M\begin{pmatrix}
        i_1,i_2,\cdots,i_k \\
        i_1,i_2,\cdots,i_k \\
    \end{pmatrix}$
    非负.

    由归纳假定, $\bar{q}$ 半正定, $\therefore\exists U$ 的一个基 $\boldsymbol{u}_1,\boldsymbol{u}_2,\cdots,\boldsymbol{u}_{n-1}$ 使得 $\bar{q}$ 在这个基下的矩阵为
    \[\begin{pmatrix}
        E_r & 0 \\
        0 & 0 \\
    \end{pmatrix}.\]

    $\because V=\left<\boldsymbol{e}_n\right>\oplus\left<\boldsymbol{e}_1,\boldsymbol{e}_2,\cdots,\boldsymbol{e}_{n-1}\right>=\left<\boldsymbol{e}_n\right>\oplus\left<\boldsymbol{u}_1,\boldsymbol{u}_2,\cdots,\boldsymbol{u}_{n-1}\right>$, $\therefore\boldsymbol{u}_1,\boldsymbol{u}_2,\cdots,\boldsymbol{u}_{n-1},\boldsymbol{e}_n$ 是 $V$ 的一个基, $q$ 在这个基下的矩阵为
    \[A'=\begin{pmatrix}
        E_r & 0 & A_{1n} \\
        0 & 0 & A_{2n} \\
        {}^tA_{1n} & {}^tA_{2n} & a_{nn}' \\
    \end{pmatrix},\]

    其中 $A_{1n}$ 是 $r$ 行 $1$ 列向量, $A_{2n}$ 是 $n-r-1$ 行向量, 设
    \[[A_{1n},A_{2n}]=[a_1',a_2',\cdots,a_{n-1}'].\]

    $A'$ 的第 $t,n\ (r<t<n)$ 行第 $t,n$ 列交叉处的元素组成的矩阵的行列式为
    \[\begin{vmatrix}
        0 & a_{tn}' \\
        a_{tn}' & a_{nn}'
    \end{vmatrix}=-(a_{tn}')^2.\]

    由题得
    \begin{equation}\label{eq4.7}
        -(a_{tn}')^2\geq0\Rightarrow a_{tn}'=0,\forall t=r+1,r+2,\cdots,n-1.
    \end{equation}

    $A'$ 的第 $1,\cdots,r,n$ 行第 $1,\cdots,r,n$ 列交叉处的元素组成的矩阵的行列式为(下面的变换为行变换)
    \[\begin{vmatrix}
        1 & 0 & \cdots & 0 & a_{1n}' \\
        0 & 1 & \cdots & 0 & a_{2n}' \\
        \vdots & \vdots & \ddots & \vdots & \vdots \\
        0 & 0 & \cdots & 1 & a_{n-1,n}' \\
        a_{1n}' & a_{2n}' & \cdots & a_{n-1,n}' & a_{nn}' \\
    \end{vmatrix}\xrightarrow{F_{(n,i)}(-a_{in}')\ (i=1,2,\cdots,n-1)}\begin{vmatrix}
        1 & 0 & \cdots & 0 & a_{1n}' \\
        0 & 1 & \cdots & 0 & a_{2n}' \\
        \vdots & \vdots & \ddots & \vdots & \vdots \\
        0 & 0 & \cdots & 1 & a_{n-1,n}' \\
        0 & 0 & \cdots & 0 & a \\
    \end{vmatrix}=a,\]

    其中
    \[a=a_{nn}'-(a_{1n}')^2-(a_{2n}')^2-\cdots-(a_{nn}')^2.\]

    由题得
    \begin{equation}\label{eq4.8}
        a\geq0\Rightarrow a_{nn}'\geq(a_{1n}')^2+(a_{2n}')^2+\cdots+(a_{nn}')^2.
    \end{equation}

    $\forall\boldsymbol{x}=x_1\boldsymbol{u}_1+\cdots+x_{n-1}\boldsymbol{u}_{n-1}+x_n\boldsymbol{e}_n\in V$, 设 $X=[x_1,x_2,\cdots,x_n]$, 则
    \begin{align*}
        q(\boldsymbol{x}) & ={}^tXA'X \\
        & =x^2_1+x^2_2+\cdots+x^2_r+a_{nn}'x_n^2+2a_{1n}'x_1x_n+2a_{2n}'x_2x_n+\cdots+2a_{n-1,n}'x_{n-1}x_n.
    \end{align*}

    由式 (\ref{eq4.7}) 得
    \[q(\boldsymbol{x})=x^2_1+x^2_2+\cdots+x^2_r+a_{nn}'x_n^2+2a_{1n}'x_1x_n+2a_{2n}'x_2x_n+\cdots+2a_{rn}'x_rx_n.\]

    由式 (\ref{eq4.8}) 得
    \begin{align*}
        q(\boldsymbol{x}) & \geq x^2_1+x^2_2+\cdots+x^2_r+((a_{1n}')^2+(a_{2n}')^2+\cdots+(a_{nn}')^2)x_n^2 \\
        & \quad+2a_{1n}'x_1x_n+2a_{2n}'x_2x_n+\cdots+2a_{rn}'x_rx_n \\
        & =(x^2_1+2a_{1n}'x_1x_n+(a_{1n}')^2x_n^2)+(x^2_2+2a_{2n}'x_2x_n+(a_{2n}')^2x_n^2) \\
        & \quad+\cdots+(x^2_r+2a_{rn}'x_rx_n+(a_{nn}')^2x_n^2) \\
        & =(x_1+a_{1n}'x_n)^2+(x_2+a_{2n}'x_n)^2+\cdots+(x_r+a_{rn}'x_n)^2\geq0.
    \end{align*}

    $\therefore q$ 是半正定的.
\end{proof}
\begin{note}
    下面的 \verb|subMat[mat_, xInd_, yInd_]| 可以生成矩阵 \verb|mat| 的第 \verb|xInd| 行第 \verb|yInd| 列交叉处的元素组成的矩阵, 计算子式:
    \begin{lstlisting}
subMat[mat_, xInd_, yInd_] := 
  If[mat != {} && xInd != {} && yInd != {},
    {MatrixForm[mat[[xInd, yInd]]], Det[mat[[xInd, yInd]]]},
    Nothing];
    \end{lstlisting}
    
    用下面的代码生成随机的半正定矩阵 $F={}^tA\diag(1,\cdots,1,0,\cdots,0)A$, 计算 $\Delta_i$:
    \begin{lstlisting}
        size = 4; (*矩阵的阶*)
        rank = 3; (*矩阵的秩*)
        lb = -2; (*随机数下限*)
        ub = 2; (*随机数上限*)

        (*生成满秩的随机矩阵*)
        A = Array[RandomInteger[{lb, ub}] &, {size, size}];
        While[MatrixRank[A] < size, 
         A = Array[RandomInteger[{lb, ub}] &, {size, size}];]

        (*随机的半正定矩阵*)
        F = Transpose[A] . DiagonalMatrix[Array[1 &, rank], 0, size] . A;

        (*主子式*)
        Array[subMat[F, Range[#], Range[#]] &, Length[F]]
    \end{lstlisting}

    下面的代码输出 $F$ 的所有子式, 格式为 \{\{子阵,子式\},选取的行\}:
    \begin{lstlisting}
    {subMat[F, #, #], #} & /@
      Union[
       ReplaceList[
        Range[Length[F]],
        {{x___, y___, z___, u___, v___} :> {x, z, v},
         {x___, y___, z___, u___, v___} :> {y, u}}]]
    \end{lstlisting}
\end{note}
\subsubsection{斜对称双线性型}
\begin{exercisec}[1.7.11]\label{exc1.7.11}
    设 $\charop K\neq 2,A\in M_n(K)$. 证明: $A=(a_{ij})$ 斜对称当且仅当
    \[{}^tXAX=0,\quad\forall X=[x_1,x_2,\cdots,x_n].\]
\end{exercisec}
\begin{proof}
    设 $f_A$ 是 $V$ 上的双线性型, $f_A$ 在 $V$ 的基 $\boldsymbol{e}_i$ 下的矩阵为 $A$. 与性质 \ref{p3.1} 类似, $A$ 斜对称 $\Leftrightarrow f_A$ 斜对称.

    $(\Rightarrow)f_A$ 斜对称 $\Rightarrow\forall\boldsymbol{x}\in V,f(\boldsymbol{x},\boldsymbol{x})=-f(\boldsymbol{x},\boldsymbol{x})\Rightarrow f(\boldsymbol{x},\boldsymbol{x})=0.\because$
    \[\begin{array}{rcl}
        V & \to & K^n \\
        \boldsymbol{x}=x_1\boldsymbol{e}_1+x_2\boldsymbol{e}_2+\cdots+x_n\boldsymbol{e}_n & \to & [x_1,x_2,\cdots,x_n] \\
    \end{array}\]

    是同构, $\therefore\forall X\in K^n,\exists\boldsymbol{x}\in V$ 使得 $f(\boldsymbol{x},\boldsymbol{x})={}^tXAX$.

    $\because f(\boldsymbol{x},\boldsymbol{x})=0,\therefore{}^tXAX=0$.

    ($\Leftarrow$) 设 $A=(a_{ij}),X_i=[0,\cdots,0,1(\text{第}i\text{个}),0,\cdots,0]$. 则 $a_{ii}={}^tX_iAX_i=0$. 有
    \[a_{ii}+a_{ij}+a_{ji}+a_{jj}=({}^tX_i+{}^tX_j)A(X_i+X_j)=0.\]

    $\because a_{ii}=a_{jj}=0,\therefore a_{ij}+a_{ji}=0.\therefore A$ 是斜对称的.
\end{proof}
\begin{exercisec}[1.7.13]
    设 $A$ 是 $n$ 阶斜对称实方阵, $E$ 是 $n$ 阶单位矩阵, $\lambda\in\mathbb{C}$. 证明: 如果 $\det(\lambda E-A)=0$, 那么 $\re\lambda=0$.
\end{exercisec}
\begin{proof}
    如果 $\lambda=0$, 那么显然有 $\re\lambda=0$. 下面设 $\lambda\neq0$.

    (a) 如果 $A$ 是标准形式, 则
    \[\lambda E-A=\begin{pmatrix}
        \lambda  & 1 & 0  & 0 &&& \cdots &&& 0 \\
        -1 & \lambda & 0  & 0 &&& \cdots &&& 0 \\
        0  & 0 & \lambda  & 1 &&& \cdots &&& 0 \\
        0  & 0 & -1 & \lambda &&& \cdots &&& 0 \\
        &&& \ddots & \ddots \\
        &&&& \lambda  & 1 & 0 & 0 \\
        &&&& -1 & \lambda & 0 & 0 \\
        &&&& 0  & 0 & \lambda & 0 \\
        &&&& 0  & 0 & 0 & \lambda \\
        &&&&&&& \ddots & \ddots \\
        &&&&&&&& \lambda & 0 \\
        &&&&&&&& 0 & \lambda \\
    \end{pmatrix}.\]

    反复按前两行前两列展开, 得
    \begin{align*}
        \det(\lambda E-A) & =\begin{vmatrix}
            \lambda  & 1 \\
            -1 & \lambda \\
        \end{vmatrix}\cdot\begin{vmatrix}
            \lambda  & 1 & 0  & 0 &&& \cdots &&& 0 \\
            -1 & \lambda & 0  & 0 &&& \cdots &&& 0 \\
            0  & 0 & \lambda  & 1 &&& \cdots &&& 0 \\
            0  & 0 & -1 & \lambda &&& \cdots &&& 0 \\
            &&& \ddots & \ddots \\
            &&&& \lambda  & 1 & 0 & 0 \\
            &&&& -1 & \lambda & 0 & 0 \\
            &&&& 0  & 0 & \lambda & 0 \\
            &&&& 0  & 0 & 0 & \lambda \\
            &&&&&&& \ddots & \ddots \\
            &&&&&&&& \lambda & 0 \\
            &&&&&&&& 0 & \lambda \\
        \end{vmatrix} \\
        & =\begin{vmatrix}
            \lambda  & 1 \\
            -1 & \lambda \\
        \end{vmatrix}^2\cdot\begin{vmatrix}
            \lambda  & 1 & 0  & 0 &&& \cdots &&& 0 \\
            -1 & \lambda & 0  & 0 &&& \cdots &&& 0 \\
            0  & 0 & \lambda  & 1 &&& \cdots &&& 0 \\
            0  & 0 & -1 & \lambda &&& \cdots &&& 0 \\
            &&& \ddots & \ddots \\
            &&&& \lambda  & 1 & 0 & 0 \\
            &&&& -1 & \lambda & 0 & 0 \\
            &&&& 0  & 0 & \lambda & 0 \\
            &&&& 0  & 0 & 0 & \lambda \\
            &&&&&&& \ddots & \ddots \\
            &&&&&&&& \lambda & 0 \\
            &&&&&&&& 0 & \lambda \\
        \end{vmatrix} \\
        & =\cdots \\
        & =\begin{vmatrix}
            \lambda  & 1 \\
            -1 & \lambda \\
        \end{vmatrix}^r\cdot|\diag(\underbrace{\lambda,\cdots,\lambda}_{n-2r\text{个}\lambda})|=(\lambda^2+1)^r\lambda^{n-2r}.
    \end{align*}

    $\because\lambda\neq0,\det(\lambda E-A)=0$, $\therefore(\lambda^2+1)^r=0\Rightarrow\lambda^2+1=0\Rightarrow\lambda=i$.

    (b)
\end{proof}
\begin{exercisec}
    把 $f(\boldsymbol{x},\boldsymbol{y})=x_1y_3-y_1x_3+x_1y_2-y_1x_2+x_2y_3-y_2x_3+x_2y_4-y_2x_4$ 化为标准型.
\end{exercisec}
\begin{solution}
    \[f(\boldsymbol{x},\boldsymbol{y})=x_1(y_3+y_2)-y_1(x_3+x_2)+x_2y_3-y_2x_3+x_2y_4-y_2x_4.\]

    令 $y_2'=y_3+y_2,x_2'=x_3+x_2$, 则 $y_2=y_2'-y_3,x_2=x_2'-x_3$,
    \begin{align*}
        f(\boldsymbol{x},\boldsymbol{y}) & =x_1y_2'-y_1x_2'+(x_2'-x_3)y_3-(y_2'-y_3)x_3+(x_2'-x_3)y_4-(y_2'-y_3)x_4 \\
        & =(x_1-x_3-x_4)y_2'-(y_1-y_3-y_4)x_2'-x_3y_3+y_3x_3-x_3y_4+y_3x_4.
    \end{align*}

    令 $y_1'=y_1-y_3-y_4,x_1'=x_1-x_3-x_4$, 则
    \[f(\boldsymbol{x},\boldsymbol{y})=x_1'y_2'-y_1'x_2'-x_3(y_3+y_4)+y_3(x_3+x_4).\]

    令 $y'_3=-y_3,x'_3=-x_3,y'_4=y_3+y_4,x'_4=x_3+x_4$, 则
    \[f(\boldsymbol{x},\boldsymbol{y})=x_1'y_2'-y_1'x_2'+x_3'y_4'-y_3'x_4'.\]
\end{solution}
\begin{exercisec}
    设 $f$ 是非退化, 斜对称的双线性型, $F'=(f_{ij})\in M_n(\mathbb{R})$ 斜对称, 证明:
    
    $\exists\boldsymbol{v}_1,\boldsymbol{v}_2,\cdots,\boldsymbol{v}_n$ 使得 $f_{ij}=f(\boldsymbol{v}_i,\boldsymbol{v}_j)$.
\end{exercisec}
\begin{proof}
    取 $V$ 的一个基 $(\boldsymbol{e}_i)$, 设 $f$ 在 $(\boldsymbol{e}_i)$ 下的矩阵为 $F$, 则 $F$ 非退化. 由书上定理 9 的推论, $\exists A,B\in GL _n(K)$ 使得
    \[{}^tAFA={}^tBF'B=J.\]

    $\because A,B$ 非退化, $\therefore AB^{-1}$ 非退化, 有
    \[{}^t(AB^{-1})F(AB^{-1})=F'.\]

    由书上的定理 1, 设
    \[(\boldsymbol{v}_1,\boldsymbol{v}_2,\cdots,\boldsymbol{v}_n)=(\boldsymbol{e}_1,\boldsymbol{e}_2,\cdots,\boldsymbol{e}_n)AB^{-1},\]

    则 $F'$ 是 $f$ 在基 $\boldsymbol{v}_1,\boldsymbol{v}_2,\cdots,\boldsymbol{v}_n$ 下的矩阵. $\therefore f_{ij}=f(\boldsymbol{v}_i,\boldsymbol{v}_j)$.
\end{proof}
\end{document}