% TODO:
% 习题 2.9(2)
% 习题 2.11 的证明需要简化
% 习题 3.2, 3.6, 3.9, 3.10
% 一些例子的引用需要改一下

\documentclass{ctexart}
\usepackage{lecturenote}
\title{第2章笔记和习题}

\begin{document}
\maketitle
在这章中, 不加说明的话, $V$ 一律为域 $K$ 上的 $n$ 维线性空间, $W$ 一律为域 $K$ 上的 $m$ 维线性空间.
\section{线性映射(对应第 1 节)}
与第 1 章笔记的定理 2.1 类似, 有
\begin{theorem}\label{t1.1}
    给定 $V$ 的一个基 $\boldsymbol{e}_1,\boldsymbol{e}_2,\cdots,\boldsymbol{e}_n$, 则
    \[\phi:\begin{array}{rcl}
        \mathcal{L}(V,W) & \to & V^n \\
        f & \to & (f(\boldsymbol{e}_1),f(\boldsymbol{e}_2),\cdots,f(\boldsymbol{e}_n)) \\
    \end{array}\]
    是双射.
\end{theorem}
\begin{proof}
    若 $f(\boldsymbol{e}_i)=\boldsymbol{0}$, 则 $\forall\boldsymbol{x}=\lambda_1\boldsymbol{e}_1+\cdots+\lambda_n\boldsymbol{e}_n,f(\boldsymbol{x})=\lambda_1\boldsymbol{0}+\cdots+\lambda_n\boldsymbol{0}=\boldsymbol{0}$, 即 $\ker\phi=\{\boldsymbol{0}\}.\therefore\phi$ 是单射.

    $\forall(\boldsymbol{a}_1,\boldsymbol{a}_2,\cdots,\boldsymbol{a}_n)\in V^n,$ 定义 $f\in A$ 满足 $f(\lambda_1\boldsymbol{e}_1+\cdots+\lambda_n\boldsymbol{e}_n)=\lambda_1\boldsymbol{a}_1+\cdots+\lambda_n\boldsymbol{a}_n$, 则 $f(\boldsymbol{e}_i)=\boldsymbol{a}_i\Rightarrow\phi(f)=(\boldsymbol{a}_1,\boldsymbol{a}_2,\cdots,\boldsymbol{a}_n)$.

    与第 1 章笔记的定理 2.1 类似, 可以验证 $f\in\mathcal{L}(V,W).\therefore\phi$ 是满射.
\end{proof}

对 $f,g\in\mathcal{L}(V,W),\boldsymbol{v}\in V,\alpha,\beta\in K$, 定义
\[(\alpha f+\beta g)(\boldsymbol{v})=\alpha f(\boldsymbol{v})+\beta g(\boldsymbol{v}).\]

容易验证: $\mathcal{L}(V,W)$ 是线性空间(由 $W$ 是线性空间得).

可以用矩阵描述 $f\in\mathcal{L}(V,W)$. 设 $\boldsymbol{v}_1,\boldsymbol{v}_2,\cdots,\boldsymbol{v}_n$ 是 $V$ 的一个基, $\boldsymbol{w}_1,\boldsymbol{w}_2,\cdots,\boldsymbol{w}_m$ 是 $W$ 的一个基, 且
\begin{equation}\label{eq1.1}
    (f(\boldsymbol{v}_1),f(\boldsymbol{v}_2),\cdots,f(\boldsymbol{v}_n))=(\boldsymbol{w}_1,\boldsymbol{w}_2,\cdots,\boldsymbol{w}_m)\begin{pmatrix}
        a_{11} & a_{12} & \cdots & a_{1n} \\
        a_{21} & a_{22} & \cdots & a_{2n} \\
        \vdots & \vdots & \ddots & \vdots \\
        a_{m1} & a_{m2} & \cdots & a_{mn} \\
    \end{pmatrix}
\end{equation}

设 $A_f=(a_{ij}),\boldsymbol{v}\in V$ 在基 $(\boldsymbol{v}_i)$ 下的坐标为 $(x_1,x_2,\cdots,x_n)$, 则
\[\boldsymbol{v}=(\boldsymbol{v}_1,\boldsymbol{v}_2,\cdots,\boldsymbol{v}_n)\begin{pmatrix}
    x_1 \\
    x_2 \\
    \vdots \\
    x_n \\
\end{pmatrix},\]

由线性映射的性质,
\[f(\boldsymbol{v})=(f(\boldsymbol{v}_1),f(\boldsymbol{v}_2),\cdots,f(\boldsymbol{v}_n))\begin{pmatrix}
    x_1 \\
    x_2 \\
    \vdots \\
    x_n \\
\end{pmatrix}=(\boldsymbol{w}_1,\boldsymbol{w}_2,\cdots,\boldsymbol{w}_m)A_f\begin{pmatrix}
    x_1 \\
    x_2 \\
    \vdots \\
    x_n \\
\end{pmatrix}\]

$\therefore f(\boldsymbol{v})$ 在基 $(\boldsymbol{w}_i)$ 下的坐标为
\[A_f\begin{pmatrix}
    x_1 \\
    x_2 \\
    \vdots \\
    x_n \\
\end{pmatrix}.\]

与线性函数类似, 可以证明:
\begin{theorem}[书上的定理 2(i)]\label{t1.2}
    给定 $V$ 的一个基 $\boldsymbol{v}_1,\boldsymbol{v}_2,\cdots,\boldsymbol{v}_n$ 和 $W$ 的一个基 $\boldsymbol{w}_1,\boldsymbol{w}_2,\cdots,\boldsymbol{w}_m$, 按照式 (\ref{eq1.1}) 定义 $A_f=(a_{ij})$, 则
    \[\phi:\begin{array}{rcl}
        \mathcal{L}(V,W) & \to & M_{m,n}(K) \\
        f & \to & A_f \\
    \end{array}\]

    是线性空间的同构.
\end{theorem}
\begin{proof}
    设 $f,g\in\mathcal{L}(V,W),A_f=(a_{ij}),A_g=(b_{ij})$, 则
    \begin{align*}
        (\alpha f+\beta g)(\boldsymbol{v}_j) & =\alpha f(\boldsymbol{v}_j)+\beta g(\boldsymbol{v}_j) \\
        & =\alpha\left(\sum\limits_{i=1}^ma_{ij}\boldsymbol{w}_i\right)+\beta\left(\sum\limits_{i=1}^mb_{ij}\boldsymbol{w}_i\right) \\
        & =\sum\limits_{i=1}^m(\alpha a_{ij}+\beta b_{ij})\boldsymbol{w}_i,
    \end{align*}
    
    $\therefore A_{\alpha f+\beta g}$ 的 $i,j$ 元为 $\alpha a_{ij}+\beta b_{ij}.\therefore A_{\alpha f+\beta g}=\alpha A_f+\beta A_g,\therefore\phi(\alpha f+\beta g)=\alpha\phi(f)+\beta\phi(g)$.

    $\because A_f=0\Rightarrow\forall i,j,a_{ij}=0\Rightarrow\forall j,f(\boldsymbol{v}_j)=0\Rightarrow\forall\boldsymbol{v}\in V,f(\boldsymbol{v})=\boldsymbol{0}\Rightarrow f=\boldsymbol{0}$,

    $\therefore\ker\phi=\{\boldsymbol{0}\},\phi$ 是单射.

    对 $A=(a_{ij})\in M_{m,n}(k)$, 对 $\boldsymbol{v}=x_1\boldsymbol{v}_1+x_2\boldsymbol{v}_2+\cdots+x_n\boldsymbol{v}_n$, 由式
    \[f(\boldsymbol{v})=(\boldsymbol{w}_1,\boldsymbol{w}_2,\cdots,\boldsymbol{w}_m)A_f\begin{pmatrix}
        x_1 \\
        x_2 \\
        \vdots \\
        x_n \\
    \end{pmatrix}\]
    定义 $f$, 则
    \[f(\boldsymbol{v}_i)=(\boldsymbol{w}_1,\boldsymbol{w}_2,\cdots,\boldsymbol{w}_m)\begin{pmatrix}
        a_{1i} \\
        a_{2i} \\
        \vdots \\
        a_{ni} \\
    \end{pmatrix},\]

    $\therefore\phi(f)=A_f$. 设 $\alpha,\beta\in K,\boldsymbol{v}'=x_1'\boldsymbol{v}_1+x_2'\boldsymbol{v}_2+\cdots+x_n'\boldsymbol{v}_n$, 则
    \[\alpha\boldsymbol{v}+\beta\boldsymbol{v}'=(\alpha x_1+\beta x_1')\boldsymbol{v}_1+(\alpha x_2+\beta x_2')\boldsymbol{v}_2+\cdots+(\alpha x_n+\beta x_n')\boldsymbol{v}_n,\]
    \begin{align*}
        f(\alpha\boldsymbol{v}+\beta\boldsymbol{v}') & =(\boldsymbol{w}_1,\boldsymbol{w}_2,\cdots,\boldsymbol{w}_m)A_f\begin{pmatrix}
            \alpha x_1+\beta x_1' \\
            \alpha x_2+\beta x_2' \\
            \vdots \\
            \alpha x_n+\beta x_n' \\
        \end{pmatrix} \\
        & =(\boldsymbol{w}_1,\boldsymbol{w}_2,\cdots,\boldsymbol{w}_m)A_f\begin{pmatrix}
            \alpha x_1 \\
            \alpha x_2 \\
            \vdots \\
            \alpha x_n \\
        \end{pmatrix}+(\boldsymbol{w}_1,\boldsymbol{w}_2,\cdots,\boldsymbol{w}_m)A_f\begin{pmatrix}
            \beta x_1' \\
            \beta x_2' \\
            \vdots \\
            \beta x_n' \\
        \end{pmatrix} \\
        & =\alpha f(\boldsymbol{v})+\beta f(\boldsymbol{v}'),
    \end{align*}

    $\therefore f\in\mathcal{L}(V,W).\therefore\phi$ 是满射.
\end{proof}

下面的交换图表示了各个线性空间之间的关系(左边的图中的空间中的元素在右边的图对应的位置上):
\[\begin{CD}
    V @>f>> W \\
    @V\eta_v VV @V\eta_w VV \\
    K^n @>f'>> K^m
\end{CD}\qquad
\begin{CD}
    \sum\limits_{i=1}^nx_i\boldsymbol{v}_i @>f>> \sum\limits_{j=1}^nx_j\sum\limits_{i=1}^na_{ij}\boldsymbol{w}_i \\
    @V\eta_v VV @V\eta_w VV \\
    [x_1,\cdots,x_n] @>f'>> A_f[x_1,\cdots,x_n]
\end{CD}\]

其中 $\eta_v,\eta_w$ 是同构. 由上图得
\[\eta_w\circ f=f'\circ\eta_v\Rightarrow\ker(\eta_w\circ f)=\ker(f'\circ\eta_v),\quad\operatorname{Im}(\eta_w\circ f)=\operatorname{Im}(f'\circ\eta_v).\]

$\because\eta_w$ 是单射, $\therefore\ker\eta_w=\{\boldsymbol{0}\},\therefore\ker(\eta_w\circ f)=\ker f,\therefore\ker(f'\circ\eta_v)=\ker f$.

$\because\ker(f'\circ\eta_v)=\{\boldsymbol{x}\in V|\eta_v(\boldsymbol{x})\in\ker f'\},\therefore$
\[\eta_v(\ker(f'\circ\eta_v))=\{\eta_v(\boldsymbol{x})\in\operatorname{Im}\eta_v|\eta_v(\boldsymbol{x})\in\ker f'\}.\]

$\because\eta_v$ 是满射, $\therefore\operatorname{Im}\eta_v=K^n,\therefore\eta_v(\ker(f'\circ\eta_v))=\ker f',\therefore\eta_v(\ker f)=\ker f'$.

有 $\eta_w(\operatorname{Im}f)=\operatorname{Im}(\eta_w\circ f)=\operatorname{Im}(f'\circ\eta_v).\because\eta_v$ 是满射, $\therefore\operatorname{Im}(f'\circ\eta_v)=f'(\operatorname{Im}\eta_v)=\operatorname{Im}f'$.

$\because\eta_w,\eta_v$ 是同构, $\therefore$
\[\dim\ker f=\dim\eta_v(\ker f)=\dim\ker f',\]
\begin{equation}\label{eq1.2}
    \dim\operatorname{Im}f=\dim\eta_w(\operatorname{Im}f)=\dim\operatorname{Im}f'.
\end{equation}

可以用比较简单(但没有那么深刻)的方法得到上述结论.

设 $\boldsymbol{x}_i=f(\boldsymbol{v}_i)$, 则
\[f(y_1\boldsymbol{v}_1+y_2\boldsymbol{v}_2+\cdots+y_n\boldsymbol{v}_n)=y_1\boldsymbol{x}_1+y_2\boldsymbol{x}_2+\cdots+y_n\boldsymbol{x}_n.\]

$\therefore\eta_v(\ker f)$ 为关于 $y_i$ 的方程
\begin{equation}\label{eq1.3}
    y_1\boldsymbol{x}_1+y_2\boldsymbol{x}_2+\cdots+y_n\boldsymbol{x}_n=\boldsymbol{0}
\end{equation}

的解空间. 有
\begin{align*}
    & \ y_1\boldsymbol{x}_1+y_2\boldsymbol{x}_2+\cdots+y_n\boldsymbol{x}_n=\boldsymbol{0} \\
    \Rightarrow & \ y_1\boldsymbol{x}_1+y_2\boldsymbol{x}_2+\cdots+y_n\boldsymbol{x}_n=\boldsymbol{0} \\
    \Rightarrow & \ \sum\limits_{j=1}^ny_j\sum\limits_{i=1}^ma_{ij}\boldsymbol{w}_i=\boldsymbol{0}.
\end{align*}

$\because\boldsymbol{w}_i$ 线性无关, $\therefore$ 方程组 (\ref{eq1.3}) 等价于方程组
\[\sum\limits_{j=1}^ny_ja_{ij}=0,\quad i=1,2,\cdots,m.\]

上述方程组的系数矩阵为 $A_f,\therefore$ 方程组的解空间为 $\ker f'.\therefore\eta_v(\ker f)=\ker f'$.

可以直接从 $\dim\ker f'=n-\operatorname{rank}A_f=n-\dim\operatorname{Im}f'$ 以及书上的定理 4 得到 $\dim\operatorname{Im}f'=\dim\operatorname{Im}f$, 下面采用另一种证明方法.

$\because f(\boldsymbol{v}_j)=a_{1j}\boldsymbol{w}_1+a_{2j}\boldsymbol{w}_2+\cdots+a_{mj}\boldsymbol{w}_m,\therefore\eta_w(f(\boldsymbol{v}_j))=[a_{1j},a_{2j},\cdots,a_{mj}]=A^{j}$.

$\because\operatorname{Im}f=\left<f(\boldsymbol{v}_1),f(\boldsymbol{v}_2),\cdots,f(\boldsymbol{v}_n)\right>,\therefore\operatorname{Im}f$ 在 $\eta_w$ 下的像 $\eta_w(\operatorname{Im}f)=\left<A^{1},A^{2},\cdots,A^{n}\right>$ 为 $A_f$ 的列空间.

$\therefore\operatorname{rank}A_f=\dim\operatorname{Im}f$.
\section{线性算子(对应第 2 节)}
\subsection{线性算子代数}
作为定理 \ref{t1.2} 的一个特殊情况, 有:
\begin{theorem}\label{t2.1}
    给定 $V$ 的一个基 $\boldsymbol{e}_1,\boldsymbol{e}_2,\cdots,\boldsymbol{e}_n$, 按照
    \begin{align*}
        \mathcal{A}(\boldsymbol{e}_1,\boldsymbol{e}_2,\cdots,\boldsymbol{e}_n) & :=(\mathcal{A}(\boldsymbol{e}_1),\mathcal{A}(\boldsymbol{e}_2),\cdots,\mathcal{A}(\boldsymbol{e}_n)) \\
        & =(\boldsymbol{e}_1,\boldsymbol{e}_2,\cdots,\boldsymbol{e}_n)\begin{pmatrix}
            a_{11} & a_{12} & \cdots & a_{1n} \\
            a_{21} & a_{22} & \cdots & a_{2n} \\
            \vdots & \vdots & \ddots & \vdots \\
            a_{n1} & a_{n2} & \cdots & a_{nn} \\
        \end{pmatrix}
    \end{align*}

    定义 $A_\mathcal{A}=(a_{ij})$, 则
    \[\phi:\begin{array}{rcl}
        \mathcal{L}(V) & \to & M_n(K) \\
        \mathcal{A} & \to & A_\mathcal{A} \\
    \end{array}\]
    是线性空间的同构.
\end{theorem}
设 $\mathcal{A}\in\mathcal{L}(V)$, 一般来说没有 $V=\ker\mathcal{A}+\operatorname{Im}A$, 但是有:
\begin{example}\label{exa2.1}
    设 $\mathcal{A}\in\mathcal{L}(V)$, 若 $\mathcal{A}^2=\mathcal{A}$, 则 $V=\ker\mathcal{A}\oplus\operatorname{Im}\mathcal{A}$.
\end{example}
\begin{proof}
    设 $\boldsymbol{x}\in V$. 为了方便, 将 $\mathcal{A}(\boldsymbol{x})$ 简写为 $\mathcal{A}\boldsymbol{x}$.

    设 $\boldsymbol{y}=\mathcal{A}\boldsymbol{x}$, 有 $\boldsymbol{y}=\mathcal{A}\boldsymbol{x}=\mathcal{A}^2\boldsymbol{x}=\mathcal{A}(\mathcal{A}\boldsymbol{x})=\mathcal{A}\boldsymbol{y}.\therefore\boldsymbol{y}\in\ker\mathcal{A}$ 当且仅当 $\mathcal{A}\boldsymbol{y}=\boldsymbol{y}=\boldsymbol{0}$.

    $\therefore\ker\mathcal{A}\cap\operatorname{Im}\mathcal{A}=\{0\}=\ker\mathcal{A}$.

    $\because\dim\ker\mathcal{A}+\dim\operatorname{Im}\mathcal{A}=n,\therefore V=\ker\mathcal{A}\oplus\operatorname{Im}\mathcal{A}$.
\end{proof}
\begin{note}
    (1) 称 $\boldsymbol{y}$ 是 $\mathcal{A}$ 的一个\textbf{不动点}.

    (2) 若 $\mathcal{A}\neq\mathcal{E},\mathcal{O}$, 则 $\mathcal{A}$ 的极小多项式为 $t^2-t$.
\end{note}
采用同态的观点([BAI] 第 5 章第 2 节定理 3)来考察 $K[\mathcal{A}]$. 设
\[\phi:\begin{array}{rcl}
    K[t] & \to & \mathcal{L}(V) \\
    f(t) & \to & f(A) \\
\end{array},\]

则 $\operatorname{Im}\phi=K[\mathcal{A}].\because\operatorname{Im}\phi\subset\mathcal{L}(V),\therefore\dim\operatorname{Im}\phi\leq\dim\mathcal{L}(V)=n^2$.

然而 $K[t]$ 是无限维的. $\therefore\ker\phi\neq\{0\}$, 即 $\mathcal{A}$ 一定有零化多项式. 事实上, 由书上的定理 2, 有
\[\ker\phi=\{\mu_\mathcal{A}(t)g(t)|g(t)\in K[t]\}.\]

这是 $\phi$ 的主理想.
\begin{theorem}
    $\deg\mu_\mathcal{A}=\dim K[\mathcal{A}]$.
\end{theorem}
\begin{proof}
    设
    \[\mu_\mathcal{A}(t)=t^m+a_1t^{m-1}+a_2t^{m-2}+\cdots+a_m,\]

    则
    \[\mathcal{A}^m=-a_1\mathcal{A}^{m-1}-a_2\mathcal{A}^{m-2}-\cdots-a_m\mathcal{E},\]
    \begin{align*}
        \mathcal{A}^{m+1} & =-a_1\mathcal{A}^{m}-a_2\mathcal{A}^{m-1}-\cdots-a_m\mathcal{A} \\
        & =-a_1(-a_1\mathcal{A}^{m-1}-a_2\mathcal{A}^{m-2}-\cdots-a_m\mathcal{E})-a_2\mathcal{A}^{m-1}-\cdots-a_m\mathcal{A},
    \end{align*}
    \begin{align*}
        \mathcal{A}^{m+2} & =-a_1\mathcal{A}^{m+1}-a_2\mathcal{A}^m-\cdots-a_m\mathcal{A}^2 \\
        & =-a_1(-a_1(-a_1\mathcal{A}^{m-1}-a_2\mathcal{A}^{m-2}-\cdots-a_m\mathcal{E})-a_2\mathcal{A}^{m-1}-\cdots-a_m\mathcal{A}) \\
        & -a_2(-a_1\mathcal{A}^{m-1}-a_2\mathcal{A}^{m-2}-\cdots-a_m\mathcal{E})-\cdots-a_m\mathcal{A^2},
    \end{align*}
    \[\cdots\]

    $\therefore\forall k>m-1,\mathcal{A}^k$ 可以由 $\mathcal{E},\mathcal{A},\cdots,\mathcal{A}^{m-1}$ 线性表示.

    $\therefore$
    \[K[\mathcal{A}]=\left<\mathcal{A}^k|k\in\mathbb{Z}\right>=\left<\mathcal{E},\mathcal{A},\cdots,\mathcal{A}^{m-1}\right>.\]

    由书上定理 1 前面的讨论得 $\mathcal{E},\mathcal{A},\cdots,\mathcal{A}^{m-1}$ 线性无关, $\therefore\mathcal{E},\mathcal{A},\cdots,\mathcal{A}^{m-1}$ 是 $K[\mathcal{A}]$ 的一个基. $\therefore\deg\mu_\mathcal{A}=m=\dim K[\mathcal{A}]$.
\end{proof}
举一个零化多项式的例子.
\begin{example}\label{ex2.2}
    设 $V$ 是域 $K$ 上次数 $\leq n-1$ 的多项式全体, $\mathcal{A}:f(t)\to\dfrac{\mathrm{d}f}{\mathrm{d}t}$. $\because\forall f\in V,\mathcal{A}^{\deg f-1}f\neq0,\mathcal{A}^{\deg f}f=0$, $\therefore\mathcal{A}$ 的零化多项式为 $t^n$.
\end{example}
在第 4 节中我们还会遇到这个例子.
\subsection{矩阵的相似}
\begin{theorem}[书上的定理 3]\label{t2.3}
    设 $(\boldsymbol{e}_i),(\boldsymbol{e}_i')$ 分别是 $V$ 的基, $\mathcal{A}\in\mathcal{L}(V)$ 在 $(\boldsymbol{e}_i)$ 下的矩阵为 $A$, 在 $(\boldsymbol{e}_i')$ 下的矩阵为 $A'$. 设 $B$ 是 $(\boldsymbol{e}_i)$ 到 $(\boldsymbol{e}_i')$ 的转换矩阵, 则
    \[A'=B^{-1}AB.\]
\end{theorem}
\begin{proof}
    由定理 \ref{t2.1} 中的定义,
    \[\mathcal{A}(\boldsymbol{e}_1,\boldsymbol{e}_2,\cdots,\boldsymbol{e}_n)=(\boldsymbol{e}_1,\boldsymbol{e}_2,\cdots,\boldsymbol{e}_n)A,\quad\mathcal{A}(\boldsymbol{e}_1',\boldsymbol{e}_2',\cdots,\boldsymbol{e}_n')=(\boldsymbol{e}_1',\boldsymbol{e}_2',\cdots,\boldsymbol{e}_n')A'.\]

    $\therefore$
    \[\mathcal{A}(\boldsymbol{e}_1',\boldsymbol{e}_2',\cdots,\boldsymbol{e}_n')=\mathcal{A}((\boldsymbol{e}_1,\boldsymbol{e}_2,\cdots,\boldsymbol{e}_n)B).\]

    设
    \[(\boldsymbol{x}_1,\boldsymbol{x}_2,\cdots,\boldsymbol{x}_n)=\mathcal{A}((\boldsymbol{e}_1,\boldsymbol{e}_2,\cdots,\boldsymbol{e}_n)B),\]

    则
    \[\boldsymbol{x}_j=\sum\limits_{i=1}^n\boldsymbol{e}_ib_{ij},\]

    $\because\mathcal{A}$ 是线性的, $\therefore$
    \[\mathcal{A}\boldsymbol{x}_j=\mathcal{A}\left(\sum\limits_{i=1}^n\boldsymbol{e}_ib_{ij}\right)=\sum\limits_{i=1}^n(\mathcal{A}\boldsymbol{e}_i)b_{ij},\]

    $\therefore$
    \begin{align*}
        \mathcal{A}((\boldsymbol{e}_1,\boldsymbol{e}_2,\cdots,\boldsymbol{e}_n)B) & =(\mathcal{A}(\boldsymbol{e}_1,\boldsymbol{e}_2,\cdots,\boldsymbol{e}_n))B \\
        & =((\boldsymbol{e}_1,\boldsymbol{e}_2,\cdots,\boldsymbol{e}_n)A)B \\
        & =(\boldsymbol{e}_1,\boldsymbol{e}_2,\cdots,\boldsymbol{e}_n)AB \\
        & =(\boldsymbol{e}_1',\boldsymbol{e}_2',\cdots,\boldsymbol{e}_n')B^{-1}AB.
    \end{align*}

    $\therefore$
    \[(\boldsymbol{e}_1',\boldsymbol{e}_2',\cdots,\boldsymbol{e}_n')A'=\mathcal{A}(\boldsymbol{e}_1',\boldsymbol{e}_2',\cdots,\boldsymbol{e}_n')=(\boldsymbol{e}_1',\boldsymbol{e}_2',\cdots,\boldsymbol{e}_n')B^{-1}AB,\]

    $\therefore$
    \[A'=B^{-1}AB.\]
\end{proof}
举一个相似等价类的例子.
\begin{example}
    \[A=\begin{pmatrix}
        0 & 1 \\
        & 0 & 1 \\
        && \ddots & \ddots \\
        &&& 0 & 1 \\
        &&&& 0 \\
    \end{pmatrix}\]
    (其余元素为 $0$) 的相似等价类为 $\mathcal{C}_A=\{B^{-1}AB|B\in\operatorname{GL}_n\}$. 这是一个\textbf{幂0类}.

    有
    \[A'=\begin{pmatrix}
        0 \\
        & 0 && * \\
        && \ddots \\
        &&& 0 \\
        &&&& 0 \\
    \end{pmatrix}\in\mathcal{C}_A.\]

    在计算 $(A')^k$ 时, 可以将其分解为
    \[(A')^k=B'^{-1}\begin{pmatrix}
        0 & 1 \\
        & 0 & 1 \\
        && \ddots & \ddots \\
        &&& 0 & 1 \\
        &&&& 0 \\
    \end{pmatrix}^kB'.\]
\end{example}
\subsection{行列式和迹}
为了说明 $\det\mathcal{A}$ 的定义是合理的, 需要验证 $A\sim A'\Rightarrow\det A=\det A'$. 设 $A'=B^{-1}AB$, 则
\begin{align*}
    \det A' & =\det(B^{-1}AB) \\
    & =\det B^{-1}\det A\det B \\
    & =\det B^{-1}\det B\det A \\
    & =\det(B^{-1}B)\det A \\
    & =\det E\det A=\det A.
\end{align*}

容易验证 $\det$ 的一些性质:
\begin{property}
    (1) $\det(\mathcal{AB})=\det\mathcal{A}\det\mathcal{B}$;

    (2) $\mathcal{A}$ 可逆当且仅当 $\det\mathcal{A}\neq0$.
\end{property}
\begin{proof}
    (1) 取 $V$ 的一个基 $(\boldsymbol{e}_i)$, 由 $\mathcal{A},\mathcal{B}$ 在基 $(\boldsymbol{e}_i)$ 上的矩阵 $A,B$ 的行列式的性质得.

    (2) $\mathcal{A}$ 可逆当且仅当 $\exists\mathcal{B}\in\mathcal{L}(V)$ 使得 $\mathcal{AB}=\mathcal{E}$. 由 (1), $\det\mathcal{AB}=\det\mathcal{A}\det\mathcal{B}$, 而 $\exists\mathcal{B}\in\mathcal{L}(V)$ 使得 $\det\mathcal{A}\det\mathcal{B}=\det\mathcal{E}=1$ 当且仅当 $\det\mathcal{A}\neq0$.
\end{proof}
\subsection{Lie 代数}
将书上的例 6 中 Lie 代数的定义写完整, 就是:
\begin{definition}
    设 $L$ 是 $K$ 上的向量空间, 定义运算 $[,]:L\times L\to L$ 满足: $\forall a,b,c\in K,\boldsymbol{x},\boldsymbol{y},\boldsymbol{z}\in L$, 有

    (1) $[a\boldsymbol{x}+b\boldsymbol{y},c\boldsymbol{z}]=ac[\boldsymbol{x},\boldsymbol{z}]+bc[\boldsymbol{y},\boldsymbol{z}],[a\boldsymbol{x},b\boldsymbol{y}+c\boldsymbol{z}]=ab[\boldsymbol{x},\boldsymbol{y}]+ac[\boldsymbol{x},\boldsymbol{z}]$ (即 $(\mathcal{L}(L),[,])$ 为代数);

    (2) $[\boldsymbol{x},\boldsymbol{x}]=\boldsymbol{0}$ (自反性);

    (3) $[\boldsymbol{x},[\boldsymbol{y},\boldsymbol{z}]]+[\boldsymbol{y},[\boldsymbol{z},\boldsymbol{x}]]+[\boldsymbol{z},[\boldsymbol{x},\boldsymbol{y}]]=\boldsymbol{0}$ (Jacobi 等式);

    则称 $(\mathcal{L}(L),[,])$ (或者直接记为 $L$) 为 Lie 代数.
\end{definition}
\begin{example}
    对 $\mathcal{A},\mathcal{B}\in\mathcal{L}(V)$, 定义
    \[[\mathcal{A},\mathcal{B}]=\mathcal{A}\mathcal{B}-\mathcal{B}\mathcal{A}.\]

    $\because\forall a,b,c\in K,\mathcal{A},\mathcal{B},\mathcal{C}\in L$,
    \begin{align*}
        [a\mathcal{A}+b\mathcal{B},c\mathcal{C}] & =(a\mathcal{A}+b\mathcal{B})c\mathcal{C}-c\mathcal{C}(a\mathcal{A}+b\mathcal{B}) \\
        & =ac\mathcal{A}\mathcal{C}+bc\mathcal{B}\mathcal{C}-ac\mathcal{C}\mathcal{A}-bc\mathcal{C}\mathcal{B} \\
        & =ac(\mathcal{A}\mathcal{C}-\mathcal{C}\mathcal{A})+bc(\mathcal{B}\mathcal{C}-\mathcal{C}\mathcal{B}) \\
        & =ac[\mathcal{A},\mathcal{C}]+bc[\mathcal{B},\mathcal{C}],
    \end{align*}
    \begin{align*}
        [a\mathcal{A},b\mathcal{B}+c\mathcal{C}] & =a\mathcal{A}(b\mathcal{B}+c\mathcal{C})-(b\mathcal{B}+c\mathcal{C})a\mathcal{A} \\
        & =ab\mathcal{A}\mathcal{B}+ac\mathcal{A}\mathcal{C}-ab\mathcal{B}\mathcal{A}-ac\mathcal{C}\mathcal{A} \\
        & =ab(\mathcal{A}\mathcal{B}-\mathcal{B}\mathcal{A})+ac(\mathcal{A}\mathcal{C}-\mathcal{C}\mathcal{A}) \\
        & =ab[\mathcal{A},\mathcal{B}]+ac[\mathcal{A},\mathcal{C}],
    \end{align*}
    \[[\mathcal{A},\mathcal{A}]=\mathcal{A}\mathcal{A}-\mathcal{A}\mathcal{A}=\mathcal{O},\]
    \begin{align*}
        [\mathcal{A},[\mathcal{B},\mathcal{C}]] & =\mathcal{A}(\mathcal{B}\mathcal{C}-\mathcal{C}\mathcal{B})-(\mathcal{B}\mathcal{C}-\mathcal{C}\mathcal{B})\mathcal{A} \\
        & =\mathcal{A}\mathcal{B}\mathcal{C}-\mathcal{A}\mathcal{C}\mathcal{B}-\mathcal{B}\mathcal{C}\mathcal{A}+\mathcal{C}\mathcal{B}\mathcal{A}.
    \end{align*}
    \begin{align*}
        [\mathcal{A},[\mathcal{B},\mathcal{C}]]+[\mathcal{B},[\mathcal{C},\mathcal{A}]]+[\mathcal{C},[\mathcal{A},\mathcal{B}]] & =\mathcal{A}\mathcal{B}\mathcal{C}-\mathcal{A}\mathcal{C}\mathcal{B}-\mathcal{B}\mathcal{C}\mathcal{A}+\mathcal{C}\mathcal{B}\mathcal{A}+\mathcal{B}\mathcal{C}\mathcal{A}-\mathcal{B}\mathcal{A}\mathcal{C}-\mathcal{C}\mathcal{A}\mathcal{B}+\mathcal{A}\mathcal{C}\mathcal{B} \\
        & +\mathcal{C}\mathcal{A}\mathcal{B}-\mathcal{C}\mathcal{B}\mathcal{A}-\mathcal{A}\mathcal{B}\mathcal{C}+\mathcal{B}\mathcal{A}\mathcal{C} \\
        & =\mathcal{O},
    \end{align*}

    $\therefore(\mathcal{L}(\mathcal{L}(V)),[,])$ 为 Lie 代数.
\end{example}
\section{不变子空间和特征多项式(对应第 3 节)}
\subsection{投影算子}
考察例 \ref{exa2.1} 中的 $\mathcal{A}$. 有
\[\mathcal{A}:\begin{array}{rcl}
    V & \to & V \\
    \boldsymbol{x}+\boldsymbol{y}\ (\boldsymbol{x}\in\ker\mathcal{A},\boldsymbol{y}\in\operatorname{Im}\mathcal{A}) & \to & \boldsymbol{y} \\
\end{array},\]

设 $U=\operatorname{Im}\mathcal{A},W=\ker\mathcal{A}$, 定义
\[\mathcal{B}:\begin{array}{rcl}
    V & \to & V \\
    \boldsymbol{x}+\boldsymbol{y}\ (\boldsymbol{x}\in W,\boldsymbol{y}\in U) & \to & \boldsymbol{x} \\
\end{array},\]

则 $\mathcal{B}^2=\mathcal{B}$.

$\because V=U\oplus W,\therefore\forall\boldsymbol{x}\in V$, 有分解式 $\boldsymbol{x}=\boldsymbol{x}_1+\boldsymbol{x}_2$, 其中 $\boldsymbol{x}_1\in U,\boldsymbol{x}_2\in W$. $\because$
\begin{align*}
    (\mathcal{A}+\mathcal{B})\boldsymbol{x} & =\mathcal{A}\boldsymbol{x}+\mathcal{B}\boldsymbol{x} \\
    & =\mathcal{A}^2\boldsymbol{x}+\mathcal{B}^2\boldsymbol{x} \\
    & =\mathcal{A}(\mathcal{A}\boldsymbol{x})+\mathcal{B}(\mathcal{B}\boldsymbol{x}) \\
    & =\mathcal{A}\boldsymbol{x}_1+\mathcal{B}\boldsymbol{x}_2 \\
    & =\boldsymbol{x}_1+\boldsymbol{x}_2=\boldsymbol{x},
\end{align*}

$\therefore\mathcal{A}+\mathcal{B}=\mathcal{E}$. $\because$
\[\mathcal{A}\mathcal{B}\boldsymbol{x}=\mathcal{A}\boldsymbol{x}_2=\boldsymbol{0},\]

$\therefore\mathcal{A}\mathcal{B}=\mathcal{O}$, 同理 $\mathcal{B}\mathcal{A}=\mathcal{O}$.

设 $\boldsymbol{e}_1,\boldsymbol{e}_2,\cdots,\boldsymbol{e}_r$ 是 $U$ 的一个基, $\boldsymbol{e}_{r+1},\boldsymbol{e}_{r+2},\cdots,\boldsymbol{e}_n$ 是 $W$ 的一个基, 则 $\mathcal{A},\mathcal{B}$ 在 $\boldsymbol{e}_1,\boldsymbol{e}_2,\cdots,\boldsymbol{e}_n$ 下的矩阵 $A,B$ 分别为
\[A=\begin{pmatrix}
    E_r & 0 \\
    0 & 0
\end{pmatrix},\quad B=\begin{pmatrix}
    0 & 0 \\
    0 & E_{n-r}
\end{pmatrix}.\]

$\therefore$ 如果 $\operatorname{char}K=0$ (书上漏掉了这个条件), 则 $\operatorname{rank}\mathcal{A}=\operatorname{tr}\mathcal{A},\operatorname{rank}\mathcal{B}=\operatorname{tr}\mathcal{B}$.

上述性质实际上是投影算子的性质.
\subsection{不变子空间}
设 $U$ 是 $\mathcal{A}\in\mathcal{L}(V)$ 的不变子空间, $\boldsymbol{e}_1,\boldsymbol{e}_2,\cdots,\boldsymbol{e}_r$ 是 $U$ 的一个基. 将 $\boldsymbol{e}_1,\boldsymbol{e}_2,\cdots,\boldsymbol{e}_r$ 扩充为 $V$ 的一个基 $\boldsymbol{e}_1,\cdots,\boldsymbol{e}_r,\boldsymbol{e}_{r+1},\cdots,\boldsymbol{e}_n$.

对 $1\leq j\leq r$, $\because\mathcal{A}\boldsymbol{e}_j\in\mathcal{A}U\subset U$, $\therefore\mathcal{A}\boldsymbol{e}_j$ 可以写成
\[\mathcal{A}\boldsymbol{e}_j=a_{1j}\boldsymbol{e}_1+\cdots+a_{rj}\boldsymbol{e}_r\]
的形式.

$\therefore\mathcal{A}$ 在基 $\boldsymbol{e}_1,\cdots,\boldsymbol{e}_n$ 下的矩阵为
\begin{equation}\label{eq3.1}
    \begin{pmatrix}
        A_1 & A_0 \\
        0 & A_2 \\
    \end{pmatrix},
\end{equation}

其中 $A_1=(a_{ij})\in M_r(K)$. 这是书上的式 (4).

举两个不变子空间的例子.
\begin{example}
    $\mathbb{R}^2$ 上的映射的非平凡不变子空间全为 $1$ 维子空间($\mathbb{R}^2$ 的 $2$ 维子空间只有 $\mathbb{R}^2$). 容易验证:
    
    (1) 设 $\mathcal{A}$ 是平面 $\mathbb{R}^2$ 的旋转算子(书上第 2 节的例 3), 当 $0<\alpha<2\pi$ 时 $\mathcal{A}$ 没有非平凡不变子空间.

    (2) 设 $\mathcal{A}$ 是平面 $\mathbb{R}^2$ 关于过原点的直线 $l$ 的反射算子, 则直线 $l$ 是 $\mathcal{A}$ 的不变子空间.
\end{example}
\begin{example}\label{exa3.2}
    设 $\boldsymbol{e}_1,\boldsymbol{e}_2,\cdots,\boldsymbol{e}_n$ 是 $V$ 的基, $\mathcal{A}\in\mathcal{L}(V)$ 满足 $\mathcal{A}(\boldsymbol{e}_i)=\boldsymbol{e}_{i-1}$(约定 $\boldsymbol{e}_0=\boldsymbol{0}$), 则对 $1\leq m\leq n$, 有
    \[\mathcal{A}V_m=V_{m-1}\subset V_m,\]

    其中 $V_0=\{\boldsymbol{0}\},V_m=\left<\boldsymbol{e}_1,\boldsymbol{e}_2,\cdots,\boldsymbol{e}_m\right>$.

    $\therefore V_m$ 是 $\mathcal{A}$ 的不变子空间.

    $\mathcal{A}$ 在基 $\boldsymbol{e}_1,\boldsymbol{e}_2,\cdots,\boldsymbol{e}_m$ 下的矩阵为
    \[A=\begin{pmatrix}
        0 & 1 \\
        & 0 & 1 \\
        && \ddots & \ddots \\
        &&& 0 & 1 \\
        &&&& 0 \\
    \end{pmatrix}.\]

    记
    \[{}_{s}A=\begin{pmatrix}
        0 & 1 \\
        & 0 & 1 \\
        && \ddots & \ddots \\
        &&& 0 & 1 \\
        &&&& 0 \\
    \end{pmatrix}\in M_s(K).\]

    沿用式 \ref{eq3.1} 那里的记号, 有 $\forall m,A_1={}_{m}A,A_2={}_{n-m}A$.

    $\therefore$ 设 $A_0=(a_{ij})$, 则 $a_{r1}=1$, $A_0$ 的其他元素都为 $0$, $\therefore A_0\neq0$.
\end{example}
上面的例子可以引出:
\begin{theorem}[书上的定理 2]
    设 $\mathcal{A}\in\mathcal{L}(V),A_1,A_2$ 是方阵, 则 $\mathcal{A}$ 在某个基下的矩阵为
    \[A=\begin{pmatrix}
        A_1 & 0 \\
        0 & A_2 \\
    \end{pmatrix}\]
    当且仅当 $\mathcal{A}$ 有两个不变子空间 $U,W$ 使得 $V=U\oplus W$.
\end{theorem}
\begin{proof}
    ($\Rightarrow$) 设 $\mathcal{A}_U$ 在 $U$ 的某个基 $\boldsymbol{e}_1,\boldsymbol{e}_2,\cdots,\boldsymbol{e}_n$ 上的矩阵为 $A$. 设 $A_1\in M_r(K)$. 则
    \[V=\left<\boldsymbol{e}_1,\boldsymbol{e}_2,\cdots,\boldsymbol{e}_r\right>\oplus\left<\boldsymbol{e}_{r+1},\boldsymbol{e}_{r+2},\cdots,\boldsymbol{e}_n\right>.\]

    由 $A$ 的形式得 $\mathcal{A}\left<\boldsymbol{e}_1,\boldsymbol{e}_2,\cdots,\boldsymbol{e}_r\right>\in\left<\boldsymbol{e}_1,\boldsymbol{e}_2,\cdots,\boldsymbol{e}_r\right>,\mathcal{A}\left<\boldsymbol{e}_{r+1},\boldsymbol{e}_{r+2},\cdots,\boldsymbol{e}_n\right>\in\left<\boldsymbol{e}_{r+1},\boldsymbol{e}_{r+2},\cdots,\boldsymbol{e}_n\right>$.
    
    $\therefore\left<\boldsymbol{e}_1,\boldsymbol{e}_2,\cdots,\boldsymbol{e}_r\right>,\left<\boldsymbol{e}_{r+1},\boldsymbol{e}_{r+2},\cdots,\boldsymbol{e}_n\right>$ 是 $\mathcal{A}$ 的两个不变子空间.

    ($\Leftarrow$) 考虑 $\mathcal{A}$ 在 $U$ 上的限制 $\mathcal{A}_U$ 和 $\mathcal{A}$ 在 $W$ 上的限制 $\mathcal{A}_W$.

    设 $\mathcal{A}_U$ 在 $U$ 的某个基 $\boldsymbol{e}_1,\boldsymbol{e}_2,\cdots,\boldsymbol{e}_r$ 上的矩阵为 $A_1=(a_{ij})$, $\mathcal{A}_W$ 在 $W$ 的某个基 $\boldsymbol{e}_{r+1},\boldsymbol{e}_{r+2},\cdots,\boldsymbol{e}_n$ 上的矩阵为 $A_2=(b_{ij})$, $\therefore$
    \[\mathcal{A}\boldsymbol{e}_j=\begin{cases}
        \mathcal{A}_U\boldsymbol{e}_j=a_{1j}\boldsymbol{e}_1+a_{2j}\boldsymbol{e}_2+\cdots+a_{rj}\boldsymbol{e}_r, & j\leq r, \\
        \mathcal{A}_V\boldsymbol{e}_j=b_{1j}\boldsymbol{e}_{r+1}+b_{2j}\boldsymbol{e}_{r+2}+\cdots+b_{n-r,j}\boldsymbol{e}_n, & j>r. \\
    \end{cases}\]
    
    $\because V=U\oplus W,\therefore\boldsymbol{e}_1,\boldsymbol{e}_2,\cdots,\boldsymbol{e}_n$ 是 $V$ 的一个基, $\therefore\mathcal{A}$ 在基 $\boldsymbol{e}_1,\boldsymbol{e}_2,\cdots,\boldsymbol{e}_n$ 下的矩阵为 $A$.
\end{proof}
用数学归纳法可以将上面的定理推广到一般的情形: $V=V_1\oplus V_2\oplus\cdots\oplus V_s$, 其中 $V_1,V_2,\cdots,V_s$ 是 $V$ 的不变子空间, 当且仅当 $V$ 在某个基下的矩阵是拟对角矩阵
\[\begin{pmatrix}
    A_1 \\
    & A_2 \\
    && \ddots \\
    &&& A_s \\
\end{pmatrix},\]

其中 $A_i$ 是方阵.
\subsection{特征值和特征向量}
容易验证: 算子 $\mathcal{A}$ 与 $\lambda$ 相伴的特征子空间 $V^\lambda$ 是 $\mathcal{A}$ 的一个不变子空间, $\mathcal{A}$ 在 $V^\lambda$ 上的限制在 $V^\lambda$ 的任一基下的矩阵都是
\[\lambda E_{\dim V^\lambda}=\begin{pmatrix}
    \lambda \\
    & \lambda \\
    && \ddots \\
    &&& \lambda \\
\end{pmatrix}.\]

举几个特征值和特征向量的例子.
\begin{example}
    设 $V$ 是 $\mathbb{R}$ 上可导函数的全体, $V$ 上的求导算子 $\mathcal{D}:f\to \dfrac{\mathrm{d}f}{\mathrm{d}x}$ 的一个特征向量为 $e^{\lambda x}$, 特征值为 $\lambda$.
\end{example}
\begin{example}
    设 $V$ 是 $\mathbb{R}^2$ 上可微函数的全体, $V$ 上的 Laplace 算子 $\Delta:f(x,y)\to\dfrac{\partial^2f}{\partial x^2}+\dfrac{\partial^2f}{\partial y^2}$ 的特征值在一些特定的流形上的分析中有重要意义.
\end{example}
\begin{example}
    例 \ref{exa3.2} 中的 $\mathcal{A}$ 的特征多项式为
    \[\begin{vmatrix}
        t & 1 \\
        & t & 1 \\
        && \ddots & \ddots \\
        &&& t & 1 \\
        &&&& t \\
    \end{vmatrix}=t^n.\]

    $\therefore0$ 是 $\mathcal{A}$ 的特征值, $\mathcal{A}$ 关于 $0$ 的代数重数为 $n$.

    由例 \ref{exa3.2} 得 $V^0=\left<\boldsymbol{e}_1\right>$. $\therefore\mathcal{A}$ 与 $0$ 相伴的几何重数为 $1$.
\end{example}
在上面的例子中, $\operatorname{Spec}\mathcal{A}=\{0\}$ 是单谱, 但 $\mathcal{A}$ 可对角化, 这给出了书上定理 5 的一个反例. 书上定理 5 的正确表述应该是:
\begin{theorem}\label{t3.2}
    如果 $\chi_{\mathcal{A}}(t)$ 在 $K$ 中有 $n$ 个不同的根, 则 $\mathcal{A}$ 可对角化.
\end{theorem}
\begin{proof}
    设 $\lambda_1,\lambda_2,\cdots,\lambda_n$ 是 $\chi_{\mathcal{A}}(t)$ 的根, $\boldsymbol{v}_i\neq0$ 是 $V^{\lambda_i}$ 的特征向量(由 $\det(\mathcal{A}-\lambda\mathcal{E})=0\Rightarrow\ker(\mathcal{A}-\lambda\mathcal{E})\neq\boldsymbol{0}$ 得非零的特征向量一定存在). 设
    \[x_1\boldsymbol{v}_1+x_2\boldsymbol{v}_2+\cdots+x_n\boldsymbol{v}_n=\boldsymbol{0},\quad x_i\in K.\]
    
    将 $\mathcal{A}$ 作用于上式两边, 得
    \[x_1\mathcal{A}^k\boldsymbol{v}_1+x_2\mathcal{A}^k\boldsymbol{v}_2+\cdots+x_n\mathcal{A}^k\boldsymbol{v}_n=\mathcal{A}^k\boldsymbol{0},\quad k=1,2,\cdots,n-1.\]

    $\because\mathcal{A}^k\boldsymbol{v}_i=\lambda^k\boldsymbol{v}_i$, $\therefore$ 有关于 $x_i\boldsymbol{v}_i$ 的方程组
    \begin{equation}\label{eq3.2}
        \begin{cases}
            x_1\boldsymbol{v}_1+x_2\boldsymbol{v}_2+\cdots+x_n\boldsymbol{v}_n=\boldsymbol{0}, \\
            x_1\lambda\boldsymbol{v}_1+x_2\lambda\boldsymbol{v}_2+\cdots+x_n\lambda\boldsymbol{v}_n=\boldsymbol{0}, \\
            \cdots \\
            x_1\lambda^n\boldsymbol{v}_1+x_2\lambda^n\boldsymbol{v}_2+\cdots+x_n\lambda^n\boldsymbol{v}_n=\boldsymbol{0}. \\
        \end{cases}
    \end{equation}
    
    方程组 (\ref{eq3.2}) 的系数矩阵为 Vandermonde 行列式
    \[\begin{pmatrix}
        1 & 1 & \cdots & 1 \\
        \lambda_1 & \lambda_2 & \cdots & \lambda_n \\
        \vdots & \vdots & \ddots & \vdots \\
        \lambda^{n-1}_1 & \lambda^{n-1}_2 & \cdots & \lambda^{n-1}_n \\
    \end{pmatrix}.\]

    $\because\forall i\neq j,\lambda_i\neq\lambda_j$, $\therefore$ 方程组 (\ref{eq3.2}) 有唯一解
    \[x_i\boldsymbol{v}_i=\boldsymbol{0},\quad i=1,2,\cdots,n.\]

    $\because\boldsymbol{v}_i\neq0$, $\therefore x_1=x_2=\cdots=x_n=0$.

    $\therefore\boldsymbol{v}_1,\boldsymbol{v}_2,\cdots,\boldsymbol{v}_n$ 线性无关, $\therefore(\boldsymbol{v}_i)$ 是 $V$ 的一个基. $\mathcal{A}$ 在 $(\boldsymbol{v}_i)$ 下的矩阵就是对角矩阵.
\end{proof}
定理 \ref{t3.2} 是 $\mathcal{A}$ 可对角化的一个充分条件. 符合定理 \ref{t3.2} 的线性算子称为\textbf{正则的}(regular).
\begin{note}
    构造类似于方程组 (\ref{eq3.2}) 的, 但有 $m$ 个方程的方程组可以证明书上的引理 1.
\end{note}
\subsection{共轭线性算子}
由矩阵转置的关系式 ${}^t(AB)={}^tA{}^tB$ 以及书上的定理 8 猜想:
\begin{theorem}
    设 $\mathcal{A},\mathcal{B}\in\mathcal{L}(V)$, 则
    \[(\mathcal{AB})^*=\mathcal{B}^*\mathcal{A}^*.\]
\end{theorem}
\begin{proof}
    $\forall f\in V^*,\boldsymbol{x}\in V$,
    \begin{align*}
        ((\mathcal{AB})^*f,\boldsymbol{x}) & =(f,\mathcal{AB}\boldsymbol{x}) \\
        & =(f,\mathcal{A}(\mathcal{B}\boldsymbol{x})) \\
        & =(\mathcal{A}^*f,\mathcal{B}\boldsymbol{x}) \\
        & =(\mathcal{B}^*(\mathcal{A}^*f),\boldsymbol{x}) \\
        & =(\mathcal{B}^*\mathcal{A}^*f,\boldsymbol{x}).
    \end{align*}
\end{proof}
\section{Jordan 标准型 (对应第 4 节)}
\subsection{一些证明}
书上的定理 1 可以不用归纳法证明.
\begin{theorem}
    设 $K=\mathbb{C},\mathcal{A}\in\mathcal{L}(V)$, 则 $\exists V$ 的基 $\boldsymbol{e}_1,\boldsymbol{e}_2,\cdots,\boldsymbol{e}_n$ 使得 $\mathcal{A}$ 在基 $\boldsymbol{e}_1,\boldsymbol{e}_2,\cdots,\boldsymbol{e}_n$ 下的矩阵是上三角矩阵.
\end{theorem}
\begin{proof}[利用书上第 3 节定理 9 的证明]
    由书上第 3 节定理 9, $\exists V_{n-1}\in V$ 是 $\mathcal{A}$ 的 $n-1$ 维不变子空间. 设 $\mathcal{A}$ 在 $V_{n-1}$ 上的限制为 $\overline{\mathcal{A}}$, 则 $\exists V_{n-2}\in V_{n-1}$ 是 $\overline{\mathcal{A}}$ 的 $n-2$ 维不变子空间, 因而是 $\mathcal{A}$ 的 $n-2$ 维不变子空间. 重复上述步骤得到第 1 章笔记的例 1.2 那样的子空间链:
    \[V_1\subset V_2\subset\cdots\subset V_{n-1}\subset V,\quad\dim V_i=i.\]

    取 $V_1$ 的一个基 $\boldsymbol{e}_1$, 将其扩充为 $V_2$ 的一个基 $\boldsymbol{e}_1,\boldsymbol{e}_2$, 再扩充为 $V_3$ 的一个基 $\boldsymbol{e}_1,\boldsymbol{e}_2,\boldsymbol{e}_3$, 重复上述步骤, 得到 $V$ 的一个基 $\boldsymbol{e}_1,\boldsymbol{e}_2,\cdots,\boldsymbol{e}_n$, 其中 $\boldsymbol{e}_1,\boldsymbol{e}_2,\cdots,\boldsymbol{e}_i$ 是 $V_i$ 的一个基. $\because$
    \[\mathcal{A}\left<\boldsymbol{e}_1,\boldsymbol{e}_2,\cdots,\boldsymbol{e}_i\right>=\mathcal{A}V_i\subset V_i=\left<\boldsymbol{e}_1,\boldsymbol{e}_2,\cdots,\boldsymbol{e}_i\right>,\]

    $\therefore\mathcal{A}$ 在基 $\boldsymbol{e}_1,\boldsymbol{e}_2,\cdots,\boldsymbol{e}_n$ 下的矩阵是上三角矩阵.
\end{proof}
\begin{proof}[利用商算子的证明]
    由书上第 3 节定理 7, $V$ 有 $\mathcal{A}$ 的特征向量. 设 $\boldsymbol{e}_1\in V$ 使得 $\mathcal{A}\boldsymbol{e}_1=\lambda_1\boldsymbol{e}_1$.

    考虑 $\mathcal{A}$ 在 $L_1=V\backslash\left<\boldsymbol{e}_1\right>$ 上的商算子 $\overline{\mathcal{A}}_1$. 由书上第 3 节定理 7, $L_1$ 有 $\overline{\mathcal{A}}_1$ 的特征向量. 设 $\overline{\boldsymbol{e}}_2\in L_1$ 使得 $\overline{\mathcal{A}\boldsymbol{e}_2}=\overline{\mathcal{A}}_1\overline{\boldsymbol{e}}_2=\lambda_2\overline{\boldsymbol{e}}_2$. $\therefore\mathcal{A}\boldsymbol{e}_2-\lambda_2\boldsymbol{e}_2\in\left<\boldsymbol{e}_1\right>$. $\therefore\mathcal{A}\boldsymbol{e}_2=\lambda_2\boldsymbol{e}_2+\mu_1\boldsymbol{e}_1\in\left<\boldsymbol{e}_1,\boldsymbol{e}_2\right>$.

    考虑 $\overline{\mathcal{A}}_1$ 在 $L_2=L_1\backslash\left<\overline{\boldsymbol{e}}_2\right>$ 上的商算子 $\overline{\mathcal{A}}_2$. 由书上第 3 节定理 7, $L_2$ 有 $\overline{\mathcal{A}}_2$ 的特征向量. 设 $\overline{\overline{\boldsymbol{e}}}_3\in L_2$ 使得 $\overline{\overline{\mathcal{A}}_1\overline{\boldsymbol{e}}_3}=\overline{\mathcal{A}}_2\overline{\overline{\boldsymbol{e}}}_3=\lambda_2\overline{\overline{\boldsymbol{e}}}_3$. $\therefore\overline{\mathcal{A}}_1\overline{\boldsymbol{e}}_3-\lambda_3\overline{\boldsymbol{e}}_3\in\left<\overline{\boldsymbol{e}}_2\right>,\overline{\mathcal{A}\boldsymbol{e}_3}=\overline{\mathcal{A}}_1\overline{\boldsymbol{e}}_3=\lambda_3\overline{\boldsymbol{e}}_3+\mu_2\overline{\boldsymbol{e}}_2$. $\therefore\mathcal{A}\boldsymbol{e}_3-\lambda_3\boldsymbol{e}_3-\mu_2\boldsymbol{e}_2\in\left<\boldsymbol{e}_1\right>$. $\therefore\mathcal{A}\boldsymbol{e}_3=\lambda_3\boldsymbol{e}_3+\mu_2\boldsymbol{e}_2+\nu_1\boldsymbol{e}_1$.

    重复上述步骤可以得到 $V$ 的基 $\boldsymbol{e}_1,\boldsymbol{e}_2,\cdots,\boldsymbol{e}_n$ 使得 $\mathcal{A}$ 在基 $\boldsymbol{e}_1,\boldsymbol{e}_2,\cdots,\boldsymbol{e}_n$ 下的矩阵是上三角矩阵.
\end{proof}
Hamilton-Cayley 定理(书上的定理 2) 有一个推论:
\begin{corollary}\label{c4.1}
    $\mathcal{A}\in\mathcal{L}(V)$ 幂零当且仅当 $\exists m$ 使得特征函数 $\chi_{\mathcal{A}}(t)=t^m$.
\end{corollary}
\begin{proof}
    ($\Leftarrow$) 由书上的定理 2 得.

    ($\Rightarrow$) 设 $\mathcal{A}^s=\mathcal{O}$. 由书上第 2 节的定理 2 得 $\mu_\mathcal{A}(t)|t^s$. 由书上的定理 2 推论得 $0$ 是 $\chi_{\mathcal{A}}(t)$ 的唯一的根(不计重数), $\therefore\exists m$ 使得特征函数 $\chi_{\mathcal{A}}(t)=t^m$.
\end{proof}
\begin{example}[书上的例 3]
    设 $B=J_m(\lambda)-\lambda E$. 有
    \begin{equation}\label{eq4.1}
        \begin{aligned}
            (J_m(\lambda))^n & =(\lambda E+B)^n \\
            & =\sum\limits_{i=1}^n\dbinom{n}{i}(\lambda E)^{n-i}B^i \\
            & =\sum\limits_{i=1}^n\dbinom{n}{i}\lambda^{n-i}B^i \\
            & =\begin{pmatrix}
                \lambda^n & n\lambda^{n-1} & \dfrac{n(n-1)\lambda^{n-2}}{2} & \cdots & \dfrac{\lambda^n)^{(m-1}}{(m-1)!} \\[8pt]
                0 & \lambda^n & n\lambda^{n-1} & \cdots & \dfrac{\lambda^n)^{(m-2}}{(m-2)!} \\[8pt]
                0 & 0 & \lambda^n & \cdots & \dfrac{\lambda^n)^{(m-3}}{(m-3)!} \\
                \vdots & \vdots & \vdots & \ddots & \vdots \\
                0 & 0 & 0 & \cdots & \lambda^n \\
            \end{pmatrix}.
        \end{aligned}
    \end{equation}

    设 $f(t)=t^k+a_1t^{k-1}+\cdots+a_k$, 则 $f^{q}(t)=(t^k)^{q}+(a_1t^{k-1})^{q}+\cdots+(a_k)^{q}$, $\therefore$
    \[f(J_m(\lambda))=\begin{pmatrix}
        f(\lambda) & f'(\lambda) & \dfrac{f''(\lambda)}{2} & \cdots & \dfrac{f^{m-1}(\lambda)}{(m-1)!} \\[8pt]
        0 & f(\lambda) & f'(\lambda) & \cdots & \dfrac{f^{m-2}(\lambda)}{(m-2)!} \\[8pt]
        0 & 0 & f(\lambda) & \cdots & \dfrac{f^{m-3}(\lambda)}{(m-3)!} \\
        \vdots & \vdots & \vdots & \ddots & \vdots \\
        0 & 0 & 0 & \cdots & f(\lambda) \\
    \end{pmatrix}\]
\end{example}
\subsection{Jordan 标准型的构造}
下面通过对 $\mathcal{A}\in\mathcal{L}(V)$ 的分解来逐步构造 Jordan 标准型.

首先我们希望找到一个 $V$ 的分解:
\[V=W_1\oplus W_2\oplus\cdots\oplus W_p,\]

其中 $W_i$ 是 $\mathcal{A}$ 的不变子空间. 下面的例子表明, 特征子空间 $V^{\lambda_i}$ 不能作为 $W_i$.
\begin{example}
    例 \ref{ex2.2} 中的 $\mathcal{A}$ 只有一个特征值 $0$, $V^0=K$.
\end{example}

先从比较简单的 $\mathcal{A}$ 开始研究. 设 $\mathcal{A}\in\mathcal{L}(V)$ 的特征函数 $\chi_{\mathcal{A}}(t)=(t-\lambda)^n$. 由书上的定理 2, $(\mathcal{A}-\lambda\mathcal{E})^n=\mathcal{O}$. $\therefore$ 有 $(\mathcal{A}-\lambda\mathcal{E})^nV=\{\boldsymbol{0}\}$.

对于一般的情况:
\[\chi_{\mathcal{A}}(t)=\prod\limits_{i=1}^p(t-\lambda_i)^{n_i},\]

书上的定理 3 说明 $\exists V$ 的分解:
\[V=W_1\oplus W_2\oplus\cdots\oplus W_p,\]

其中 $W_i$ 是 $\mathcal{A}$ 的不变子空间, 且
\[(\mathcal{A}-\lambda\mathcal{E})^{n_i}W_i=\{\boldsymbol{0}\}.\]

将书上的定理 3 分成下面的几个定理和推论.
\begin{theorem}\label{t4.2}
    $V=V(\lambda_1)+V(\lambda_2)+\cdots+V(\lambda_p)$ 是直和.
\end{theorem}
\begin{proof}
    (前面的部分一直到式 (4) 都与书上定理 3 的证明一样). $\therefore$
    \begin{equation}\label{eq4.2}
        \chi_1(\mathcal{A})f_1(\mathcal{A})+\chi_2(\mathcal{A})f_2(\mathcal{A})+\cdots+\chi_p(\mathcal{A})f_p(\mathcal{A})=\mathcal{E}.
    \end{equation}

    令 $W_i=\chi_i(\mathcal{A})f_i(\mathcal{A})V$, 则
    \begin{equation}\label{eq4.3}
        \begin{aligned}
            (\mathcal{A}-\lambda_i\mathcal{E})^{n_i}W_i & =(\mathcal{A}-\lambda_i\mathcal{E})^{n_i}\chi_i(\mathcal{A})f_i(\mathcal{A})V \\
            & =\chi_{\mathcal{A}}(\mathcal{A})f_i(\mathcal{A})V \\
            & =\mathcal{O}f_i(\mathcal{A})V=\{\boldsymbol{0}\},
        \end{aligned}
    \end{equation}

    $\therefore W_i\subset V(\lambda_i)$.

    由式 (\ref{eq4.2}) 得 $\forall\boldsymbol{v}\in V$,
    \begin{equation}\label{eq4.4}
        \boldsymbol{v}=\mathcal{E}\boldsymbol{v}=\chi_1(\mathcal{A})f_1(\mathcal{A})\boldsymbol{v}+\chi_2(\mathcal{A})f_2(\mathcal{A})\boldsymbol{v}+\cdots+\chi_p(\mathcal{A})f_p(\mathcal{A})\boldsymbol{v}.
    \end{equation}

    $\because\chi_i(\mathcal{A})f_i(\mathcal{A})\boldsymbol{v}\in W_i\subset V(\lambda_i),\therefore$
    \[V=V(\lambda_1)+V(\lambda_2)+\cdots+V(\lambda_p).\]

    设 $\boldsymbol{v}\in V(\lambda_i)\cap(V(\lambda_1)+\cdots+\widehat{V(\lambda_i)}+\cdots+V(\lambda_p))$.
    
    $\because\boldsymbol{v}\in V(\lambda_i)$, $\therefore\exists m_i$ 使得 $(\mathcal{A}-\lambda_i\mathcal{E})^{m_i}\boldsymbol{v}=\boldsymbol{0}$.

    $\because\boldsymbol{v}\in V(\lambda_1)+\cdots+\widehat{V(\lambda_i)}+\cdots+V(\lambda_p)$, $\therefore\boldsymbol{v}$ 具有
    \[\boldsymbol{v}=\boldsymbol{v}_1+\cdots+\hat{\boldsymbol{v}}_i+\cdots+\boldsymbol{v}_p,\quad\boldsymbol{v}_j\in V(\lambda_j)\]
    的形式.
    
    $\because\forall j\neq i,\exists m_j$ 使得
    \[(\mathcal{A}-\lambda_j\mathcal{E})^{m_j}\boldsymbol{v}_j=0\Rightarrow\left(\prod\limits_{j\neq i}(\mathcal{A}-\lambda_j\mathcal{E})^{m_j}\right)\boldsymbol{v}_j=\boldsymbol{0},\]
    
    $\therefore$
    \[\left(\prod\limits_{j\neq i}(\mathcal{A}-\lambda_j\mathcal{E})^{m_j}\right)\boldsymbol{v}=\left(\prod\limits_{j\neq i}(\mathcal{A}-\lambda_j\mathcal{E})^{m_j}\right)\left(\sum\limits_{j\neq i}\boldsymbol{v}_j\right)=\boldsymbol{0}.\]

    $\because(t-\lambda_i)^{m_i}$ 与 $\prod\limits_{j\neq i}(t-\lambda_j)^{m_j}$ 互素, $\therefore\exists f(t),g(t)$ 使得
    \[f(t)(t-\lambda_i)^{m_i}+g(t)\prod\limits_{j\neq i}(t-\lambda_j)^{m_j}=1,\]

    $\therefore$
    \[f(\mathcal{A})(\mathcal{A}-\lambda\mathcal{E})^{m_i}+g(\mathcal{A})\prod\limits_{j\neq i}(\mathcal{A}-\lambda_j\mathcal{E})^{m_j}=\mathcal{E},\]
    \[\boldsymbol{0}=f(\mathcal{A})(\mathcal{A}-\lambda\mathcal{E})^{m_i}\boldsymbol{v}+g(\mathcal{A})\prod\limits_{j\neq i}(\mathcal{A}-\lambda_j\mathcal{E})^{m_j}\boldsymbol{v}=\boldsymbol{v},\]

    $\therefore$
    \begin{equation}\label{eq4.5}
        V(\lambda_i)\cap(V(\lambda_1)+\cdots+\widehat{V(\lambda_i)}+\cdots+V(\lambda_p))=\{\boldsymbol{0}\}.
    \end{equation}

    $\therefore V=V(\lambda_1)+V(\lambda_2)+\cdots+V(\lambda_p)$ 是直和.
\end{proof}
从定理 \ref{t4.2} 的证明中可以得到几个推论. 下面的推论沿用定理 \ref{t4.2} 的记号.
\begin{corollary}\label{c4.2}
    有
    \[V(\lambda_i)=\chi_i(\mathcal{A})f_i(\mathcal{A})V.\]
\end{corollary}
\begin{proof}
    定理 \ref{t4.2} 的证明过程中证明了 $W_i\subset V(\lambda_i)$.

    由式 (\ref{eq4.4}) 得 $\forall\boldsymbol{v}\in V(\lambda_i),\exists\boldsymbol{v}_j\in W_j\subset V(\lambda_i)$ 使得 $\boldsymbol{v}=\boldsymbol{v}_1+\boldsymbol{v}_2+\cdots+\boldsymbol{v}_p$.

    $\because\boldsymbol{v}_i\in V(\lambda_i),\therefore\boldsymbol{v}_1+\cdots+\hat{\boldsymbol{v}}_i+\cdots+\boldsymbol{v}_p\in V(\lambda_i)$. $\therefore\boldsymbol{v}_1+\cdots+\hat{\boldsymbol{v}}_i+\cdots+\boldsymbol{v}_p\in V(\lambda_i)\cap(V(\lambda_1)+\cdots+\widehat{V(\lambda_i)}+\cdots+V(\lambda_p))$.

    由式 (\ref{eq4.5}) 得 $\boldsymbol{v}_1+\cdots+\hat{\boldsymbol{v}}_i+\cdots+\boldsymbol{v}_p=\boldsymbol{0}$. $\therefore\boldsymbol{v}=\boldsymbol{v}_i\in W_i$. $\therefore V(\lambda_i)\subset W_i$.
\end{proof}
\begin{corollary}
    $V(\lambda_i)$ 是 $\mathcal{A}$ 的不变子空间.
\end{corollary}
\begin{proof}
    由
    \[\mathcal{A}W_i=\chi_i(\mathcal{A})f_i(\mathcal{A})(\mathcal{A}V)\subset\chi_i(\mathcal{A})f_i(\mathcal{A})V=W_i\]
    以及推论 \ref{c4.2} 得.
\end{proof}
\begin{corollary}\label{c4.4}
    若 $j\neq i$, 则 $\mathcal{A}-\lambda_j\mathcal{E}$ 在 $V(\lambda_i)$ 上的限制是非退化的.
\end{corollary}
\begin{proof}
    有
    \[\mathcal{A}-\lambda_j\mathcal{E}=(\lambda_i-\lambda_j)\mathcal{E}+\mathcal{A}-\lambda_i\mathcal{E}.\]

    设 $\mathcal{I}=\mathcal{E}|_{V(\lambda_i)},\mathcal{B}_i=-(\mathcal{A}-\lambda_i\mathcal{E})|_{V(\lambda_i)},a=\lambda_i-\lambda_j\neq0$, 将上式限制在 $V(\lambda_i)$ 上, 得
    \[(\mathcal{A}-\lambda_j\mathcal{E})|_{V(\lambda_i)}=a(\mathcal{I}-a^{-1}\mathcal{B}_i).\]

    由式 (\ref{eq4.3}) 得在 $V(\lambda_i)$ 上有 $(\mathcal{A}-\lambda_i\mathcal{E})^{n_i}=\mathcal{O}$. $\therefore a^{-1}\mathcal{B}_i^{n_i}=\mathcal{O},\therefore$
    \begin{align*}
        \mathcal{I} & =\mathcal{I}-(a^{-1}\mathcal{B}_i)^{n_i} \\
        & =(\mathcal{I}-a^{-1}\mathcal{B}_i)(1+a^{-1}\mathcal{B}_i+(a^{-1}\mathcal{B}_i)^2+\cdots+(a^{-1}\mathcal{B}_i)^{n_i-1}).
    \end{align*}

    $\because\mathcal{I}$ 是 $V(\lambda_i)$ 上的恒等映射, $\therefore\mathcal{I}-a^{-1}\mathcal{B}_i$ 在 $V(\lambda_i)$ 上可逆. $\therefore(\mathcal{A}-\lambda_j\mathcal{E})|_{V(\lambda_i)}=a(\mathcal{I}-a^{-1}\mathcal{B}_i)$ 在 $V(\lambda_i)$ 上可逆.
\end{proof}
\begin{corollary}
    在 $V(\lambda_i)$ 上, $\mathcal{A}$ 只有一个特征值 $\lambda_i$.
\end{corollary}
\begin{proof}
    设 $\boldsymbol{v}\in V(\lambda_i)\backslash\{\boldsymbol{0}\}$ 满足 $\mathcal{A}\boldsymbol{v}=\lambda\boldsymbol{v}$, 则 $\forall m,\mathcal{A}^m\boldsymbol{v}=(\lambda\mathcal{E})^m\boldsymbol{v}$.

    由式 (\ref{eq4.3}) 得
    \[(\mathcal{A}-\lambda_i\mathcal{E})^{n_i}\boldsymbol{v}=\boldsymbol{0}.\]

    $\therefore$
    \begin{align*}
        (\lambda_i-\lambda)^{n_i}\mathcal{E}\boldsymbol{v} & =(\lambda_i\mathcal{E}-\lambda\mathcal{E})^{n_i}\boldsymbol{v} \\
        & =\sum\limits_{k=1}^{n_i}\dbinom{n_i}{k}\left(\lambda_i\mathcal{E}\right)^k\left(-\lambda\mathcal{E}\right)^{n_i-k}\boldsymbol{v} \\
        & =\sum\limits_{k=1}^{n_i}\dbinom{n_i}{k}\left(\lambda_i\mathcal{E}\right)^k\left(-\mathcal{A}\right)^{n_i-k}\boldsymbol{v} \\
        & =(\lambda_i\mathcal{E}-\mathcal{A})^{n_i}\boldsymbol{v}=\boldsymbol{0},
    \end{align*}

    $\therefore\lambda-\lambda_i=0$.
\end{proof}
\begin{corollary}
    设 $\mathcal{B}=\mathcal{A}|_{V(\lambda_j)}-\lambda_j\mathcal{E}|_{V(\lambda_j)}$, 则
    \[\operatorname{Im}\mathcal{B}^{m-1}=\left<\boldsymbol{v}_1\right>.\]
\end{corollary}
\begin{proof}
    $\because\mathcal{B}^{m-1}\boldsymbol{v}_m=\mathcal{B}^{m-1}\boldsymbol{v}=\boldsymbol{v}_1,\forall j<m,\mathcal{B}^{m-1}\boldsymbol{v}_j=\mathcal{B}^{m-1+j}\boldsymbol{v}=\boldsymbol{0}$, $\therefore$
    \[\operatorname{Im}\mathcal{B}^{m-1}=\left<\mathcal{B}^{m-1}\boldsymbol{v}_1,\mathcal{B}^{m-1}\boldsymbol{v}_2,\cdots,\mathcal{B}^{m-1}\boldsymbol{v}_m\right>=\left<\boldsymbol{v}_1\right>.\qedhere\]
\end{proof}
由定理 \ref{t4.2}, $V(\lambda_j)$ 的一个基(记为 $(\boldsymbol{e}^j_i)$)合起来就是 $V$ 的一个基(记为 $(\boldsymbol{e}_i)$), 设 $\mathcal{A}|_{V(\lambda_j)}$ 在 $(\boldsymbol{e}^j_i)$ 下的矩阵为 $A_j$, 则 $\mathcal{A}$ 在 $(\boldsymbol{e}_i)$ 下的矩阵为
\[\begin{pmatrix}
    A_1 \\
    & A_2 \\
    && \ddots \\
    &&& A_p \\
\end{pmatrix}.\]

问题归结为找到 $V(\lambda_j)$ 的一个基 $(\boldsymbol{e}^j_i)$ 使得 $\mathcal{A}|_{V(\lambda_j)}$ 在 $(\boldsymbol{e}^j_i)$ 下的矩阵具有最简单的形式. $\because\mathcal{A}|_{V(\lambda_j)}-\lambda_j\mathcal{E}|_{V(\lambda_j)}$ 幂零, $\therefore$ 问题归结为如何将幂零矩阵化为 Jordan 矩阵.

从已经化为 Jordan 矩阵的幂零矩阵中找幂零矩阵化为 Jordan 矩阵的规律.
\begin{example}\label{exa4.2}
    设 $\mathcal{A}\in\mathcal{L}(V)$ 在基 $\boldsymbol{e}_1,\cdots,\boldsymbol{e}_{10}$ 下的矩阵为
    \[A=\begin{pmatrix}
        0 & 1 & 0 \\
        0 & 0 & 1 \\
        0 & 0 & 0 \\
        &&& 0 & 1 & 0 \\
        &&& 0 & 0 & 1 \\
        &&& 0 & 0 & 0 \\
        &&&&&& 0 & 1 \\
        &&&&&& 0 & 0 \\
        &&&&&&&& 0 \\
        &&&&&&&&& 0 \\
    \end{pmatrix}.\]

    有 $\mathcal{A}\boldsymbol{e}_1=\mathcal{A}\boldsymbol{e}_4=\mathcal{A}\boldsymbol{e}_7=\mathcal{A}\boldsymbol{e}_9=\mathcal{A}\boldsymbol{e}_{10}=\boldsymbol{0},\mathcal{A}\boldsymbol{e}_2=\boldsymbol{e}_1,\mathcal{A}\boldsymbol{e}_3=\boldsymbol{e}_2,\mathcal{A}\boldsymbol{e}_5=\boldsymbol{e}_4,\mathcal{A}\boldsymbol{e}_6=\boldsymbol{e}_5,\mathcal{A}\boldsymbol{e}_8=\boldsymbol{e}_7$.

    $\therefore$
    \[\mathcal{A}V=\left<\boldsymbol{e}_1,\boldsymbol{e}_2,\boldsymbol{e}_4,\boldsymbol{e}_5,\boldsymbol{e}_7\right>,\quad\mathcal{A}^2V=\left<\boldsymbol{e}_1,\boldsymbol{e}_4\right>,\quad\mathcal{A}^3V=\{\boldsymbol{0}\}.\]

    对 $\mathcal{A}^2\boldsymbol{e}_3=\boldsymbol{e}_1,\mathcal{A}^2\boldsymbol{e}_6=\boldsymbol{e}_4\in\operatorname{Im}\mathcal{A}^2\cap\ker\mathcal{A},\boldsymbol{e}_3,\mathcal{A}\boldsymbol{e}_3,\mathcal{A}^2\boldsymbol{e}_3$ 给出了第一个 Jordan 块, $\boldsymbol{e}_6,\mathcal{A}\boldsymbol{e}_6,\mathcal{A}^2\boldsymbol{e}_6$ 给出了第二个 Jordan 块.

    对 $\mathcal{A}\boldsymbol{e}_8=\boldsymbol{e}_7\in\operatorname{Im}\mathcal{A}\cap\ker\mathcal{A},\boldsymbol{e}_8,\mathcal{A}\boldsymbol{e}_8$ 给出了第 $3$ 个 Jordan 块.

    $\boldsymbol{e}_9,\boldsymbol{e}_{10}\in\ker\mathcal{A}\backslash\operatorname{Im}A$ 给出了第 $4,5$ 个 Jordan 块.
\end{example}
类似于例 \ref{exa4.2}, 给出命题``幂零矩阵可以化为 Jordan 矩阵''的构造性证明, 虽然在表述上比较麻烦, 但是思路还是很简单的. 为了方便, 下面的定理和引理使用的记号的含义都相同, 在前面提到过的记号后面不再重复说明.

设 $\mathcal{A}^m=\mathcal{O},\mathcal{A}^{m-1}\neq\mathcal{O},V_i=\operatorname{Im}\mathcal{A}^{i-1}\cap\ker\mathcal{A}$, 约定 $\mathcal{A}^0=\mathcal{E}$.

$\because\operatorname{Im}\mathcal{A}^i=\mathcal{A}^iV=\mathcal{A}^{i-1}\mathcal{A}V\subset\mathcal{A}^{i-1}V=\operatorname{Im}\mathcal{A}^{i-1}$, $\therefore$
\[\ker\mathcal{A}=V_1\supset V_2\supset\cdots\supset V_m\supsetneq\{\boldsymbol{0}\}.\]

从例 \ref{exa4.2} 可以看出:
\begin{lemma}\label{l4.1}
    \[\dim V_1+\dim V_2+\cdots+\dim V_m=\dim V.\]
\end{lemma}
\begin{proof}
    考虑
    \[\phi:\begin{array}{rcl}
        \ker\mathcal{A}^i & \to & \operatorname{Im}\mathcal{A}^{i-1}\cap\ker\mathcal{A}=V_i \\
        \boldsymbol{x} & \to & \mathcal{A}^{i-1}\boldsymbol{x} \\
    \end{array}.\]

    $\because\forall\boldsymbol{y}\in\operatorname{Im}\mathcal{A}^{i-1}\cap\ker\mathcal{A},\exists\boldsymbol{x}\in V$ 使得 $\boldsymbol{y}=\mathcal{A}^{i-1}\boldsymbol{x}$. 由 $\boldsymbol{y}\in\ker\mathcal{A}\Rightarrow\mathcal{A}\boldsymbol{y}=\boldsymbol{0}$ 得 $\mathcal{A}^i\boldsymbol{x}=\boldsymbol{0}$, $\therefore\boldsymbol{x}\in\ker\mathcal{A}^i$. $\therefore\phi$ 是满射, $\operatorname{Im}\phi=V_i$.

    由第 \ref{ex3.3} 题得 $\ker\mathcal{A}^i\supset\ker\mathcal{A}^{i-1}$, $\therefore\ker\phi=\ker\mathcal{A}^{i-1}$.

    由书上第 1 节的定理 4 得
    \[\dim\ker\phi+\dim\operatorname{Im}\phi=\dim\ker\mathcal{A}^i,\]

    $\therefore$
    \begin{equation}\label{eq4.6}
        \dim\ker\mathcal{A}^{i-1}+\dim V_i=\dim\ker\mathcal{A}^i.
    \end{equation}

    $\therefore$
    \begin{align*}
        \dim V_1+\dim V_2+\cdots+\dim V_m & =\sum\limits_{i=1}^m\left(\dim\ker\mathcal{A}^i-\dim\ker\mathcal{A}^{i-1}\right) \\
        & =\sum\limits_{i=1}^m\dim\ker\mathcal{A}^i-\sum\limits_{i=1}^m\dim\ker\mathcal{A}^{i-1} \\
        & =\sum\limits_{i=1}^m\dim\ker\mathcal{A}^i-\sum\limits_{i=0}^{m-1}\dim\ker\mathcal{A}^i \\
        & =\dim\ker\mathcal{A}^m-\dim\ker\mathcal{E} \\
        & =\dim\ker\mathcal{A}^m.
    \end{align*}

    $\because\mathcal{A}^m=\mathcal{O}$, $\therefore\ker\mathcal{A}^m=V$, $\therefore\dim\ker\mathcal{A}^m=\dim V$.
\end{proof}
$\because V_{i+1}\subset V_i\ (i=1,2,\cdots,m-1),\therefore\exists V_{i,1}$ 使得 $V_{i+1}\oplus V_{i,1}=V_i$. 记 $V_m=V_{m,1}$, 则 $\forall r\geq1$,
\begin{equation}\label{eq4.7}
    \begin{aligned}
        \bigoplus\limits_{i=r}^mV_{i,1} & =V_{m,1}\oplus V_{m-1,1}\oplus\left(\bigoplus\limits_{i=r}^{m-2}V_{i,1}\right) \\
        & =V_m\oplus V_{m-1,1}\oplus\left(\bigoplus\limits_{i=r}^{m-2}V_{i,1}\right) \\
        & =V_{m-1}\oplus\left(\bigoplus\limits_{i=r}^{m-2}V_{i,1}\right) \\
        & =V_{m-1}\oplus V_{m-2,1}\oplus\left(\bigoplus\limits_{i=r}^{m-3}V_{i,1}\right) \\
        & =V_{m-2}\oplus\left(\bigoplus\limits_{i=r}^{m-3}V_{i,1}\right) \\
        & =\cdots \\
        & =V_{r+1}\oplus V_{r,1}=V_r.
    \end{aligned}
\end{equation}

$\because V_{i,1}\subset V_i=\operatorname{Im}\mathcal{A}^{i-1}\cap\ker\mathcal{A}\subset\operatorname{Im}\mathcal{A}^{i-1}$, $\therefore V_{i,1}$ 的基 $(\boldsymbol{f}_k)$ 具有 $\boldsymbol{f}_k=\mathcal{A}^{i-1}\boldsymbol{v}_k,\boldsymbol{v}_k\in V$ 的形式.

设 $V_{i,i}=\left<\boldsymbol{v}_j\right>$. 容易验证 $V_{i,i}$ 满足: (1) $\mathcal{A}^{i-1}V_{i,i}=V_{i,1}$, (2) $\dim V_{i,i}=\dim V_{i,1}$.

设 $V_{i,j}=\mathcal{A}^{i-j}V_{i,i},\ j=1,2,\cdots,i$, 则 $V_{i,j}=\left<\mathcal{A}^{i-j}\boldsymbol{v}_k\right>$.

假设 $(\mathcal{A}^{i-j}\boldsymbol{v}_k)$ 线性相关, 即 $\exists$ 不全为 $0$ 的 $\lambda_k\in\mathbb{C}$ 使得 $\sum\limits_k\lambda_k\mathcal{A}^{i-j}\boldsymbol{v}_k=\boldsymbol{0}$, 则
\[\sum\limits_k\lambda_k\boldsymbol{f}_k=\sum\limits_k\lambda_k\mathcal{A}^{i-1}\boldsymbol{v}_k=\mathcal{A}^{j-1}\boldsymbol{0}=\boldsymbol{0},\]

$\therefore(\boldsymbol{f}_i)$ 线性相关, 与 $(\boldsymbol{f}_i)$ 是 $V_{i,1}$ 的基矛盾.

$\therefore(\mathcal{A}^{i-j}\boldsymbol{v}_k)$ 是 $V_{i,j}$ 的一个基, $\dim V_{i,j}=\dim V_{i,i}$.

得到如下的子空间:
\begin{equation}\label{eq4.8}
    \begin{matrix}
        V_{m,1} & V_{m,2} & \cdots & V_{m,m-1} & V_{m,m} \\
        V_{m-1,1} & V_{m-1,2} & \cdots & V_{m-1,m-1} \\
        \cdots & \cdots & \cdots \\
        V_{2,1} & V_{2,2} \\
        V_{1,1}
    \end{matrix}.
\end{equation}

有:
\begin{theorem}\label{t4.3}
    \[V=\bigoplus\limits_{1\leq j\leq i\leq m}V_{i,j}.\]
\end{theorem}
\begin{proof}
    $\because V_{i,j}=\mathcal{A}^{i-j}V_{i,i},\therefore$
    \[\mathcal{A}^jV_{i,j}=\mathcal{A}^iV_{i,i}=\mathcal{A}V_{i,1}\subset\mathcal{A}V_i.\]

    $\because V_i=\operatorname{Im}\mathcal{A}^{i-1}\cap\ker\mathcal{A}\subset\ker\mathcal{A},\therefore\mathcal{A}^jV_{i,j}=\mathcal{A}V_i=\{\boldsymbol{0}\}$.

    设 $\boldsymbol{v}_{ij}\in V_{i,j}$ 满足
    \begin{equation}\label{eq4.9}
        \sum\limits_{1\leq j\leq i\leq m}\boldsymbol{v}_{ij}=\boldsymbol{0}.
    \end{equation}

    式 (\ref{eq4.9}) 两边乘 $\mathcal{A}^{m-1}$ 得
    \[\sum\limits_{1\leq j\leq i\leq m}\mathcal{A}^{m-1}\boldsymbol{v}_{ij}=\boldsymbol{0}.\]

    $\because\mathcal{A}^jV_{i,j}=\{\boldsymbol{0}\}$, $\therefore\mathcal{A}^j\boldsymbol{v}_{ij}=\boldsymbol{0}$. $\therefore$ 上式 $\Rightarrow\mathcal{A}^{m-1}\boldsymbol{v}_{mm}=\boldsymbol{0}$.

    设 $(\boldsymbol{e}_i^{m,m})$ 是 $V_{m,m}$ 的一个基, 则 $(\mathcal{A}^{m-1}\boldsymbol{e}_i^{m,m})$ 是 $V_{m,1}$ 的一个基.
    
    设 $\boldsymbol{v}_{mm}=\sum\limits_ia_i\boldsymbol{e}_i^{m,m}$, 则 $\mathcal{A}^{m-1}\boldsymbol{v}_{mm}=\sum\limits_ia_i\mathcal{A}^{m-1}\boldsymbol{e}_i^{m,m}$. 由
    \[\mathcal{A}^{m-1}\boldsymbol{v}_{mm}=\sum\limits_ia_i\mathcal{A}^{m-1}\boldsymbol{e}_i^{m,m}=\boldsymbol{0}\]
    得 $a_i=0$. $\therefore \boldsymbol{v}_{mm}=\sum\limits_ia_i\boldsymbol{e}_i^{m,m}=\boldsymbol{0}$, 式 (\ref{eq4.9}) $\Rightarrow$
    \[\sum\limits_{\substack{1\leq i\leq m\\1\leq j\leq\min\{i,m-1\}}}\boldsymbol{v}_{ij}=\boldsymbol{0}.\]
    
    上式两边乘 $\mathcal{A}^{m-2}$ 得
    \[\sum\limits_{\substack{1\leq i\leq m\\1\leq j\leq\min\{i,m-1\}}}\mathcal{A}^{m-2}\boldsymbol{v}_{ij}=\mathcal{A}^{m-2}(\boldsymbol{v}_{m,m-1}+\boldsymbol{v}_{m-1,m-1})=\boldsymbol{0}.\]

    设 $(\boldsymbol{e}_i^{m,m-1})$ 是 $V_{m,m-1}$ 的一个基, $(\boldsymbol{e}_i^{m-1,m-1})$ 是 $V_{m-1,m-1}$ 的一个基, 则 $(\mathcal{A}^{m-2}\boldsymbol{e}_i^{m,m-1})$ 是 $V_{m,1}$ 的一个基, $(\mathcal{A}^{m-2}\boldsymbol{e}_i^{m-1,m-1})$ 是 $V_{m-1,1}$ 的一个基.

    $\because V_{m,1}\oplus V_{m-1,1}=V_{m-1}$, $\therefore(\mathcal{A}^{m-2}\boldsymbol{e}_i^{m,m-1},\mathcal{A}^{m-2}\boldsymbol{e}_i^{m-1,m-1})$ 是 $V_{m-1}$ 的一个基.

    设 $\boldsymbol{v}_{m,m-1}=\sum\limits_ib_i\boldsymbol{e}_i^{m,m-1},\boldsymbol{v}_{m-1,m-1}=\sum\limits_ib'_i\boldsymbol{e}_i^{m-1,m-1}$, 则
    \[\mathcal{A}^{m-1}(\boldsymbol{v}_{m,m-1}+\boldsymbol{v}_{m-1,m-1})=\sum\limits_ib_i\mathcal{A}^{m-1}\boldsymbol{e}_i^{m,m-1}+\sum\limits_jb_j'\mathcal{A}^{m-1}\boldsymbol{e}_j^{m-1,m-1}\]
    
    由 $\mathcal{A}^{m-1}(\boldsymbol{v}_{m,m-1}+\boldsymbol{v}_{m-1,m-1})=\boldsymbol{0}$ 得 $b_i=b_j'=0$. $\therefore\boldsymbol{v}_{m,m-1}=\boldsymbol{v}_{m-1,m-1}=\boldsymbol{0}$.

    重复上述步骤(注意使用式 (\ref{eq4.7}) 的结论)得 $\boldsymbol{v}_{i,j}=\boldsymbol{0}$. $\therefore\boldsymbol{0}$ 在 $\sum\limits_{1\leq j\leq i\leq m}V_{i,j}$ 中的表达式唯一, $\therefore\sum\limits_{1\leq j\leq i\leq m}V_{i,j}$ 是直和.

    由式 (\ref{eq4.7}),
    \[\sum\limits_{i=r}^m\dim V_{i,1}=\dim V_r.\]

    $\because\dim V_{i,j}=\dim V_{i,i}$, $\therefore$
    \[\sum\limits_{i=r}^m\dim V_{i,j}=\dim V_r.\]

    $\therefore$ (子空间阵列 (\ref{eq4.8}) 中先求每一列的和, 再对列相加)
    \begin{align*}
        \sum\limits_{1\leq j\leq i\leq m}\dim V_{i,j} & =\sum\limits_{j=1}^m\sum\limits_{i=j}^m\dim V_{i,j} \\
        & =\sum\limits_{j=1}^m\dim V_j.
    \end{align*}

    由引理 \ref{l4.1} 得 $\sum\limits_{j=1}^m\dim V_j=\dim V$. $\therefore$
    \[V=\bigoplus\limits_{1\leq j\leq i\leq m}V_{i,j}.\qedhere\]
\end{proof}
在证明最终的定理前, 先证明一个引理.
\begin{lemma}\label{l4.2}
    设 $\boldsymbol{v}\in V\backslash\{\boldsymbol{0}\}$, 则 $\boldsymbol{v},\mathcal{A}\boldsymbol{v},\mathcal{A}^2\boldsymbol{v},\cdots,\mathcal{A}^{m-1}\boldsymbol{v}$ 线性无关.
\end{lemma}
\begin{proof}
    假设
    \begin{equation}\label{eq4.10}
        a_0\boldsymbol{v}+a_1\mathcal{A}\boldsymbol{v}+\cdots+a_{m-1}\mathcal{A}^{m-1}\boldsymbol{v}=\boldsymbol{0},
    \end{equation}
    其中 $a_i\neq0$, 但 $\forall j<i,a_j=0$.

    用 $\mathcal{A}^{m-i-1}$ 作用于式 (\ref{eq4.10}) 两边, 得
    \[a_i\mathcal{A}^{m-1}\boldsymbol{v}+a_{i+1}\mathcal{A}^m\boldsymbol{v}+\cdots+a_{m-1}\mathcal{A}^{2(m-1)-1}\boldsymbol{v}=\boldsymbol{0}.\]

    $\because\mathcal{A}^m\boldsymbol{v}=\boldsymbol{0},\therefore a_{i+1}\mathcal{A}^m\boldsymbol{v}+\cdots+a_{m-1}\mathcal{A}^{2(m-1)-1}\boldsymbol{v}=\boldsymbol{0}\therefore a_i\mathcal{A}^{m-1}\boldsymbol{v}=\boldsymbol{0}$.

    $\because\mathcal{A}^{m-1}\boldsymbol{v}\neq\boldsymbol{0},\therefore\boldsymbol{v}\neq\boldsymbol{0},\therefore a_i=0$, 与 $a_i\neq0$ 矛盾.
    
    $\therefore$ 式 (\ref{eq4.10}) 中任一 $a_i=0$. $\therefore\boldsymbol{v},\mathcal{A}\boldsymbol{v},\mathcal{A}^2\boldsymbol{v},\cdots,\mathcal{A}^{m-1}\boldsymbol{v}$ 线性无关.
\end{proof}
\begin{theorem}\label{t4.4}
    $\mathcal{A}$ 在某个基下的矩阵为 Jordan 矩阵. 不计基的置换, Jordan 矩阵是唯一的.
\end{theorem}
\begin{proof}
    设 $\boldsymbol{e}_{i,1},\boldsymbol{e}_{i,2},\cdots,\boldsymbol{e}_{i,j_i}$ 是 $V_{i,i}$ 的一个基, $\boldsymbol{e}_{i,s}^t=\mathcal{A}^{i-t}\boldsymbol{e}_{i,s}\in V_{i,t},\ t=1,2,\cdots,i$, 则 $(\boldsymbol{e}_{i,s}^t)$ 是 $V_{i,t}$ 的一个基. 由定理 \ref{t4.3} 得
    \begin{equation}\label{eq4.11}
        \{\boldsymbol{e}_{i,s}^t|t=1,2,\cdots,i;s=1,2,\cdots,j_i;i=1,2,\cdots,m\}
    \end{equation}
    是 $V$ 的一个基. 给定 $i,s$, 设 $U_{i,s}=\left<\boldsymbol{e}_{i,s}^1,\boldsymbol{e}_{i,s}^2,\cdots,\boldsymbol{e}_{i,s}^i\right>$, 由引理 \ref{l4.2} 得 $\boldsymbol{e}_{i,s}^1,\boldsymbol{e}_{i,s}^2,\cdots,\boldsymbol{e}_{i,s}^i$ 是 $U_{i,s}$ 的一个基.
    
    $\because\boldsymbol{e}_{i,s}^t=\mathcal{A}^{i-t}\boldsymbol{e}_{i,s}=\mathcal{A}\mathcal{A}^{i-(t+1)}\boldsymbol{e}_{i,s}=\mathcal{A}\boldsymbol{e}_{i,s}^{t+1}$, 由例 \ref{exa3.2}, $\mathcal{A}|_{U_{i,s}}$ 在基 $\boldsymbol{e}_{i,s}^1,\boldsymbol{e}_{i,s}^2,\cdots,\boldsymbol{e}_{i,s}^i$ 下的矩阵为
    \[\begin{pmatrix}
        0 & 1 \\
        & 0 & 1 \\
        && \ddots & \ddots \\
        &&& 0 & 1 \\
        &&&& 0 \\
    \end{pmatrix}=J_i(0).\]

    这对任一 $s=1,2,\cdots,j_i$ 和 $i=1,2,\cdots,m$ 都成立, $\therefore\mathcal{A}$ 在基 (\ref{eq4.11}) 下的矩阵是 Jordan 矩阵, 含有 $j_i=\dim V_{i,i}$ 个 $J_i(0)\ (i=1,2,\cdots,m)$.

    $\because\dim V_{i,i}$ 与基的选取无关, $\therefore\mathcal{A}$ 含有 $J_i(0)$ 的个数与基的选取无关. $\therefore$ 不计基的置换, Jordan 矩阵是唯一的.
\end{proof}
\begin{note}
    在实际计算中需要通过容易计算的指标计算 Jordan 块的个数.

    $\mathcal{A}$ 一共含有 $\sum\limits_{i=1}^m\dim V_{i,i}=\sum\limits_{i=1}^m\dim V_{i,1}=\dim V_1=\dim\ker\mathcal{A}$ 个 Jordan 块.

    $\mathcal{A}$ 含有 $J_i(0)$ 的个数为 $\dim V_{i,i}=\dim V_{i,1}$.
    
    $\because V_{i+1}\oplus V_{i,1}=V_i$, $\therefore\dim V_{i,1}=\dim V_i-\dim V_{i+1}$. 由式 (\ref{eq4.6}) 得
    \begin{align*}
        \dim V_{i,1} & =\dim\ker\mathcal{A}^i-\dim\ker\mathcal{A}^{i-1}-(\dim\ker\mathcal{A}^{i+1}-\dim\ker\mathcal{A}^i) \\
        & =2\dim\ker\mathcal{A}^i-\dim\ker\mathcal{A}^{i-1}-\dim\ker\mathcal{A}^{i+1}.
    \end{align*}
\end{note}
\section{一些计算方法的总结}
\subsection{特征值和特征向量}
如果不能直接看出 $\mathcal{A}\in\mathcal{L}(V)$ 的特征向量, 一般只能列方程求解.

解方程 $\chi_\mathcal{A}(t)=0$ 得到特征向量 $\lambda$, 然后对每个 $\lambda$, 从方程
\[\begin{cases}
    (a_{11}-\lambda)x_1+a_{12}x_2+\cdots+a_{1n}x_n=0, \\
    a_{21}x_1+(a_{22}-\lambda)x_2+\cdots+a_{1n}x_n=0, \\
    \cdots \\
    a_{n1}x_1+a_{n2}x_2+\cdots+(a_{nn}-\lambda)x_n=0 \\
\end{cases}\]
中解出特征向量 $(x_1,x_2,\cdots,x_n)$.
\subsection{Jordan 标准型}
设 $\mathcal{A}\in\mathcal{L}(V)$ 在某个基下的矩阵为 $A$. 求 $\mathcal{A}$ 的 Jordan 标准型本质上是求满足 $X^{-1}AX=J_A$(其中 $J_A$ 是 $A$ 的 Jordan 矩阵)的 $J_A$ 和可逆矩阵 $X$.

先求出 $\mathcal{A}$ 的特征值 $\lambda_i$. 由定理 \ref{t4.4}, $(\mathcal{A}-\lambda_i\mathcal{E})|_{V(\lambda_i)}$ 在 $V(\lambda_i)$ 的某个基下的矩阵
\[B=\begin{pmatrix}
    J_{i_1}(0) \\
    & J_{i_2}(0) \\
    && \ddots \\
    &&& J_{i_p}(0) \\
\end{pmatrix}\]
是 Jordan 矩阵, 而 $\mathcal{A}$ 在相同的基下的矩阵为
\[B+\lambda_iE=\begin{pmatrix}
    J_{i_1}(\lambda_i) \\
    & J_{i_2}(\lambda_i) \\
    && \ddots \\
    &&& J_{i_p}(\lambda_i) \\
\end{pmatrix}.\]

由定理 \ref{t4.4} 的注记得对角线上元素为 $\lambda_i$ 的 Jordan 块的个数为 $\dim(\mathcal{A}-\lambda_i\mathcal{E})|_{V(\lambda_i)}$, 其中 $t$ 阶的 Jordan 块的个数为 $2\dim\ker(\mathcal{A}-\lambda_i\mathcal{E})^t|_{V(\lambda_i)}-\dim\ker(\mathcal{A}-\lambda_i\mathcal{E})^{t-1}|_{V(\lambda_i)}-\dim\ker(\mathcal{A}-\lambda_i\mathcal{E})^{t+1}|_{V(\lambda_i)}$.

由推论 \ref{c4.4} 得若 $i\neq j$, 则 $\ker(\mathcal{A}-\lambda_i\mathcal{E})|_{V(\lambda_j)}=\{\boldsymbol{0}\}$, $\therefore\ker(\mathcal{A}-\lambda_i\mathcal{E})=\ker(\mathcal{A}-\lambda_i\mathcal{E})|_{V(\lambda_i)}$. $\therefore\dim\ker(\mathcal{A}-\lambda_i\mathcal{E})|_{V(\lambda_i)}=\dim\ker(\mathcal{A}-\lambda_i\mathcal{E})=n-\operatorname{rank}(\mathcal{A}-\lambda_i\mathcal{E})$,
\begin{align*}
    & 2\dim\ker(\mathcal{A}-\lambda_i\mathcal{E})^t|_{V(\lambda_i)}-\dim\ker(\mathcal{A}-\lambda_i\mathcal{E})^{t-1}|_{V(\lambda_i)}-\dim\ker(\mathcal{A}-\lambda_i\mathcal{E})^{t+1}|_{V(\lambda_i)} \\
    = &\ 2\dim\ker(\mathcal{A}-\lambda_i\mathcal{E})^t-\dim\ker(\mathcal{A}-\lambda_i\mathcal{E})^{t-1}-\dim\ker(\mathcal{A}-\lambda_i\mathcal{E})^{t+1} \\
    = &\ 2(n-\operatorname{rank}(\mathcal{A}-\lambda_i\mathcal{E})^t)-(n-\operatorname{rank}(\mathcal{A}-\lambda_i\mathcal{E})^{t-1})-(n-\operatorname{rank}(\mathcal{A}-\lambda_i\mathcal{E})^{t+1}) \\
    = &\ \operatorname{rank}(\mathcal{A}-\lambda_i\mathcal{E})^{t-1}+\operatorname{rank}(\mathcal{A}-\lambda_i\mathcal{E})^{t+1}-2\operatorname{rank}(\mathcal{A}-\lambda_i\mathcal{E})^t.
\end{align*}

在大多数情况下, 知道对角线上元素为 $\lambda_i$ 的 Jordan 块的个数就可以写出 Jordan 矩阵 $J_A$ 了.

求 $X$ 的逆矩阵比较麻烦, 所以一般化为 $AX=XJ_A$ 来求(但是还是很麻烦, 需要许多计算的技巧).
\section{第2章习题}
\subsection{习题2.1}
\begin{exercise}[1.1]
    把坐标列 $\boldsymbol{x}=[x_1,x_2,x_3,x_4]$ 写成矩阵 $X=\dbinom{x_1\ x_2}{x_3\ x_4}\in M_2(K)$ 的形式, 取一个固定的矩阵 $A=\dbinom{a_1\ a_2}{a_3\ a_4}\in M_2(K)$, 定义两个线性映射
    \[f_L:X\mapsto AX=\dbinom{x_1'\ x_2'}{x_3'\ x_4'},\quad f_R:X\mapsto XA=\dbinom{x_1''\ x_2''}{x_3''\ x_4''},\]

    它们分别对应矩阵 $M_{f_L},M_{f_R}\in M_4(K)$. 求 $M_{f_L},M_{f_R}$.
\end{exercise}
\begin{solution}
    $\because$
    \[AX=\begin{pmatrix}
        a_1x_1+a_2x_3 & a_1x_2+a_2x_4 \\
        a_3x_1+a_4x_3 & a_3x_2+a_4x_4 \\
    \end{pmatrix},\quad XA=\begin{pmatrix}
        x_1a_1+x_2a_3 & x_1a_2+x_2a_4 \\
        x_3a_1+x_4a_3 & x_3a_2+x_4a_4 \\
    \end{pmatrix},\]

    $\therefore$
    \[\begin{cases}
        x_1'=a_1x_1+a_2x_3, \\
        x_2'=a_1x_2+a_2x_4, \\
        x_3'=a_3x_1+a_4x_3, \\
        x_4'=a_3x_2+a_4x_4, \\
    \end{cases}\quad\begin{cases}
        x_1''=a_1x_1+a_3x_2, \\
        x_2''=a_2x_1+a_4x_2, \\
        x_3''=a_1x_3+a_3x_4, \\
        x_4''=a_2x_3+a_4x_4, \\
    \end{cases}\]

    $\therefore$
    \[M_{f_L}=\begin{pmatrix}
        a_1 & 0   & a_2 & 0   \\
        0   & a_1 & 0   & a_2 \\
        a_3 & 0   & a_4 & 0   \\
        0   & a_3 & 0   & a_4 \\
    \end{pmatrix}\quad M_{f_R}=\begin{pmatrix}
        a_1 & a_3 & 0   & 0   \\
        a_2 & a_4 & 0   & 0   \\
        0   & 0   & a_1 & a_3 \\
        0   & 0   & a_2 & a_4 \\
    \end{pmatrix}.\]
\end{solution}
\begin{exercise}[1.2]\label{ex1.2}
    (1) 设 $W=V/L$ 是 $V$ 的商空间, $f:V\to W$ 把每个向量 $\boldsymbol{x}\in V$ 映成陪集 $\bar{\boldsymbol{x}}$, 验证 $f$ 是线性映射.

    (2) 设 $P_n$ 为 $K[t]$ 中次数 $\leq n$ 的多项式, 验证
    \[f:\begin{array}{rcl}
        P_n & \to & P_n \\
        u(t) & \to & tu'(t)-u(t) \\
    \end{array}\]
    是线性映射, 求 $\ker f,\operatorname{rank}f$.

    (3) 设 $C$ 是非退化矩阵, 验证 $f_C:X\mapsto C^{-1}XC$ 是 $M_n(K)$ 上的线性映射, 且
    \[f_C(XY)=f_C(X)f_C(Y).\]
\end{exercise}
\begin{proof}
    (1) 设 $\boldsymbol{x},\boldsymbol{y}\in V,\alpha,\beta\in K$. 由 $W$ 中加法和纯量乘法的定义,
    \[\overline{\alpha\boldsymbol{x}+\beta\boldsymbol{y}}=\alpha\bar{\boldsymbol{x}}+\beta\bar{\boldsymbol{y}},\]

    $\therefore f$ 是线性映射.

    (2) 设 $u,v\in P_n,\alpha,\beta\in K$. 有
    \begin{align*}
        f(\alpha u+\beta v)(t) & =t(\alpha u+\beta v)'(t)-(\alpha u+\beta v)(t) \\
        & =t(\alpha u'(t)+\beta v'(t))-(\alpha u(t)+\beta v(t)) \\
        & =\alpha(tu'(t)-u(t))+\beta(tv'(t)-v(t)) \\
        & =\alpha f(u)+\beta f(v),
    \end{align*}

    $\therefore f$ 是线性映射.

    考虑 $P_n$ 中的一个基 $1,t,t^2,\cdots,t^n$. 有
    \[f(t^k)=t\cdot kt^{k-1}-t^k=(k-1)t^k,\quad k=1,2,\cdots,n.\]

    $\therefore\forall w=a_0+a_1t+\cdots+a_nt^n\in P_n\backslash\{0\},f(w)=-a_0+a_2t^2+\cdots+(n-1)a_nt^n$.

    $\therefore f(w)=0\Leftrightarrow w=\alpha t,\alpha\in K.\therefore\ker f=Kt=\{\alpha t|\alpha\in K\}.\therefore\operatorname{rank}f=\dim P_n-\dim\ker f=n$.

    (3) 设 $A,B\in M_n(K),\alpha,\beta\in K$. 有
    \begin{align*}
        f_C(\alpha A+\beta B) & =C^{-1}(\alpha A+\beta B)C \\
        & =\alpha C^{-1}AC+\beta C^{-1}BC \\
        & =\alpha f_C(A)+\beta f_C(B),
    \end{align*}

    $\therefore f_C$ 是线性映射. 有
    \[f_C(XY)=C^{-1}XYC=C^{-1}XCC^{-1}YC=f_C(X)f_C(Y).\qedhere\]
\end{proof}
\subsection{习题2.2}
\begin{exercise}[2.2]
    证明: 如果 $A,B,C$ 分别是 $n\times p,p\times q,q\times n$ 的矩阵, 那么 $\operatorname{tr}(ABC)=\operatorname{tr}(BCA)=\operatorname{tr}(CAB)$.
\end{exercise}
\begin{proof}
    只需证明: 若 $A',B'$ 分别是 $n\times p,p\times n$ 的矩阵, 那么 $\operatorname{tr}(A'B')=\operatorname{tr}(B'A')$, 令 $A'=A,B'=BC$ 得 $\operatorname{tr}(ABC)=\operatorname{tr}(BCA)$, 令 $A'=B,B'=CA$ 得 $\operatorname{tr}(BCA)=\operatorname{tr}(CAB)$.

    设 $A'=(a_{ij}),B'=(b_{ij}),A'B'=(c_{ij}),B'A'=(d_{ij})$, 则
    \[c_{ij}=\sum\limits_{k=1}^pa_{ik}b_{kj},\quad d_{ij}=\sum\limits_{k=1}^nb_{ik}a_{kj}.\]

    $\therefore$
    \begin{align*}
        \operatorname{tr}(A'B') & =\sum\limits_{i=1}^nc_{ii} \\
        & =\sum\limits_{i=1}^n\sum\limits_{k=1}^pa_{ik}b_{ki} \\
        & =\sum\limits_{k=1}^p\sum\limits_{i=1}^nb_{ki}a_{ik} \\
        & =\sum\limits_{k=1}^pd_{kk} \\
        & =\operatorname{tr}(B'A').\qedhere
    \end{align*}
\end{proof}
\begin{exercise}[2.5]\label{ex2.5}
    证明: 对 $V$ 上的任意线性算子 $\mathcal{A},\mathcal{B}$, 有
    \[\operatorname{rank}\mathcal{A}=\operatorname{rank}\mathcal{BA}+\dim(\operatorname{Im}\mathcal{A}\cap\ker\mathcal{B}).\]
\end{exercise}
\begin{proof}
    考虑 $\mathcal{B}$ 在 $\operatorname{Im}\mathcal{A}$ 上的限制 $\mathcal{B}'$. 有
    \[\operatorname{Im}\mathcal{BA}=B(\operatorname{Im}\mathcal{A})=\operatorname{Im}\mathcal{B}',\]
    \[\operatorname{Im}\mathcal{A}\cap\ker\mathcal{B}=\{\boldsymbol{x}\in\operatorname{Im}\mathcal{A}|\mathcal{B}\boldsymbol{x}=\boldsymbol{0}\}=\{\boldsymbol{x}\in\operatorname{Im}\mathcal{A}|\mathcal{B}'\boldsymbol{x}=\boldsymbol{0}\}=\ker\mathcal{B}',\]

    由书上的式 (1) 得
    \[\dim\operatorname{Im}\mathcal{A}=\dim\operatorname{Im}\mathcal{B}'+\dim\ker\mathcal{B}'.\]

    $\therefore$
    \[\dim\operatorname{Im}\mathcal{A}=\dim\operatorname{Im}\mathcal{BA}+\dim(\operatorname{Im}\mathcal{A}\cap\ker\mathcal{B}).\]

    由式 (\ref{eq1.2}) 得 $\forall\mathcal{C}\in\mathcal{L}(V)$,
    \[\dim\operatorname{Im}\mathcal{C}=\operatorname{rank}\mathcal{C},\]

    $\therefore$
    \[\operatorname{rank}\mathcal{A}=\operatorname{rank}\mathcal{BA}+\dim(\operatorname{Im}\mathcal{A}\cap\ker\mathcal{B}).\qedhere\]
\end{proof}
\begin{exercise}[2.6]
    证明: $\forall\mathcal{A},\mathcal{B},\mathcal{C}\in\mathcal{L}V$, 有
    \[\operatorname{rank}\mathcal{BA}+\operatorname{rank}\mathcal{AC}\leq\operatorname{rank}\mathcal{A}+\operatorname{rank}\mathcal{BAC}.\]
\end{exercise}
\begin{proof}
    由第 \ref{ex2.5} 题得
    \[\operatorname{rank}\mathcal{A}-\operatorname{rank}\mathcal{BA}=\dim(\operatorname{Im}\mathcal{A}\cap\ker\mathcal{B}),\]
    \[\operatorname{rank}\mathcal{AC}-\operatorname{rank}\mathcal{BAC}=\dim(\operatorname{Im}(\mathcal{AC})\cap\ker\mathcal{B}).\]

    $\because\operatorname{Im}(\mathcal{AC})=A(\operatorname{Im}\mathcal{C})\subset\operatorname{Im}\mathcal{A},\ \therefore\operatorname{Im}(\mathcal{AC})\cap\ker\mathcal{B}\subset\operatorname{Im}\mathcal{A}\cap\ker\mathcal{B},\ \therefore$
    \[\dim(\operatorname{Im}(\mathcal{AC})\cap\ker\mathcal{B})\leq\dim(\operatorname{Im}\mathcal{A}\cap\ker\mathcal{B})\Rightarrow\operatorname{rank}\mathcal{AC}-\operatorname{rank}\mathcal{BAC}\leq\operatorname{rank}\mathcal{A}-\operatorname{rank}\mathcal{BA}.\qedhere\]
\end{proof}
\begin{exercise}[2.8]
    设 $A,B\in M_n(\mathbb{R})$. 证明: 如果 $\exists C\in \operatorname{GL}_n(\mathbb{C})$ 使得 $B=C^{-1}AC$, 则 $\exists D\in \operatorname{GL}_n(\mathbb{R})$ 使得 $B=D^{-1}AD$.
\end{exercise}
\begin{proof}
    设 $C=X+iY,(X,Y\in M_n(\mathbb{R}))$. 令 $C_t=X+tY$, 其中 $t$ 是变元, $f(t)=\det C_t.\because X,Y\in M_n(\mathbb{R}),\therefore f\in\mathbb{R}[t]$.
    
    $\because f(i)=\det C\neq0,\therefore f\neq0$.

    $\because\deg f\leq n,\therefore f$ 最多只有 $n$ 个根, $\therefore\exists t_0\in\mathbb{R}$ 使得 $\det C_{t_0}=f(t_0)\neq0.\therefore C_{t_0}$ 可逆. $\therefore C_{t_0}\in \operatorname{GL}_n(\mathbb{R})$.

    $\because B=C^{-1}AC,\therefore(X+iY)B=A(X+iY)\Rightarrow XB+iYB=AX+iAY$.

    $\because X,Y,A,B\in M_n(\mathbb{R}),\therefore XB=AX,YB=AY$.

    $\therefore XB+t_0YB=AX+t_0AY.\therefore(X+t_0Y)B=A(X+t_0Y)$, 即 $C_{t_0}B=AC_{t_0}$.

    $\because C_{t_0}$ 可逆, $\therefore B=C_{t_0}^{-1}AC_{t_0}$.
\end{proof}
\begin{exercise}[2.9]
    类似于书上的定义 2, 称 $f(t)$ 是线性算子 $\mathcal{A}$ 对于向量 $\boldsymbol{v}\in V$ 的\textbf{零化多项式}当且仅当 $f(\mathcal{A})\boldsymbol{v}=\boldsymbol{0}$. 称 $\mathcal{A}$ 对于 $\boldsymbol{v}$ 的零化多项式中次数最低者为 $\mathcal{A}$ 对于 $\boldsymbol{v}$ 的\textbf{极小多项式}, 记作 $\mu_{\mathcal{A},\boldsymbol{v}}(t)$. 设 $|K|=\infty$. 证明:

    (1) $\mu_{\mathcal{A},\boldsymbol{v}}(t)\neq\mathcal{O}\Rightarrow\mu_{\mathcal{A},\boldsymbol{v}}(t)|\mu_{\mathcal{A}}(t)$; (2) $\exists\boldsymbol{a}$ 使得 $\mu_{\mathcal{A},\boldsymbol{a}}(t)=\mu_{\mathcal{A}}(t)$.
\end{exercise}
\begin{proof}
    (1) $\because\forall\boldsymbol{v}\in V,\mu_{\mathcal{A}}(\mathcal{A})\boldsymbol{v}=\mathcal{O}\boldsymbol{v}=\boldsymbol{0},\therefore\mu_{\mathcal{A}}$ 是 $\mathcal{A}$ 对于 $\boldsymbol{v}\in V$ 的零化多项式. 在 $\mathcal{L}(V)$ 上的多项式环中有分解式
    \[\mu_{\mathcal{A}}(t)=\mu_{\mathcal{A},\boldsymbol{a}}(t)f(t)+r(t),\quad\deg r\leq\deg\mu_{\mathcal{A},\boldsymbol{a}}.\]

    $\therefore$
    \[\mu_{\mathcal{A}}(\mathcal{A})\boldsymbol{v}=\mu_{\mathcal{A},\boldsymbol{v}}(\mathcal{A})\boldsymbol{v}\cdot f(\mathcal{A})\boldsymbol{v}+r(\mathcal{A})\boldsymbol{v}.\]

    假设 $r\neq\mathcal{O}$. $\because\mu_{\mathcal{A}}(\mathcal{A})\boldsymbol{v}=\mu_{\mathcal{A},\boldsymbol{a}}(\mathcal{A})\boldsymbol{v}=\boldsymbol{0}$, $\therefore r(\mathcal{A})\boldsymbol{v}=0$.
    
    另一方面, $\deg r<\deg\mu_{\mathcal{A},\boldsymbol{v}}$, 这与极小多项式的定义矛盾. $\therefore r=\mathcal{O}$.
\end{proof}
\begin{exercise}[2.11]\label{ex2.11}
    设 $\operatorname{char}K=0,A\in M_n(K)$, 证明: 如果 $\operatorname{tr}A=0$, 则 $A$ 相似于主对角线上取零值的矩阵 $A'$.
\end{exercise}
\begin{proof}
    证明与之等价的命题: 设 $\mathcal{A}\in\mathcal{L}(V)$. 如果 $\operatorname{tr}\mathcal{A}=0$, 则 $\exists V$ 的一个基 $(\boldsymbol{e}_i)$ 使得 $\mathcal{A}$ 在 $(\boldsymbol{e}_i)$ 下的矩阵的主对角线上取零值(由定理 \ref{t2.1} 得这个命题与原命题等价).

    对 $n$ 用数学归纳法. 当 $n=1$ 时 $\mathcal{A}=\mathcal{O}$, 对任一基, $\mathcal{A}$ 在基下的矩阵的主对角线上都取零值. 假设当 $n=m-1$ 时命题成立.

    取 $V$ 的一个基 $(\boldsymbol{e}_i)$, 设 $A=(a_{ij})$ 是 $\mathcal{A}$ 在基 $(\boldsymbol{e}_i)$ 下的矩阵. 有 $\operatorname{tr}A=\operatorname{tr}\mathcal{A}=0$.

    (a) 若 $a_{11}=0$, 设 $W=\left<\boldsymbol{e}_2,\boldsymbol{e}_3,\cdots,\boldsymbol{e}_n\right>$, 则 $V=W\oplus\left<\boldsymbol{e}_1\right>,\dim W=n-1,\mathcal{A}\boldsymbol{e}_1=a_{12}\boldsymbol{e}_2+a_{13}\boldsymbol{e}_3+\cdots+a_{1n}\boldsymbol{e}_n\in W$.
    
    考虑 $\mathcal{A}$ 在 $W$ 上的限制 $\overline{\mathcal{A}}$. $\overline{\mathcal{A}}$ 在 $\boldsymbol{e}_2,\boldsymbol{e}_3,\cdots,\boldsymbol{e}_n$ 上的矩阵为 $A$ 去掉第 $1$ 行第 $1$ 列的矩阵 $\overline{A}$.
    
    $\because a_{11}=0,\operatorname{tr}A=\sum\limits_{i=1}^na_{ii}=0$, $\therefore\operatorname{tr}\overline{A}=\sum\limits_{i=2}^na_{ii}=0$, 即 $\operatorname{tr}\overline{\mathcal{A}}=0$.
    
    由归纳假定, $\exists W$ 的一个基 $\boldsymbol{e}_1',\boldsymbol{e}_2',\cdots,\boldsymbol{e}_{n-1}'$ 使得 $\mathcal{A}$ 在 $\boldsymbol{e}_1',\boldsymbol{e}_2',\cdots,\boldsymbol{e}_{n-1}'$ 下的矩阵 $A'=(a'_{ij})$ 的主对角线上取零值, 即 $a'_{11}=a'_{22}=\cdots=a'_{n-1,n-1}=0.\therefore$
    \[\begin{cases}
        \mathcal{A}\boldsymbol{e}'_1=\overline{\mathcal{A}}\boldsymbol{e}'_1=a_{12}'\boldsymbol{e}'_2+a_{13}'\boldsymbol{e}'_3+\cdots+a_{1n}'\boldsymbol{e}'_{n-1}, \\
        \mathcal{A}\boldsymbol{e}'_2=\overline{\mathcal{A}}\boldsymbol{e}'_2=a_{21}'\boldsymbol{e}'_1+a_{23}'\boldsymbol{e}'_3+\cdots+a_{2n}'\boldsymbol{e}'_{n-1}, \\
        \cdots \\
        \mathcal{A}\boldsymbol{e}'_{n-1}=\overline{\mathcal{A}}\boldsymbol{e}'_{n-1}=a_{n-1,1}'\boldsymbol{e}'_1+a_{n-1,2}'\boldsymbol{e}'_2+\cdots+a_{n-1,n-2}'\boldsymbol{e}'_{n-2}. \\
    \end{cases}\]
    
    $\because V=W\oplus\left<\boldsymbol{e}_1\right>,\therefore\boldsymbol{e}_1',\cdots,\boldsymbol{e}_{n-1}',\boldsymbol{e}_1$ 是 $V$ 的一个基.
    
    $\because\mathcal{A}\boldsymbol{e}_1\in W,\therefore\exists a'_{n1},a'_{n2},\cdots,a'_{n,n-1}$ 使得
    \[\mathcal{A}\boldsymbol{e}_1=a'_{n1}\boldsymbol{e}'_1+a'_{n2}\boldsymbol{e}'_2+\cdots,a'_{n,n-1}\boldsymbol{e}'_{n-1}.\]

    $\therefore\mathcal{A}$ 在 $\boldsymbol{e}_1',\cdots,\boldsymbol{e}_{n-1}',\boldsymbol{e}_1$ 下的矩阵为
    \[\begin{pmatrix}
        0 & a'_{12} & \cdots & a'_{1,n-1} & 0 \\
        a'_{21} & 0 & \cdots & a'_{2,n-1} & 0 \\
        \vdots & \vdots & \ddots & \vdots & \vdots \\
        a'_{n1} & a'_{n2} & \cdots & 0 & 0 \\
        a'_{n1} & a'_{n2} & \cdots & a'_{n,n-1} & 0 \\
    \end{pmatrix}.\]

    (b) 若 $a_{11}\neq0$ 但 $\exists i$ 使得 $a_{ii}=0$, 则 $\mathcal{A}$ 在基 $\boldsymbol{e}_i,\boldsymbol{e}_2,\cdots,\boldsymbol{e}_{i-1},\boldsymbol{e}_1,\boldsymbol{e}_{i+1},\cdots,\boldsymbol{e}_n$ 下的矩阵 $A'=(a_{ij}')$ 有 $a_{11}'=0$. 问题归结为 (a) 的情形.

    (c) 若 $\forall i,a_{ii}\neq0$ 但 $\exists j\neq 1$ 使得 $a_{1j}=0$, 则 $AF_{j,1}\left(-\dfrac{a_{11}}{a_{1j}}\right)=(b_{ij})$ (其中 $F_{s,t}(\lambda)$ 以及下文出现的 $F_{s,t}$ 为初等矩阵, 定义见 [BAI] 第 2 章第 3 节第 6 小节) 是将 $A$ 的第 $j$ 列乘 $-\dfrac{a_{11}}{a_{1j}}$ 后加到第 $1$ 列得到的矩阵,
    \[F^{-1}_{j,1}\left(-\dfrac{a_{11}}{a_{1j}}\right)AF_{j,1}\left(-\dfrac{a_{11}}{a_{1j}}\right)=F_{j,1}\left(\dfrac{a_{11}}{a_{1j}}\right)AF_{j,1}\left(-\dfrac{a_{11}}{a_{1j}}\right)=(c_{ij})\]
    是将 $AF_{j,1}\left(-\dfrac{a_{11}}{a_{1j}}\right)$ 的第 $1$ 行乘 $-\dfrac{a_{11}}{a_{1j}}$ 后加到第 $j$ 列得到的矩阵, 有
    \[c_{11}=b_{11}=a_{11}-\dfrac{a_{11}}{a_{1j}}a_{1j}=0.\]

    记 $A'=F^{-1}_{j,1}\left(-\dfrac{a_{11}}{a_{1j}}\right)AF_{j,1}\left(-\dfrac{a_{11}}{a_{1j}}\right)$ $\because F_{j,1}\left(-\dfrac{a_{11}}{a_{1j}}\right)\in\operatorname{GL}_n(K),\therefore A$ 相似于 $A'$.

    由定理 \ref{t2.3}, $\mathcal{A}$ 在基
    \[(\boldsymbol{e}_1,\boldsymbol{e}_2,\cdots,\boldsymbol{e}_n)F_{j,1}\left(-\dfrac{a_{11}}{a_{1j}}\right)\]
    下的矩阵为 $A'$. 问题归结为 (a) 的情形.

    (d) 若 $\forall k,a_{kk}\neq0$ 但 $\exists i\neq j$ 使得 $a_{ij}\neq0$, 则 $\mathcal{A}$ 在基 $\boldsymbol{e}_i,\boldsymbol{e}_2,\cdots,\boldsymbol{e}_{i-1},\boldsymbol{e}_1,\boldsymbol{e}_{i+1},\cdots,\boldsymbol{e}_n$ 下的矩阵 $A'=(a_{ij}')$ 有 $a_{1j}'=0$. 问题归结为 (c) 的情形.

    (e) 若 $A=\operatorname{diag}(a_{11},a_{22},\cdots,a_{nn})$, 假设 $a_{11}=a_{22}=\cdots=a_{nn}=a$, 则 $\operatorname{tr}A=na$. $\because\operatorname{char}K=0,\therefore\operatorname{tr}A\neq0$. $\therefore\exists k$ 使得 $a_{kk}\neq a_{11}$.

    设 $AF_{1,2}(1)=(b_{ij}),F^{-1}_{1,2}(1)AF_{1,2}(1)=(c_{ij})$, 则
    \[c_{1k}=b_{1k}-b_{kk}=(a_{1k}+a_{11})-(a_{kk}+a_{k1})=a_{11}-a_{kk}.\]
    
    $\therefore A$ 相似于满足 $\exists j\neq 1$ 使得 $a'_{1j}=0$ 的矩阵 $A'=(a'_{ij})$. 问题归结为 (c) 的情形.
\end{proof}
\begin{exercise}[2.12]
    将习题 \ref{ex2.11} 中的 ``$\operatorname{char}K=0$'' 这一条件去掉, 结论是否还成立?
\end{exercise}
\begin{solution}
    不成立. 考虑 $\operatorname{char}K=n$ 中的单位矩阵 $E\in M_n(K)$. $\because\operatorname{char}K=n$, $\therefore\operatorname{tr}A=n=0$. 另一方面, $\because\forall A\in\operatorname{GL}_n(K),A^{-1}EA=A^{-1}A=E,\therefore E$ 只与 $E$ 相似.
\end{solution}
\subsection{习题2.3}
\begin{exercise}[3.1]
    设 $\{A_i|1\leq i\leq m-1\}$ 是正交的幂等矩阵组. 设 $A=A_1+A_2+\cdots+A_{m-1},A_m=E-A$, 证明: $A^2=A,AA_i=A_iA=A_i,1\leq i\leq m-1,\{A_i|1\leq i\leq m\}$ 是完全正交组.
\end{exercise}
\begin{proof}
    $\because\{A_i|1\leq i\leq m-1\}$ 是正交的幂等矩阵组, $\therefore A_iA_j=\delta_{ij}A_i\ (1\leq i,j\leq m-1)$, $\therefore\forall i=1,2,\cdots,m-1$,
    \begin{align*}
        AA_i & =(A_1+A_2+\cdots+A_{m-1})A_i \\
        & =A_1A_i+A_2A_i+\cdots+A_{m-1}A_i \\
        & =A_i^2=A_i.
    \end{align*}

    同理得 $A_iA=A_i$. $\therefore$
    \begin{align*}
        A^2 & =(A_1+A_2+\cdots+A_{m-1})A \\
        & =A_1A+A_2A+\cdots+A_{m-1}A \\
        & =A_1+A_2+\cdots+A_{m-1} \\
        & =A.
    \end{align*}

    $\because$
    \[A_m^2=(E-A)^2=E-2A+A^2=E-A=A_m,\]

    $\forall i=1,2,\cdots,m-1$,
    \[A_mA_i=(E-A)A_i=A_i-A_i=0,\]

    $\therefore A_iA_j=\delta_{ij}A_i\ (1\leq i,j\leq m)$.
    
    $\because$
    \[A_1+A_2+\cdots+A_{m-1}+A_m=A+A_m=E,\]

    $\therefore\{A_i|1\leq i\leq m\}$ 是完全正交组.
\end{proof}
\begin{exercise}[3.2]
    设 $\mathcal{D}\in\mathcal{L}(M_n(K))$ 不恒等于 $\mathcal{O}$, 对 $\forall A,B\in M_n(K)$, 有
    \[\mathcal{D}(AB)=\mathcal{D}(A)\mathcal{D}(B).\]

    证明: $\exists$ 非退化矩阵 $C$ 使得 $\mathcal{D}=f_C$, 其中 $f_C$ 的定义见第 \ref{ex1.2}(3) 题.
\end{exercise}
\begin{proof}
     
\end{proof}
证明第 \ref{ex3.3} 题需要先证明一个引理.
\begin{lemma}\label{l5.1}
    设 $f:A\to B$ 是映射, $A_1,A_2\subset A$, 则
    \[f(A_1\cap A_2)\subset f(A_1)\cap f(A_2).\]
\end{lemma}
\begin{proof}
    $\forall a\in A_1\cap A_2,a\in A_1\land a\in A_2$. $\therefore f(a)\in f(A_1)\land f(a)\in f(A_2)$.
    
    $\therefore f(a)\in f(A_1)\cap f(A_2)$. $\therefore f(A_1\cap A_2)\subset f(A_1)\cap f(A_2)$.
\end{proof}
\begin{note}
    $f(A_1\cap A_2)=f(A_1)\cap f(A_2)$ 不一定成立. 比如: 对 $\mathbb{R}$ 上的函数 $f(x)=|x|$, 有 $f(\{1\}\cap\{-1\})=f(\varnothing)=\varnothing$, 但 $f(\{1\})\cap f(\{-1\})=\{1\}$.
\end{note}
\begin{exercise}[3.3]\label{ex3.3}
    设 $\dim V=n,\mathcal{A}\in\mathcal{L}(V)$ 满足: 对某个 $p\in\mathbb{N}$ 有 $\operatorname{Im}\mathcal{A}^p=\operatorname{Im}\mathcal{A}^{p+1}$. 证明: $\ker\mathcal{A}^p,\operatorname{Im}\mathcal{A}^p$ 是 $\mathcal{A}$ 的不变子空间, 且 $V=\ker\mathcal{A}^p\oplus\operatorname{Im}\mathcal{A}^p$.
\end{exercise}
\begin{proof}
    $\because\operatorname{Im}\mathcal{A}^p=\operatorname{Im}\mathcal{A}^{p+1}=\mathcal{A}(\operatorname{Im}\mathcal{A}^p)$, $\therefore\operatorname{Im}\mathcal{A}^p$ 是 $\mathcal{A}$ 的不变子空间. 有
    \begin{align*}
        \mathcal{A}^p(\operatorname{Im}\mathcal{A}^p) & =\operatorname{Im}\mathcal{A}^{2p} \\
        & =\mathcal{A}^{p-1}(\operatorname{Im}\mathcal{A}^{p+1}) \\
        & =\mathcal{A}^{p-1}(\operatorname{Im}\mathcal{A}^p) \\
        & =\operatorname{Im}\mathcal{A}^{2p-1} \\
        & =\cdots \\
        & =\operatorname{Im}\mathcal{A}^p.
    \end{align*}

    $\because\ker\mathcal{A}^p=\{\boldsymbol{x}|\mathcal{A}^p\boldsymbol{x}=\boldsymbol{0}\}$, $\therefore$
    \begin{equation}\label{ex3.3eq}
        \mathcal{A}(\ker\mathcal{A}^p)=\{\mathcal{A}\boldsymbol{x}|\mathcal{A}^{p-1}\mathcal{A}\boldsymbol{x}=\boldsymbol{0}\}=\{\boldsymbol{y}|\mathcal{A}^{p-1}\boldsymbol{y}=\boldsymbol{0}\}=\ker\mathcal{A}^{p-1}.
    \end{equation}

    $\because\forall\boldsymbol{x}\in\ker\mathcal{A}^{p-1},\mathcal{A}^{p-1}\boldsymbol{x}=\boldsymbol{0}\Rightarrow\mathcal{A}^p\boldsymbol{x}=\mathcal{A}(\mathcal{A}^{p-1}\boldsymbol{x})=\mathcal{A}\boldsymbol{0}=\boldsymbol{0}$, $\therefore\boldsymbol{x}\in\ker\mathcal{A}^p$. $\therefore\mathcal{A}(\ker\mathcal{A}^p)\subset\ker\mathcal{A}^p$, 即 $\ker\mathcal{A}^p$ 是 $\mathcal{A}$ 的不变子空间.

    假设 $\exists$ 非零的 $\boldsymbol{x}\in\ker\mathcal{A}^p\cap\operatorname{Im}\mathcal{A}^p$, 则 $\exists\boldsymbol{y}\in V$ 使得 $\mathcal{A}^p\boldsymbol{y}=\boldsymbol{x}$. $\because\boldsymbol{x}\neq\boldsymbol{0}$, $\therefore\boldsymbol{y}\neq\boldsymbol{0}$.

    假设 $\boldsymbol{y}\notin\operatorname{Im}\mathcal{A}^p$, 则 $\boldsymbol{x}\notin\mathcal{A}^p(\operatorname{Im}\mathcal{A}^p)=\operatorname{Im}\mathcal{A}^p$, 与 $\boldsymbol{x}\in\operatorname{Im}\mathcal{A}^p$ 矛盾. $\therefore\boldsymbol{y}\in\operatorname{Im}\mathcal{A}^p$. $\therefore\exists\boldsymbol{z}\in V$ 使得 $\mathcal{A}^p\boldsymbol{z}=\boldsymbol{y}$. 与前面类似, $\boldsymbol{z}\in\operatorname{Im}\mathcal{A}^p\backslash\{\boldsymbol{0}\}$.

    重复上述步骤得 $\exists\boldsymbol{x}_0\in V$ 使得 $\mathcal{A}^{kp}\boldsymbol{x}_0\neq\boldsymbol{0}\ (k=0,1,2,\cdots,n),\mathcal{A}^{(n+1)p}\boldsymbol{x}_0=0$.

    由书上第 4 节的例 1 得 $\boldsymbol{x}_0,\mathcal{A}^p\boldsymbol{x}_0,\mathcal{A}^{2p}\boldsymbol{x}_0,\cdots,\mathcal{A}^{np}\boldsymbol{x}_0$ 线性无关, 这与 $\dim V=n$ 矛盾. $\therefore$
    \[\ker\mathcal{A}^p\cap\operatorname{Im}\mathcal{A}^p=\{\boldsymbol{0}\}.\]

    $\therefore\ker\mathcal{A}^p+\operatorname{Im}\mathcal{A}^p$ 是直和. $\therefore$
    \[\dim(\ker\mathcal{A}^p\oplus\operatorname{Im}\mathcal{A}^p)=\dim\ker\mathcal{A}^p+\dim\operatorname{Im}\mathcal{A}^p.\]

    由书上第 1 节的定理 4 得 $\dim(\ker\mathcal{A}^p\oplus\operatorname{Im}\mathcal{A}^p)=\dim V$. $\therefore V=\ker\mathcal{A}^p\oplus\operatorname{Im}\mathcal{A}^p$.
\end{proof}
\begin{exercise}[3.4]
    证明: 如果 $n$ 维向量空间 $V$ 上的线性算子 $\mathcal{E},\mathcal{A},\mathcal{A}^2,\cdots,\mathcal{A}^{n-1}$ 是线性无关的, 那么 $\exists\boldsymbol{v}$ 使得
    \[V=\left<\boldsymbol{v},\mathcal{A}\boldsymbol{v},\cdots,\mathcal{A}^{n-1}\boldsymbol{v}\right>.\]
\end{exercise}
\begin{proof}
    $\because\mathcal{E},\mathcal{A},\mathcal{A}^2,\cdots,\mathcal{A}^{n-1}$ 线性无关, $\therefore$ 若 $\lambda_1,\lambda_2,\cdots,\lambda_n\in K$ 满足
    \begin{align*}
        & \lambda_1\mathcal{E}+\lambda_2\mathcal{A}+\lambda_3\mathcal{A}^2+\cdots+\lambda_n\mathcal{A}^{n-1}=\mathcal{O} \\
        \Rightarrow\ & \lambda_1\mathcal{E}\boldsymbol{v}+\lambda_2\mathcal{A}\boldsymbol{v}+\lambda_3\mathcal{A}^2\boldsymbol{v}+\cdots+\lambda_n\mathcal{A}^{n-1}\boldsymbol{v}=\mathcal{O}\boldsymbol{v} \\
        \Rightarrow\ & \lambda_1\boldsymbol{v}+\lambda_2\mathcal{A}\boldsymbol{v}+\lambda_3\mathcal{A}^2\boldsymbol{v}+\cdots+\lambda_n\mathcal{A}^{n-1}\boldsymbol{v}=\boldsymbol{0},
    \end{align*}

    则 $\lambda_1=\lambda_2=\cdots=\lambda_n=0$.

    $\therefore\boldsymbol{v},\mathcal{A}\boldsymbol{v},\mathcal{A}^2\boldsymbol{v},\cdots,\mathcal{A}^{n-1}\boldsymbol{v}$ 线性无关. $\therefore\boldsymbol{v},\mathcal{A}\boldsymbol{v},\mathcal{A}^2\boldsymbol{v},\cdots,\mathcal{A}^{n-1}\boldsymbol{v}$ 是 $V$ 的一个基.
\end{proof}
\begin{exercise}[3.6]
    证明: $\forall A,B\in M_n(\mathbb{R})$, 矩阵 $AB$ 和 $BA$ 的特征多项式相同.
\end{exercise}
\begin{proof}
    若 $A\in\operatorname{GL}_n(\mathbb{R})$, 则 $AB=(A^{-1})^{-1}BAA^{-1},\therefore AB$ 与 $BA$ 相似. 由书上的定理 3 得 $AB$ 和 $BA$ 的特征多项式相同.

    若 $A\notin\operatorname{GL}_n(\mathbb{R})$, 则 % 补充
\end{proof}
\begin{exercise}[3.7]
    求循环矩阵
    \[A=\begin{pmatrix}
        a_0 & a_1 & a_2 \\
        a_2 & a_0 & a_1 \\
        a_1 & a_2 & a_0 \\
    \end{pmatrix}\]
    的特征根.
\end{exercise}
\begin{solution}
    设
    \[B=\begin{pmatrix}
        0 & 1 & 0 \\
        0 & 0 & 1 \\
        1 & 0 & 0 \\
    \end{pmatrix},\quad C=\begin{pmatrix}
        i & 1 & i \\
        i & e^{2\pi i/3} & e^{-\pi i/6} \\
        i & e^{-2\pi i/3} & e^{-5\pi i/6} \\
    \end{pmatrix},\]

    有
    \[C^{-1}BC=\begin{pmatrix}
        1 & 0 & 0 \\
        0 & e^{2\pi i/3} & 0 \\
        0 & 0 & e^{-2\pi i/3} \\
    \end{pmatrix}.\]

    $\because$
    \[A=a_0E+a_1B+a_2B^2,\]

    $\therefore$
    \begin{align*}
        C^{-1}AC & =a_0E+a_1C^{-1}BC+a_2C^{-1}BCC^{-1}BC \\
        & =\begin{pmatrix}
            a_0+a_1+a_2 & 0 & 0 \\
            0 & a_0+a_1e^{2\pi i/3}+a_2e^{-2\pi i/3} & 0 \\
            0 & 0 & a_0+a_1e^{-2\pi i/3}+a_2e^{2\pi i/3} \\
        \end{pmatrix}.
    \end{align*}

    由书上的定理 3 得
    \begin{align*}
        \chi_A(t) & =\chi_{C^{-1}AC}(t) \\
        & =(\lambda-(a_0+a_1+a_2))(\lambda-(a_0+a_1e^{2\pi i/3}+a_2e^{-2\pi i/3}))(\lambda-(a_0+a_1e^{-2\pi i/3}+a_2e^{2\pi i/3})).
    \end{align*}

    $\therefore A$ 的特征根为 $a_0+a_1+a_2,a_0+a_1e^{2\pi i/3}+a_2e^{-2\pi i/3},a_0+a_1e^{-2\pi i/3}+a_2e^{2\pi i/3}$.
\end{solution}
\begin{note}
    矩阵 $C$ 是我用 Mathematica 找到的. 具体计算过程在 \verb|2-2-3.7.nb| 里面.
\end{note}
\begin{exercise}[3.9]
    设 $\operatorname{char}K\neq2,A,B\in M_n(K)$. 若 $\exists D=\operatorname{diag}(\theta_1,\theta_2,\cdots,\theta_n),\theta_i=\pm1$ 使得 $B=DA$, 则记为 $B\sim A$.

    (1) 验证 $\sim$ 是一个等价关系.

    (2) 设 $S(A)$ 是以 $A$ 为代表的 $\sim$ 的等价类, 证明: $\operatorname{Card}S(A)\leq2^n$.

    (3) 证明: 至少有一个 $S(A)$ 中的矩阵不以 $1$ 为特征值.
\end{exercise}
\begin{proof}
    (1) $\because A=EA,\therefore A\sim A$.

    设 $B=\operatorname{diag}(\theta_1,\theta_2,\cdots,\theta_n)A$, 则 $A=\operatorname{diag}(\theta_1',\theta_2',\cdots,\theta_n')B$, 其中 $\theta_i\theta_i'=1\Rightarrow\theta_i'=\pm1$. $\therefore A\sim B\Rightarrow B\sim A$.

    设 $A=\operatorname{diag}(\theta_1,\theta_2,\cdots,\theta_n)B,B=\operatorname{diag}(\theta_1',\theta_2',\cdots,\theta_n')C$, 则 $A=\operatorname{diag}(\theta_1\theta_1',\theta_2\theta_2',\cdots,\theta_n\theta_n')C$. $\therefore A\sim B,B\sim C\Rightarrow A\sim C$.

    (2) $\because$
    \[S(A)=\{DA|D=\operatorname{diag}(\theta_1,\theta_2,\cdots,\theta_n),\theta_i=\pm1\},\]

    $\therefore$
    \[|S(A)|\leq\operatorname{Card}\{D|D=\operatorname{diag}(\theta_1,\theta_2,\cdots,\theta_n),\theta_i=\pm1\}=2^n.\]

    (3) 设 $A$ 以 $1$ 为特征值, 否则 $A$ 为符合要求的矩阵. 对 $n$ 用数学归纳法. 当 $n=1$ 时 $S(A)=\{(1),(-1)\},(-1)$ 符合要求. 假设对 $\forall A\in M_{n-1}(K),\exists B\in S(A)$ 使得 $B$ 不以 $1$ 为特征值.
    
    设 $A$ 与对角矩阵
    \[D=\begin{pmatrix}
        1 \\
        & c_1 \\
        && c_2 \\
        &&& \ddots \\
        &&&& c_{n-1} \\
    \end{pmatrix}\quad(c_i\neq 1).\]
    相似, 则 $\operatorname{diag}(-1,1,\cdots,1)A$ 与对角矩阵
    \[D'=\begin{pmatrix}
        -1 \\
        & c_1 \\
        && c_2 \\
        &&& \ddots \\
        &&&& c_k \\
    \end{pmatrix}\quad(c_i\neq 1).\]
    相似.
    
    由书上的定理 3 得 $\operatorname{diag}(-1,1,\cdots,1)A$ 与 $D'$ 有相同的特征值.

    $\because D'$ 的特征值为 $-1,c_1,c_2,\cdots,c_k,\therefore D'$ 不以 $1$ 为特征值.

    $\therefore\exists\operatorname{diag}(-1,1,\cdots,1)A\in S(A)$ 不以 $1$ 为特征值.
\end{proof}
\subsection{习题2.4}
\begin{exercise}[4.2]
    精确到相似, 矩阵
    \[A_1=\begin{pmatrix}
        J_2(0) \\
        & J_1(0) \\
        && J_1(0) \\
    \end{pmatrix},\quad A_2=\begin{pmatrix}
        J_2(0) \\
        & J_2(0) \\
    \end{pmatrix},\quad A_3=\begin{pmatrix}
        J_3(0) \\
        & J_1(0) \\
    \end{pmatrix},\quad A_4=J_4(0)\]
    穷尽了所有的非零 $4\times 4$ 幂零矩阵. 矩阵
    \[(1)\ \begin{pmatrix}
        0 & 0 & 0 & 0 \\
        1 & 0 & 0 & 1 \\
        0 & 0 & 0 & 0 \\
        0 & 0 & 0 & 0 \\
    \end{pmatrix},\quad(2)\ \begin{pmatrix}
        0 & 0 & 1 & 0 \\
        0 & 0 & 1 & 1 \\
        0 & 0 & 0 & 0 \\
        0 & 0 & 0 & 0 \\
    \end{pmatrix},\quad(3)\ \begin{pmatrix}
        0 & 0 & 0 & 0 \\
        1 & 0 & 0 & 0 \\
        1 & -1 & 0 & 0 \\
        1 & 1 & 1 & 0 \\
    \end{pmatrix},\quad(4)\ \begin{pmatrix}
        0 & 0 & 0 & 1 \\
        0 & 0 & 0 & 0 \\
        1 & -1 & 0 & 0 \\
        0 & 0 & 0 & 0 \\
    \end{pmatrix}\]
    分别相似于哪个 $A_i$?
\end{exercise}
\begin{solution}
    对上述矩阵进行初等变换, 进行初等行变换的同时进行初等列变换的逆. 用 II 型初等变换的时候最好先找全为 $0$ 的行/列(记为第 $i$ 行/列), 这样对第 $i$ 列/行进行初等变换的时候就不用考虑对应的逆. 这里以只考虑列变换为主.
    
    (1) $\because$
    \[(F_{1,4}(-1))^{-1}\begin{pmatrix}
        0 & 0 & 0 & 0 \\
        1 & 0 & 0 & 1 \\
        0 & 0 & 0 & 0 \\
        0 & 0 & 0 & 0 \\
    \end{pmatrix}F_{1,4}(-1)=\begin{pmatrix}
        0 & 0 & 0 & 0 \\
        1 & 0 & 0 & 0 \\
        0 & 0 & 0 & 0 \\
        0 & 0 & 0 & 0 \\
    \end{pmatrix},\]
    \[(F_{1,2})^{-1}\begin{pmatrix}
        0 & 0 & 0 & 0 \\
        1 & 0 & 0 & 0 \\
        0 & 0 & 0 & 0 \\
        0 & 0 & 0 & 0 \\
    \end{pmatrix}F_{1,2}=\begin{pmatrix}
        0 & 0 & 0 & 0 \\
        1 & 0 & 0 & 0 \\
        0 & 0 & 0 & 0 \\
        0 & 0 & 0 & 0 \\
    \end{pmatrix}=A_1,\]

    $\therefore$
    \[\begin{pmatrix}
        0 & 0 & 0 & 0 \\
        1 & 0 & 0 & 1 \\
        0 & 0 & 0 & 0 \\
        0 & 0 & 0 & 0 \\
    \end{pmatrix}\sim A_1.\]

    (2) $\because$
    \[(F_{4,3}(-1))^{-1}\begin{pmatrix}
        0 & 0 & 1 & 0 \\
        0 & 0 & 1 & 1 \\
        0 & 0 & 0 & 0 \\
        0 & 0 & 0 & 0 \\
    \end{pmatrix}F_{4,3}(-1)=\begin{pmatrix}
        0 & 0 & 1 & 0 \\
        0 & 0 & 0 & 1 \\
        0 & 0 & 0 & 0 \\
        0 & 0 & 0 & 0 \\
    \end{pmatrix},\]
    \[(F_{2,3})^{-1}\begin{pmatrix}
        0 & 0 & 1 & 0 \\
        0 & 0 & 0 & 1 \\
        0 & 0 & 0 & 0 \\
        0 & 0 & 0 & 0 \\
    \end{pmatrix}F_{2,3}=\begin{pmatrix}
        0 & 1 & 0 & 0 \\
        0 & 0 & 0 & 0 \\
        0 & 0 & 0 & 1 \\
        0 & 0 & 0 & 0 \\
    \end{pmatrix}=A_2,\]

    $\therefore$
    \[\begin{pmatrix}
        0 & 0 & 1 & 0 \\
        0 & 0 & 1 & 1 \\
        0 & 0 & 0 & 0 \\
        0 & 0 & 0 & 0 \\
    \end{pmatrix}\sim A_2.\]

    (3) $\because$
    \[\operatorname{rank}\begin{pmatrix}
        0 & 0 & 0 & 0 \\
        1 & 0 & 0 & 0 \\
        1 & -1 & 0 & 0 \\
        1 & 1 & 1 & 0 \\
    \end{pmatrix}=3,\]

    $\therefore$ 上述矩阵只有 $n-3=1$ 个 Jordan 块. $\therefore$ 上述矩阵与 $J_4(0)$ 相似.

    (4) $\because$
    \[(F_{1,2}(1))^{-1}\begin{pmatrix}
        0 & 0 & 0 & 1 \\
        0 & 0 & 0 & 0 \\
        1 & -1 & 0 & 0 \\
        0 & 0 & 0 & 0 \\
    \end{pmatrix}F_{1,2}(1)=\begin{pmatrix}
        0 & 0 & 0 & 1 \\
        0 & 0 & 0 & 0 \\
        1 & 0 & 0 & 0 \\
        0 & 0 & 0 & 0 \\
    \end{pmatrix},\]
    \[(F_{1,2})^{-1}\begin{pmatrix}
        0 & 0 & 0 & 1 \\
        0 & 0 & 0 & 0 \\
        1 & 0 & 0 & 0 \\
        0 & 0 & 0 & 0 \\
    \end{pmatrix}F_{1,2}=\begin{pmatrix}
        0 & 0 & 0 & 0 \\
        0 & 0 & 0 & 1 \\
        0 & 1 & 0 & 0 \\
        0 & 0 & 0 & 0 \\
    \end{pmatrix},\]
    \[(F_{1,3})^{-1}\begin{pmatrix}
        0 & 0 & 0 & 1 \\
        0 & 0 & 0 & 0 \\
        0 & 1 & 0 & 0 \\
        0 & 0 & 0 & 0 \\
    \end{pmatrix}F_{1,3}=\begin{pmatrix}
        0 & 1 & 0 & 0 \\
        0 & 0 & 0 & 1 \\
        0 & 0 & 0 & 0 \\
        0 & 0 & 0 & 0 \\
    \end{pmatrix},\]
    \[(F_{3,4})^{-1}\begin{pmatrix}
        0 & 1 & 0 & 0 \\
        0 & 0 & 0 & 1 \\
        0 & 0 & 0 & 0 \\
        0 & 0 & 0 & 0 \\
    \end{pmatrix}F_{3,4}=\begin{pmatrix}
        0 & 1 & 0 & 0 \\
        0 & 0 & 1 & 0 \\
        0 & 0 & 0 & 0 \\
        0 & 0 & 0 & 0 \\
    \end{pmatrix},\]

    $\therefore$
    \[\begin{pmatrix}
        0 & 0 & 0 & 1 \\
        0 & 0 & 0 & 0 \\
        1 & -1 & 0 & 0 \\
        0 & 0 & 0 & 0 \\
    \end{pmatrix}\sim A_3.\]
\end{solution}
\begin{note}
    除了第 (3) 题之外的题目都是在学完 Jordan 标准型之前写的, 所以没有用 Jordan 标准型来分解. 第 (3) 题用初等变换比较复杂, 当时没做出来.
\end{note}
\begin{exercise}[4.3]
    设 $\chi_\mathcal{A}(t)=(t-3)^4(t+2)$.

    (1) 已知 $\operatorname{rank}(\mathcal{A}-3\mathcal{E})=2$, 求 $\mathcal{A}$ 的 Jordan 矩阵 $J(\mathcal{A})$.

    (2) 若 $\operatorname{rank}(\mathcal{A}-3\mathcal{E})=1,3,4$, 能求出唯一的 $J(\mathcal{A})$ 吗?
\end{exercise}
\begin{solution}
    $-2$ 是 $\mathcal{A}$ 的代数重数为 $1$ 的特征值, $\therefore-2$ 在 $J(\mathcal{A})$ 的主对角线上只出现一次.

    $3$ 是 $\mathcal{A}$ 的代数重数为 $4$ 的特征值.

    (1) 若 $\operatorname{rank}(\mathcal{A}-3\mathcal{E})=2$, 则 $J(\mathcal{A})$ 中有 $n-\operatorname{rank}(\mathcal{A}-3\mathcal{E})=5-2=3$ 个对角线上的值为 $3$ 的 Jordan 块, 分别为 $J_2(3),J_1(3),J_1(3)$. $\therefore$
    \[J(\mathcal{A})=\begin{pmatrix}
        -2 & 0 & 0 & 0 & 0 \\
        0 & 3 & 1 & 0 & 0 \\
        0 & 0 & 3 & 0 & 0 \\
        0 & 0 & 0 & 3 & 0 \\
        0 & 0 & 0 & 0 & 3 \\
    \end{pmatrix}.\]

    (2) 若 $\operatorname{rank}(\mathcal{A}-3\mathcal{E})=1$, 则 $J(\mathcal{A})$ 中有 $5-1=4$ 个对角线上的值为 $3$ 的 Jordan 块, 只有可能是 $4$ 个 $J_1(3)$. $\therefore$
    \[J(\mathcal{A})=\begin{pmatrix}
        -2 & 0 & 0 & 0 & 0 \\
        0 & 3 & 0 & 0 & 0 \\
        0 & 0 & 3 & 0 & 0 \\
        0 & 0 & 0 & 3 & 0 \\
        0 & 0 & 0 & 0 & 3 \\
    \end{pmatrix}.\]

    若 $\operatorname{rank}(\mathcal{A}-3\mathcal{E})=3$, 则 $J(\mathcal{A})$ 中有 $5-3=2$ 个对角线上的值为 $3$ 的 Jordan 块, 可能是 $J_1(3),J_3(3)$ 或者是 $J_2(3),J_2(3)$. $\therefore J(\mathcal{A})$ 不能唯一确定.

    若 $\operatorname{rank}(\mathcal{A}-3\mathcal{E})=4$, 则 $J(\mathcal{A})$ 中有 $5-4=1$ 个对角线上的值为 $3$ 的 Jordan 块, 只有可能是 $J_4(3)$. $\therefore$
    \[J(\mathcal{A})=\begin{pmatrix}
        -2 & 0 & 0 & 0 & 0 \\
        0 & 3 & 1 & 0 & 0 \\
        0 & 0 & 3 & 1 & 0 \\
        0 & 0 & 0 & 3 & 1 \\
        0 & 0 & 0 & 0 & 3 \\
    \end{pmatrix}.\]
\end{solution}
\begin{exercise}[4.4]
    (1) 验证: 矩阵
    \[A=\begin{pmatrix}
        6 & 2 & -2 \\
        -2 & 2 & 2 \\
        2 & 2 & 2 \\
    \end{pmatrix},\quad B=\begin{pmatrix}
        6 & 2 & 2 \\
        -2 & 2 & 0 \\
        0 & 0 & 2 \\
    \end{pmatrix}\]
    有相同的多项式.

    (2) 求 $\mu_A(t),\mu_B(t)$.

    (3) 求 $J(A),J(B)$.
\end{exercise}
\begin{solution}
    (1) $\chi_A(t)=\det(tE-A)=t^3-10t^2+32t-32=\det(tE-B)=\chi_B(t)$.

    (2) $\chi_A(t)=\chi_B(t)=(t-4)^2(t-2)$. $\because(A-2E)(A-4E)=0,\therefore\mu_A(t)=(t-4)(t-2)$. $\because(B-2E)(B-4E)\neq0,(B-2E)(B-4E)^2=0,\therefore\mu_B(t)=(t-4)^2(t-2)$.

    (3) $2$ 是 $A,B$ 的代数重数为 $1$ 的特征值, $\therefore2$ 在 $J(A),J(B)$ 的主对角线上只出现一次.

    $4$ 是 $A,B$ 的代数重数为 $2$ 的特征值.

    $\because\operatorname{rank}(A-4E)=1$, $\therefore J(A)$ 中有 $n-\operatorname{rank}(A-4E)=3-1=2$ 个对角线上的值为 $4$ 的 Jordan 块, $\therefore$
    \[J(A)=\begin{pmatrix}
        2 & 0 & 0 \\
        0 & 4 & 0 \\
        0 & 0 & 4 \\
    \end{pmatrix}.\]

    $\because\operatorname{rank}(B-4E)=2$, $\therefore J(B)$ 中有 $n-\operatorname{rank}(B-4E)=3-2=1$ 个对角线上的值为 $4$ 的 Jordan 块, $\therefore$
    \[J(B)=\begin{pmatrix}
        2 & 0 & 0 \\
        0 & 4 & 1 \\
        0 & 0 & 4 \\
    \end{pmatrix}.\]
\end{solution}
\begin{exercise}[4.6]
    证明: 矩阵 $A\in M_n(\mathbb{C})$ 相似于 $^tA$.
\end{exercise}
\begin{proof}
    $\because\det(A-tE)=\det({}^tA-tE)$, $\therefore A$ 与 $^tA$ 有相同的特征值.

    $\because\forall k\in\mathbb{N}_+,\lambda\in\mathbb{C},({}^tA-\lambda E)^k=({}^t(A-\lambda E))^k={}^t((A-\lambda E)^k)$, $\therefore\operatorname{rank}({}^tA-\lambda E)^k=\operatorname{rank}{}^t((A-\lambda E)^k)$.
    
    $\because\forall B\in M_n(\mathbb{C}),B$ 的行/列向量的线性相关性等价于 $^tB$ 的列/行向量的线性相关性,$\therefore\operatorname{rank}{}^tB=\operatorname{rank}B$, $\therefore\operatorname{rank}{}^t((A-\lambda E)^k)=\operatorname{rank}(A-\lambda E)^k$.
    
    $\therefore A$ 与 $^tA$ 具有相同的 Jordan 块, $\therefore J(A)=J({}^tA)$. $\therefore A\sim J(A)=J({}^tA)\sim{}^tA$.
\end{proof}
\begin{exercise}[4.7]
    设矩阵 $A\in M_n(\mathbb{C})$, 证明: $A^N=E$ 当且仅当 $A$ 可以对角化且它的特征值都是 $N$ 次单位根.
\end{exercise}
\begin{proof}
    ($\Leftarrow$) 设
    \[A=C^{-1}\operatorname{diag}(\lambda_1,\lambda_2,\cdots,\lambda_n)C,\]

    其中 $\lambda_1,\lambda_2,\cdots,\lambda_n$ 是 $A$ 的特征根, 而且是 $N$ 次单位根. $\therefore$
    \[A^N=C^{-1}\operatorname{diag}(\lambda_1^N,\lambda_2^N,\cdots,\lambda_n^N)C=C^{-1}C=E.\]

    ($\Rightarrow$) 由书上的基本定理, $\exists C\in\operatorname{GL}_n(\mathbb{C})$ 使得
    \[A=C^{-1}\begin{pmatrix}
        J_{m_1}(\lambda_1) \\
        & \ddots \\
        && J_{m_p}(\lambda_p) \\
    \end{pmatrix}C.\]

    由 [BAI] 习题 2.3 的第 17 题得
    \[\begin{pmatrix}
        J_{m_1}(\lambda_1) \\
        & \ddots \\
        && J_{m_p}(\lambda_p) \\
    \end{pmatrix}^N=\begin{pmatrix}
        (J_{m_1}(\lambda_1))^N \\
        & \ddots \\
        && (J_{m_p}(\lambda_p))^N \\
    \end{pmatrix},\]
    \[E=A^N=C^{-1}\begin{pmatrix}
        (J_{m_1}(\lambda_1))^N \\
        & \ddots \\
        && (J_{m_p}(\lambda_p))^N \\
    \end{pmatrix}C,\]

    $\therefore$
    \[\begin{pmatrix}
        (J_{m_1}(\lambda_1))^N \\
        & \ddots \\
        && (J_{m_p}(\lambda_p))^N \\
    \end{pmatrix}=CEC^{-1}=E.\]

    假设 $A$ 不可以对角化, 不妨设 $m_1>1$, 由式 (\ref{eq4.1}) 得 $(J_{m_1}(\lambda_1))^N\neq E_{m_1}$, 与上式矛盾.

    假设 $A$ 可以对角化但 $\lambda_i^N$ 不全为 $1$, 则由
    \[E=\begin{pmatrix}
        \lambda_1^N \\
        & \ddots \\
        && \lambda_n^N \\
    \end{pmatrix}\]
    得到矛盾.
\end{proof}
\begin{exercise}[4.10]
    矩阵
    \[A=\begin{pmatrix}
        J_1(\lambda) \\
        & J_2(\mu) \\
    \end{pmatrix}=\begin{pmatrix}
        \lambda & 0 & 0 \\
        0 & \mu & 1 \\
        0 & 0 & \mu \\
    \end{pmatrix}\in M_3(\mathbb{C})\]
    可以写成 $A=S+N$ 的形式, 其中 $S=\operatorname{diag}(\lambda,\mu,\mu)$.

    求次数最小的多项式 $s(t),n(t)$ 使得 $s(A)=S,n(A)=N$. 规定 $A^0=E$.
\end{exercise}
\begin{solution}
    $A$ 的特征多项式为 $(t-\lambda)(t-\mu)^2$. 由书上的定理 2, $(A-\lambda)(A-\mu)^2=0$.

    $\therefore$ 若 $\deg s\geq3$ (或 $\deg n\geq3$, 下面以 $s$ 为例), 则 $\exists f,r\in\mathbb{C}[t]$ 使得
    \[s(t)=f(t)\cdot(t-\lambda)(t-\mu)^2+r(t),\quad\deg r<3.\]

    $\therefore$
    \[s(A)=f(A)\cdot(A-\lambda)(A-\mu)^2+r(A)=r(A).\]

    $\therefore\deg s\leq 2,\deg n\leq 2$\footnote{这个结论不是解题的必要步骤, 但是原题里面有, 所以在这里说明一下.}.

    假设 $\deg s=1$, 则 $\exists a,b\in\mathbb{C}$ 使得 $S=aA+bE$. $\therefore S,A,E$ 线性相关. $\because A=S+N$, $\therefore S,N,E$ 线性相关, 与 $N\notin\left<S,E\right>$ 矛盾. $\therefore\deg s=2$.

    $\because$
    \[A^2=\begin{pmatrix}
        \lambda^2 & 0 & 0 \\
        0 & \mu^2 & 2\mu \\
        0 & 0 & \mu^2 \\
    \end{pmatrix},\]

    $\therefore$ 关于 $a_0,a_1,a_2$ 的方程 $S=a_0E+a_1A+a_2A^2$ 按分量可以写成
    \[\begin{cases}
        \lambda=a_0+\lambda a_1+\lambda^2a_2, \\
        \mu=a_0+\mu a_1+\mu^2a_2, \\
        0=a_1+2\mu a_2. \\
    \end{cases}\]

    解得
    \[\begin{cases}
        a_0=\dfrac{\lambda\mu}{\lambda-\mu}, \\[8pt]
        a_1=-\dfrac{2\mu}{\lambda-\mu}, \\[8pt]
        a_2=\dfrac{1}{\lambda-\mu}. \\
    \end{cases}\]

    $\therefore$
    \[s(t)=\dfrac{t^2-2\mu t+\lambda\mu}{\lambda-\mu},\quad n(t)=t-s(t).\]
\end{solution}
\begin{exercise}[4.12]
    对 $\forall k\in\mathbb{N}_+$, 计算 $(J_n(\lambda))^k$.
\end{exercise}
\begin{solution}
    见式 (\ref{eq4.1}).
\end{solution}
\begin{exercise}[4.13]
    证明: 对 $\forall X,Y,Z\in M_2(K),[[X,Y]^2,Z]=0$, 其中 $[X,Y]=XY-YX$.
\end{exercise}
\begin{proof}
    设
    \[X=\begin{pmatrix}
        x_{11} & x_{12} \\
        x_{21} & x_{22} \\
    \end{pmatrix},\quad Y=\begin{pmatrix}
        y_{11} & y_{12} \\
        y_{21} & y_{22} \\
    \end{pmatrix},\]

    则
    \[XY=\begin{pmatrix}
        x_{11}y_{11}+x_{21}y_{21} & x_{11}y_{12}+x_{21}y_{22} \\
        x_{21}y_{11}+x_{22}y_{21} & x_{21}y_{12}+x_{22}y_{22} \\
    \end{pmatrix},\quad YX=\begin{pmatrix}
        x_{11}y_{11}+x_{21}y_{21} & x_{12}y_{11}+x_{22}y_{21} \\
        x_{11}y_{21}+x_{21}y_{22} & x_{12}y_{21}+x_{22}y_{22} \\
    \end{pmatrix}.\]

    $\therefore$
    \[[X,Y]=\begin{pmatrix}
        0 & x_{11}y_{12}+x_{21}y_{22}-x_{12}y_{11}-x_{22}y_{21} \\
        x_{21}y_{11}+x_{22}y_{21}-x_{11}y_{21}-x_{21}y_{22} & 0 \\
    \end{pmatrix}.\]

    设
    \[[X,Y]=\begin{pmatrix}
        0 & b \\
        c & 0 \\
    \end{pmatrix},\]

    则 $[X,Y]$ 的特征多项式为 $\lambda^2-bc$. 由书上的定理 2 得 $[X,Y]^2=bcE$.

    $\because (bcE)Z=Z(bcE)$, $\therefore[[X,Y]^2,Z]=[bcE,Z]=0$.
\end{proof}
\end{document}